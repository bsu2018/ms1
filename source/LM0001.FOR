       SUBROUTINE LM0001( MSW, RMSW, ADR, MSWALL, RMSWAL, KOD )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C   OPOPAMMA: LM0001( MSW, RMSW, ADR, MSWALL, RMSWAL, KOD )
C   -------------
C   HAHAEHE:   OECKA HACTPOKA MSW MAKPOMOE TA # 40
C   ----------     ***  PETOP BOEH 3X3X0 ******
C   METO:        OCK B MSW_ALL OCAH EMEHTA *. MA.*
C   -----         ( O. T COACHO BCTPOEHHO TA. "LTIP" )
C                 B CAE HAXOEH -> OOPMPOBAHE MSW_OCAH;
C                 B TOM CAE KOD = 0, HAE = 1;
C   APAAMETP:   MSW(RMSW) - "OTPEOK" MSW_MOE T # 40;
C   ----------    ADR - APEC B MSW_ALL MSW_OCAH TO MOE;
C                 MSWALL(RMSWAL) - BEC CCOK MSW COB;
C                 KOD - = 0 - COPMPOBA MSW,
C                       = 1 - O. OK;
C                      ( HA NWTR COOEHE BBOTC );
C   OPOPAMM: 1. PROF1, PROF2
C   ------------  2. SEQMS0
C
C   PMEAHE:  OPMAT MSW_OCAH ---->
C   ----------
C              OPMAT RMSW T # 40:
C              ---------------------
C+-----------I--------------I------I-----------------------------------
C  # COBA   I    # COBA B I KTO  I       OOHAEHE - HAEHE
C OT HAAA  I    OTPEKE   IOPE.I
C BCEO MSW  I    RMSW B    I      I
C OCAH   I    FM0010    I      I
C            I              I      I
C------------I--------------I------I-----------------------------------
C     9      I    -2        I      I HOMEP A KA ( AA A )
C    10      I    -1        I      I HOMEP A KB ( AA B )
C    11      I     0        I      I HOMEP A KC ( AA C )
C----------------------------------------------------------------------
C    12      I     1        I  DM  I  FQ - A HOBE HA. BCEH
C            I              I      I   (  CHXPO. MAKPO. P.TIP # 4
C    13      I     2        I  FM  I  NELT - HOMEP . PEP. . MA.
C    14      I     3        I  LM  I  AMOT - AP. B MSWALL OCAH
C            I              I      I         PE. . MAH
C    15      I     4        I  LM  I  APOT - APEC B MSWALL OB MAH
C    16      I     5        I  LM  I  ATOKM - AP B TOKN/N1 BEH,
C            I              I      I          PACT.  . MA.
C    17      I     6        I  FM  I  TBKL - BPEM, HAHA C KOTOPOO
C            I              I      I         BKAETC PETOP;
C    18,19   I     7,8      I      I  PEEPB.
C    20      I     9        I  FM  I  UPOT - OTOOHOE HAPEHE
C    21      I     10       I  FM  I  NSUB - HOMEP / OOBATE
C22,23,24,25 I11,12,13,14,15I      I  PA. MECTO  HTEPATOPOB;
C  27        I    16        I  FM  I  NPAR - KO-BO APAMETPOB,
C            I              I      I         BBEEHHX B PSUB<..>
C OT 28 O   I OT 17 O     I FM   I  APAMETP PSUB, AAHHE
C 28 + NPAR  I 17 + NPAR    I      I  OOBATEEM
C            I              I      I
C----------------------------------------------------------------------
C
C  OA HA MSW --> LM<BC> = 28+NPAR
C
C
C
C          .  MAH:
C
C
C               "OCTOHHA" ACT MSW TA # 11, 110, 12, 120:
C                ----------------------------------------------
C    + 14   140
C  +-------+--------+--------+--------+------+------+-------+---+
C  I HOMEP I HOMEP  I HOMEP  I PHAKI KO I KO. IAP.   IPE I
C  I EME I TA   I /    I TA   I ECT I BB. IHA.   IE I
C  I HTA   I MOE I PACETAI MOE I BO   I HA I"TOKN" IPB I
C  I       I        I DM.....I       .I OBI EH.I"TOKN1"I   I
C  +-------+--------+--------+--------+------+------+-------+---+
C  I  1    I   2    I   3    I    4   I   5  I  6   I  7    I 8 I
C  +-------+--------+--------+--------+------+------+-------+---+
C
C  +--------------------------------------------------------------+
C  I  OKEH S1N S2N S3N F1N F2N F3N S1K S2K F1K F2K F3K I
C  I           12-T COB: OT 9 O 20                             I
C  +--------------------------------------------------------------+
C
C              RMSW T # 11, 110, 12, 120 [ . MAHA 3X3X0 ] :
C              ************************************************
C
C  +--------+-----+------+------+-------+-------+-------+-------+-----+
C  I PEEPB I"DOM"I PARD I PARM I PARGY I PARG1 I PARJY I PARJ0 I TMASI
C  I 5-T   I  I      I      I       I       I       I       I     I
C  I  COB  IMEX. I 9-T I 9-T I 36-T I 36-T I 6-T  I 6-T  I NMASI
C  I        IP- I COB I COB I COB  I COB  I COB  I COB  I COBI
C  +--------+-----+------+------+-------+-------+-------+-------+-----+
C  I 21 - 25I 26  I27-35 I36-44 I45-80  I81-116 I117-122I123-128I129-@I
C  I        I     I      I      I       I       I       I       I     I
C  +--------+-----+------+------+-------+-------+-------+-------+-----+
C  +D1            +D2    +D3    +D4     +D5     +D6     +D7     +D8   +
C
C              @ - OPEEETC PAMEPOM MAS <...> ==> ...+ NMAS + 1
C
C      INTEGER D1,D2,D3,D4,D5,D6,D7,D8
C
C
C      DATA D1, D2, D3, D4, D5, D6,  D7,  D8
C    =  /   21, 27, 36, 45, 81, 117, 123, 129 /
C
C
CZZZ-------------------------------------------------------------------
       COMMON /PROF1/ MASPRT(200)
       COMMON /PROF2/ MACTAB(800)
       DIMENSION MSW(*), RMSW(*), MSWALL(*), RMSWAL(*)
       INTEGER TIP, ADR, PTIP, AMOT, APOT, ATOKM, TIPX
       DIMENSION LTAB(10)
       DATA LTAB/ 11, 110, 12, 120, 14, 140, 4*0 /
       DATA K10 / 10 /
C----------------------------------------------------------------------
       KOD = 0
C-->  HOMEP -TA . MAH:
       NELMOT = MSW(13)
C-->
       NEL = MSW(1)
       TIP = MSW(2)
C-->
C-->  CKAT B MSWALL EMEHT C #-TA = NELMOT:
       CALL SEQMS0(MSWALL, NELMOT, AMOT, IRC, KVIV, ATOKM )
C-->
       IF   ( IRC .EQ. 1 ) GO TO 1
C-->  EMEHTA HET...
       KOD = 1
       NWTR = MASPRT(13)
       WRITE(NWTR, 100) NEL, TIP, NELMOT
100    FORMAT(//' *** APOC HA O. CB EMEHTA # ', I5,
     =  ' ( T # ', I3, ' ) ***'/
     =  ' *** C HE CECTBM B E EMEHTOM # ', I5,' ***'/
     =  ' *** OPAOTKA E PEKPAAETC *** '//)
       RETURN
C----------------------------------------------------------------------
1      CONTINUE
C-->  MSW - HA, TO A T TAM BET ?
       TIPX = MSWALL(AMOT + 1 )
       DO 2 I = 1, K10
       IF ( TIPX .EQ. LTAB(I) ) GO TO 3
2      CONTINUE
C-->  CB C HE HAM TOM.....
       KOD = 1
       NWTR = MASPRT(13)
       WRITE(NWTR,101) NEL, TIP, NELMOT, TIPX
101    FORMAT(//' *** APOC HA O. CB EMEHTA # ', I5,
     = ' ( T # ', I3, ' ) ***'//
     = ' *** C EMEHTOM # ', I5, ' ( T # ', I3, ' ) - OOEH',
     = '  HE PEAOBAH ***'/
     = ' *** OPAOTKA E PEKPAAETC ***'//)
       RETURN
3      CONTINUE
C-->  HAAO OCAH MAH--->
       MSW(14) = AMOT
C-->  HAAO CCKA OB MAH-->
       MSW(15) = AMOT+8
C-->  APEC B TOKN/TOKN1  EPEMEHHX COCTOH MAH-->
       MSW(16) = ATOKM
       KOD = 0
       RETURN
       END
