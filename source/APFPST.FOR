      SUBROUTINE APFPST( SIM , RSIM , KSIM , POST , RPOST , K , KKK )
CXXX****KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)*************
C*                                                                     *
C*    OPOPAMMA :  APFPST ( SIM , RSIM , KSIM , POST , RPOST , K    *
C*    ------------             KKK )                                   *
C*                                                                     *
C*    HAHAEHE :    EPEBO HKCHOO BPAEH S(1),S(2),...,S(N), *
C*    ----------      N>=1, B OCTKCH OPM. S(I) - EHTKATOP, *
C*                    CO, '('  ')', HAK OEPA ( + , - , / , *
C*                    *    ** ).                                    *
C*                                                                     *
C*    METO :         OCHOBAH HA COOBAH CTEKA C POPTETAM.   *
C*    -----           AOPTM PAOTAET, TA CMBO HKCHOO      *
C*                    BPAEH CEBA HAPABO. BCE EHTKATOP      *
C*                    (  CA ) OCTAT HA BXO O MEPE TEH; *
C*                    HAK OEPA OMEATC B CTEK OEPA. EC  *
C*                    POPTET BXOHOO HAKA PABEH 0  OE      *
C*                    POPTETA HAKA, HAXOEOC B BEPHE CTEKA,  *
C*                    TO HOB HAK OABETC B BEPH CTEKA.       *
C*                    B POTBHOM CAE  CTEKA "BTAKBAETC"     *
C*                    EPECBAETC B BXOH CTPOK HAK,           *
C*                    HAXOC B BEPHE, A TAKE CEE A      *
C*                    HM HAK C POPTETAM, OM  PABHM   *
C*                    POPTET BXOHOO HAKA. OCE TOO BXOHO   *
C*                    HAK OABETC K BEPHE CTEKA. '(' "BTA-    *
C*                    KBAETC TOKO ')', HO HA BXO HE EPEAETC.  *
C*                                                                     *
C*        TAA POPTETOB HAKOB OEPA  OPAHTEE          *
C*                 -------------------------------------               *
C*                   C  M O    !    P  O P  T E T                 *
C*                 -------------------------------------               *
C*                       (       !           0                         *
C*                       )       !           1                         *
C*                     +   -     !           2                         *
C*                     *   /     !           3                         *
C*                       **      !           4                         *
C*                    HK    !           5                         *
C*                 -------------------------------------               *
C*                                                                     *
C*    APAMETP :     SIM  - MACCB TEPMOB B  F-KOE (INTEGER*4) ,     *
C*    ---------              ACAHHX B HKCHOM BE.              *
C*                    RSIM - TO E TO  SIM , HO REAL*4               *
C*                    KSIM - KOECTBO AHTX O B MACCBE      *
C*                           SIM ( <= 100 ).                           *
C*                    POST - MACCB TEPMOB, PECTAB COO        *
C*                           OCTKCHOE BPAEHE.                    *
C*                    RPOST - TO E TO POST , HO REAL*4               *
C*                    K - KOECTBO EMEHTOB B POST-AC           *
C*                    KKK - KO BOBEEH B CTEEH '**'              *
C*                                                                     *
C*    OPOPAMM :  APFTRT , ( SUBERR , COMMON : PRINTN )            *
C*    ------------                                                     *
C*                                                                     *
C*    PMEAHE :    BXOHA HKCHA AC OHA T B BE      *
C*    ----------      OCEOBATEHOCT TEPMOB B F-KOE.              *
C*                                       ----------------              *
C*                                                                     *
CZZZ********************************************************************
C*   BEGIN DECLARE
       COMMON / PRINTN / NW6
       DIMENSION ZH(7) , PRTY(50) , STEK(50) , ZN(7)
       DIMENSION SIM(1) , POST(1) , RPOST(1) , RSIM(1)
       INTEGER SIM , POST , PRTY , STEK , DPRTY , ZH , ZN
       DATA ZN / '(' , ')' , '+' , '-' , '*' , '/' , ' ' /
C!!!-------------------------------------------------------------------
C!!!-------------------------------------------------------------------
C*   END DECLARE
C*   EPEKOPOBKA ZH  OPMATA 'A' B OPMAT 'F'
       CALL APFTRT( 1 , 7 , ZN , ZH )
       DO 1000 I=1,6
 1000  ZH(I) = -ZH(I)
C*   HAAHOE COBE
C*   I - HEKC  SIM-AC
       I = 1
C*   K - HEKC  POST-AC
       K = 1
C*   J - HEKC  CTEKA
       J = 0
C*---------------------------------------------------------------------
       ZH(7) = KKK
C*---------------------------------------------------------------------
C*   OPAOTKA AC
 11    CONTINUE
C*    HAC EHTKATOP ?
       IF ( SIM(I) .GT.   0 ) GO TO 1
C*    HAC CO ?
       IF ( SIM(I) .EQ.   0 ) GO TO 3
C*    HAC OTKPBAA CKOKA '(' ?
       IF ( SIM(I) .EQ. ZH(1) ) GO TO 4
C*    HAC AKPBAA CKOKA ')' ?
       IF ( SIM(I) .EQ. ZH(2) ) GO TO 5
C*   HK  OEPA ( * , / , - , + )
C*
C*   MEEM '-'  '+'
       IF ( SIM(I) .EQ. ZH(3)  .OR.  SIM(I) .EQ. ZH(4) ) GO TO 21
C*   MEEM '*'  '/'
       IF ( SIM(I) .EQ. ZH(5)  .OR.  SIM(I) .EQ. ZH(6) ) GO TO 22
C*   MEEM BOBEEHE B CTEEH
       IF ( SIM(I) .EQ. ZH(7) ) GO TO 23
C*    HAC HK ?
       IF ( SIM(I) .LT. -100 ) GO TO 124
C!!!-------------------------------------------------------------------
       WRITE(NW6,100) I
 100   FORMAT(1X,'***** CO B APFPST , HEOOHAHH TEPM N=',I5)
       CALL SUBERR(1)
C!!!-------------------------------------------------------------------
 124   J = J + 1
C*   AOHEM HK B CTEK
       STEK(J) = SIM(I)
       PRTY(J) = 5
       GO TO 10
C*---------------------------------------------------------------------
C*   CTEKOB POPTET OEPA '+'  '-' PABEH 2
 21    DPRTY = 2
       GO TO 25
C*   POPTET '*'  '/' PABEH 3
 22    DPRTY = 3
       GO TO 25
C*   POPTET '**' PABEH 4
 23    DPRTY = 4
 25    CONTINUE
C*   CTEK CT ? ( J=0 - A ; J^=0 - HET )
       IF ( J .NE. 0 ) GO TO 30
C*   .... CT !
 31    J = J + 1
C*   EM B CTEK OEPA ( + , - , / , * , ** )
       STEK(J) = SIM(I)
       PRTY(J) = DPRTY
       GO TO 10
C*   .... HE CT !
 30    CONTINUE
C*   EC POPTET OEPA  DPRTY  OE POPTETA OEPA
C*   B BEPHE CTEKA  PRTY  , TO  GO TO 31
       IF ( PRTY(J) .LT. DPRTY ) GO TO 31
C*   HAE OPMPEM OPATH OCK AC , T.E.
C*   BTAKBAEM OEPA  CTEKA
       POST(K) = STEK(J)
       K = K + 1
       J = J - 1
       GO TO 31
C*---------------------------------------------------------------------
C*   MEEM EHTKATOP.EPEEM EO B OCTKCH AC.
 1     POST(K) = SIM(I)
       K = K + 1
       GO TO 10
C*---------------------------------------------------------------------
C*   MEEM COB KOHCTAHT.ACBAEM EE B  POSTFIX.
 3     POST(K) = SIM(I)
       I = I + 1
       RPOST(K+1) = RSIM(I)
       K = K + 2
       GO TO 10
C*---------------------------------------------------------------------
C*   MEEM '(' . EM EE B CTEK C POPTETOM "0".
 4     J = J + 1
       STEK(J) = ZH(1)
       PRTY(J) = 0
       GO TO 10
C*---------------------------------------------------------------------
C*   MEEM ')'.
 5     CONTINUE
C*   BTAKBAEM  CTEKA BCE HAK , E POPTET OE ,
C*   EM POPTET ')' (T.E. >1)  EM B  POSTFIX .
C*   '('  CTEKA BTAKBAETC , HO B  POSTFIX HE ETC .
       IF ( PRTY(J) .EQ. 0 ) GO TO 60
       POST(K) = STEK(J)
       K = K + 1
       J = J - 1
       GO TO 5
 60    J = J - 1
       GO TO 10
C*---------------------------------------------------------------------
 10    I = I + 1
C*   AC CEPAHA ?
       IF ( I .LE. KSIM ) GO TO 11
C*---------------------------------------------------------------------
C*   CPOC OCTATKA CTEKA B  POSTFIX .
 72    IF ( J .EQ. 0 ) GO TO 71
       POST(K) = STEK(J)
       K = K + 1
       J = J - 1
       GO TO 72
 71    CONTINUE
       K = K - 1
       RETURN
       END
