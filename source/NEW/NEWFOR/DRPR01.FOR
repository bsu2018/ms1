         SUBROUTINE DRPR01( KOD, TIME, TOK, VALL )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C   OPOPAMMA:   DRPR01( KOD, TIME, TOK, VALL )
C   -------------
C   HAHAEHE:    COHTE PEKTB #E
C   ----------
C   METO:         O HOPMA  COMMON SERVZ6 - EAT AHHX;
C   -----
C              EPEMEHHA KXXX [MASPRT(99)] COETC KAK C..K.
C              POCKAEMX TOEK ---> OPAOTKA APAMETPA KOUT;
C
C             P FREST = 1 ( A APOCA #CET ) KXXX P KOD=1
C                            HE OHETC;
C
C
C   APAMETP:     KOD = 1 - OTKPT TA,  KXXX - OHT;
C   ---------          = 2 - EAT OEPEHO;
C                      = 3 - AKPT TA;
C                      = 4 EAT OEPEHO C PHAKOM KOMMTA;
C                      = 5 EAT OEPEHO (?) C PHAKOM #TECT_PHE#
C                      = 6 EAT AHHX B MOMEHT COAH K.T. B KOHE
C                             ( BBOTC BCEA )
C                      = 7 EAT AHHX C PHAKOM HTEPO. BBOA;
C                  TIME, TOK, VALL - MACCBA OPEEE TOK;
C
C   OPOPAMM:  1. DRPR00
C   -------------  2. COMMON SERVZ6, PROF1
C
CZZZ-------------------------------------------------------------------
       COMMON/PROF1/ MASPRT(200)
       EQUIVALENCE( KXXX, MASPRT(99) )
       EQUIVALENCE( FREST,MASPRT(45) )
       INTEGER FREST
         COMMON/SERVZ6/ TBEGON, TENDON, KOUTON, SPISON(55)
         DIMENSION TOK(1), VALL(1)
         INTEGER SPISON
         GO TO (1,2,3,2,2,4,2 ), KOD
         CALL SUBERR(KOD)
1        CALL DRPR00(KOD, SPISON, TIME, TOK, VALL)
       IF ( FREST .EQ. 1 ) RETURN
         KXXX = 0
         RETURN
2        CONTINUE
         IF ( TIME .LT. TBEGON ) RETURN
         IF ( TIME .GT. TENDON ) RETURN
c         IF ( KOD .EQ. 4  .OR. KOD .EQ. 5 ) GO TO 4
c         IF ( KXXX .EQ. 0 ) CALL DRPR00( KOD, SPISON, TIME, TOK, VALL )
c         KXXX = KXXX + 1
c         IF ( KXXX .EQ. KOUTON ) KXXX = 0
         CALL DRPR00( KOD, SPISON, TIME, TOK, VALL )
         RETURN
C######################################################################
3        CONTINUE
C--->  AKPT EAT
         CALL DRPR00(KOD, SPISON, TIME, TOK, VALL )
         RETURN
C######################################################################
C--->  KOMMTA BBOM BCEA, EAT TECT_PHE TO E, K.T. TO E...
4        CALL DRPR00(KOD, SPISON, TIME, TOK, VALL )
         RETURN
         END
