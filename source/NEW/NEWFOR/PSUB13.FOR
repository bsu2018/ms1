       SUBROUTINE PSUB13( NEL, URMAS, STMAS, DGMAS, INTMAS )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT  1991 .)------------
C   OPOPAMMA: PSUB13( NEL, URMAS, STMAS, DGMAS, INTMAS )
C   -------------
C   HAHAEHE:  / OOBATE  MOEPOBAH
C   ----------   AKOHOB PABEH OTEHM BEHTEM 
C                PO BEHTE.
C                  ( MOE #301 - C ).
C               O BEHAM, EPEABAEMM OOBATEEM 
C               HAEHM TOKOB  HAPEH EMEHTOB CXEM
C               OPEETC KO C KAOO BEHT  A O
C               MOMEHTA MEHEH HAEH C.
C
C######################################################################
C
C         OPOPAMMA OPMPET CHA PABEH TPCTOPAM
C      PABEMOO BPMTE, COPAHHOO O CXEME APOHOBA.
C         BXOHM BEHAM BTC CHA PABEH ( UYPR )
C      TP OOPHX CHAA  KAOO HAPEH TAE CET
C     UOPAB, UOPBC, UOPCA, KOTOPE OH OEPEAT "CBO" HEHE
C     HAPEH HA OHAKOB O ( =< 30 . PA ).
C         CHA PABEH HA TPCTOP BPMTE OPMPTC
C     P OOTEHOM HAPEH PABEH P COBAEH EO C
C     HCAAM ACTKOM COOTBETCTBEO OOPHOO HAPEH.
C         TEHOCT MCA PABEH AAETC OOBATEEM
C     EPE APAMETP / PSUB 13.
C         P EPEXOE TOKA HAPK EPE HO OEPBAETC
C     ETOKOBA AA, TEHOCT KOTOPO AAETC OOBATEEM
C     EPE APAMETP / PSUB 13.
C
C
C     OCAHE C, PABE BPMTEEM
C     CEEE :
C
C       #  T 301   0  
C           MAS < 5  #1  #CM1  #2  #CM2  #3  #CM3  #4  #CM4
C                    #5  #CM5  >
C           MAS < 0 >
C           PSUB  13 <  DIMP   TPAUSE  >  ;
C
C    E
C      #1,#CM1 - HOMEP EMEHTA, TOK KOTOPOO COETC B KAECTBE
C                  CHAA PABEH ;
C      #2,#CM2 - HOMEPA EMEHTOB, TOK KOTOPOO COETC B
C      #3,#CM3   KAECTBE OOPHX CHAOB COOTBETCTBEHHO 
C      #4,#CM4   HEHX HAPEH  "AB", "BC", "CA";
C      #5,#CM5 - HOMEP EMEHTA, TOK KOTOPOO BETC TOKOM
C                  HAPK ;
C      DIMP      - TEHOCT MCA PABEH ( CEK.);
C      TPAUSE    - TEHOCT ETOKOBO A    ( CEK.).
C
C
C######################################################################
C
C
C   METO:     OEBEH.
C   -----
C  APAMETP:   NEL - HOMEP EMEHTA,  KOTOPOO PSUB PAOTAET;
C  ---------    URMAS - MACCB AHHX OOBATE:
C                       1-E COBO - KOECTBO APAMETPOB B CCKE
C                       ( ACAHO EM COM B BEECTBEHH MACCB )
C                       2-E COBO  AEE - APAMETP PSUB,
C                           AAHHE OOBATEEM;
C
C----------------------------------------------------------------------
C              STMAS - MACCB AHHX, EPEABAEMX B PSUB:
C
C      COBO           OOHAEHE   -   HAEHE
C      1               TN - BPEM N - O AA PACETA;
C      2               H0 - A HTEPPOBAH;
C      3               I1 - HAEHE 1-O TOKA, ATPEOBAHHOO
C                           OOBATEEM,  MOMEHTA BPEMEH TN;
C      4               I11- TOE,  MOMEHTA TN+H0;
C         AEE AHAOHO HAEH OCTAHX TOKOB;
C   N=3+2*NTOKOB       U1 - HAEHE 1-O HAPEH, ATPEOBAHHOO
C                           OOBATEEM,  MOMEHTA BPEMEH TN;
C    N+1               U11- TOE,  MOMEHTA TN+H0;
C         AEE AHAOHO HAEH OCTAHX HAPEH;
C
C----------------------------------------------------------------------
C              DGMAS  -  MACCB BECEHHX APAMETPOB C.
C
C   COBO        OOHAEHE - HAEHE:
C  OT 1 O 6     - HAEH MCIU ( KO C )
C                  MCIU = 00  --> "C" HET B [TN, TN+H0];
C                                  HX = 0.0;
C                  MCIU = 01  --> B [TN, TN+H0] -> EPEH POHT
C                                 MCA "C", HX = HTEPBA OT
C                                 TN O EPEHEO POHTA "C";
C                  MCIU = 10 -->  B [TN, TN+H0] -> AH POHT
C                                 MCA "C", HX = HTEPBA
C                                 OT TN O AHEO POHTA MCA  ;
C                  MCIU = 11 -->  B [TN, TN+H0] "C" BKEH,
C                                 COCTOHE HE MEH, HX=0.0;
C
C  OT 7 O 12    - HAEH COOTBETCTBX HX ( AA O BPEMEH
C                    O MOMEHTA MEHEH KOA C )
C----------------------------------------------------------------------
C              INTMAS - MACCB  OHOO COBA.
C                       ( B OPOPAMME HE COETC )
C----------------------------------------------------------------------
C
C   OPOPAMM: HET
C   -------------
C
C   PMEAHE: CMMA KOECTBA TPEEMX TOKOB  HAPEH
C   ----------  HE OHA PEBAT 49-T.
C               ( KOHTPO HE POBOTC )
C                ணࠬ  8.12.1991  ࠢ 
C                  ﬨ⥫ ....
CZZZ-------------------------------------------------------------------
       DIMENSION URMAS(*), STMAS(*), DGMAS(*), INTMAS(*)
       REAL INTMAS
C----------------------------------------------------------------------
       TN = STMAS(1)
       H0 = STMAS(2)
C----------------------------------------------------------------------
C BBOM AHHE
C----------------------------------------------------------------------
       UYPR  = STMAS(3)
       UYPR1 = STMAS(4)
       UOPAB = STMAS(5)
       UOPAB1= STMAS(6)
       UOPBC = STMAS(7)
       UOPBC1= STMAS(8)
       UOPCA = STMAS(9)
       UOPCA1= STMAS(10)
       TOKNG = STMAS(11)
       TOKNG1= STMAS(12)
       IF( ABS(TOKNG) .LT. 1.E-4 ) TOKNG = 0.0
       IF( ABS(TOKNG1).LT. 1.E-4 ) TOKNG1= 0.0
       DIMP  = URMAS(9)
       TIMEP = URMAS(10)
       TIME1 = URMAS(2)
       TIME2 = URMAS(3)
       TIME3 = URMAS(4)
       TIME4 = URMAS(5)
       TIME5 = URMAS(6)
       TIME6 = URMAS(7)
       TIME0 = URMAS(8)
       IF( (TIME1 + DIMP) .LT. TN ) TIME1 = 0.0
       IF( (TIME2 + DIMP) .LT. TN ) TIME2 = 0.0
       IF( (TIME3 + DIMP) .LT. TN ) TIME3 = 0.0
       IF( (TIME4 + DIMP) .LT. TN ) TIME4 = 0.0
       IF( (TIME5 + DIMP) .LT. TN ) TIME5 = 0.0
       IF( (TIME6 + DIMP) .LT. TN ) TIME6 = 0.0
       IF( (TIME0 + TIMEP).LT. TN ) TIME0 = 0.0
C----------------------------------------------------------------------
C-->  OHEM BXOHE AHHE
C----------------------------------------------------------------------
       DO 10 I= 1,12
       DGMAS(I) = 0.0
10     CONTINUE
C--> EM PAOTAT ?
C----------------------------------------------------------------------
C      ᫥  ⮫쪮  ﬨ⥫ !!!!!
C      IF( UYPR .LE. 0.0  .AND.  UYPR1 .LE. 0.0 ) RETURN
C----------------------------------------------------------------------
C----------------------------------------------------------------------
C--->  KAKO BEHT PAOTAET?
C----------------------------------------------------------------------
       C = UYPR1 - UYPR
C----------------------------------------------------------------------
C
C           BEHT A  "A"
C
C----------------------------------------------------------------------
C--->  BEHT KATOHO P.
C----------------------------------------------------------------------
       HXAK = -1.
       A = UOPAB1 - UOPAB
       IF( A .GT. 0 ) GO TO 100
       IF( A .EQ. C ) GO TO 100
       HXAK = H0 * (UYPR - UOPAB)/(A-C)
       IF( HXAK .LT. 0.0  .OR.  HXAK .GT. H0 ) HXAK = -1.
C----------------------------------------------------------------------
C-->  OPMPEM BXOHO CHA!
100    CONTINUE
       IF( HXAK .GE. 0.0 ) GO TO 2004
C->  HA AE EPEHEO POHTA HA AHHOM BEHTE HET.
       IF( TIME1 .GT. 0.0 ) GO TO 2001
C->  CHAA HE O  HET
       DGMAS(1) = 0.0
       GO TO 2005
2001   CONTINUE
C->  CHA   ET
       IF( (TIME1 + DIMP) .LE. (TN+H0) ) GO TO 2002
       DGMAS(1) = 11.
       GO TO 2005
2002   CONTINUE
C->  CHA , TEEP HE ET
       DGMAS(1) = 10.
       DGMAS(7) = TIME1 + DIMP - TN
       GO TO 2005
2004   CONTINUE
       if( time1 .GT. 0.0 ) go to 20005
C->  CHAA HE O, TEEP ET
       DGMAS(1) = 1.
       DGMAS(7) = HXAK
       TIME1 = TN + HXAK
       DGMAS(5) = 1.
       DGMAS(11) = HXAK
       TIME5 = TN + HXAK
       go to 2005
20005  continue
C->     ᭮ p p
       DGMAS(1) = 11.
       DGMAS(7) = 0.0
       TIME1 = TN + HXAK
       DGMAS(5) = 11.
       DGMAS(11) = 0.0
       TIME5 = TN + HXAK
2005   CONTINUE
C----------------------------------------------------------------------
C--->  BEHT AHOHO P.
C----------------------------------------------------------------------
       HXAA = -1.
       A = UOPAB - UOPAB1
       IF( A .GT. 0 ) GO TO 200
       IF( A .EQ. C ) GO TO 200
       HXAA = H0 * (UYPR + UOPAB)/(A-C)
       IF( HXAA .LT. 0.0  .OR.  HXAA .GT. H0 ) HXAA = -1.
C----------------------------------------------------------------------
C-->  OPMPEM BXOHO CHA!
200    CONTINUE
       IF( HXAA .GE. 0.0 ) GO TO 2009
C->  HA AE EPEHEO POHTA HA AHHOM BEHTE HET.
       IF( TIME4 .GT. 0.0 ) GO TO 2006
C->  CHAA HE O  HET
       DGMAS(4) = 0.0
       GO TO 2010
2006   CONTINUE
C->  CHA   ET
       IF( (TIME4 + DIMP) .LE. (TN+H0) ) GO TO 2007
       DGMAS(4) = 11.
       GO TO 2010
2007   CONTINUE
C->  CHA , TEEP HE ET
       DGMAS(4) = 10.
       DGMAS(10) = TIME4 + DIMP - TN
       GO TO 2010
2009   CONTINUE
       if( time1 .GT. 0.0 ) go to 20010
C->  CHAA HE O, TEEP ET
       DGMAS(4) = 1.
       DGMAS(10) = HXAA
       TIME4 = TN + HXAA
       DGMAS(2) = 1.
       DGMAS(8) = HXAA
       TIME2 = TN + HXAA
       go to 2010
20010  continue
C->     ᭮ p p
       DGMAS(4) = 11.
       DGMAS(10) = 0.0
       TIME4 = TN + HXAA
       DGMAS(2) = 11.
       DGMAS(8) = 0.0
       TIME2 = TN + HXAA
2010   CONTINUE
C----------------------------------------------------------------------
C
C           BEHT A  "B"
C
C----------------------------------------------------------------------
C--->  BEHT KATOHO P.
C----------------------------------------------------------------------
       HXBK = -1.
       A = UOPBC1 - UOPBC
       IF( A .GT. 0 ) GO TO 300
       IF( A .EQ. C ) GO TO 300
       HXBK = H0 * (UYPR - UOPBC)/(A-C)
       IF( HXBK .LT. 0.0  .OR.  HXBK .GT. H0 ) HXBK = -1.
C----------------------------------------------------------------------
C-->  OPMPEM BXOHO CHA!
300    CONTINUE
       IF( HXBK .GE. 0.0 ) GO TO 2014
C->  HA AE EPEHEO POHTA HA AHHOM BEHTE HET.
       IF( TIME2 .GT. 0.0 ) GO TO 2011
C->  CHAA HE O  HET
       DGMAS(2) = 0.0
       GO TO 2015
2011   CONTINUE
C->  CHA   ET
       IF( (TIME2 + DIMP) .LE. (TN+H0) ) GO TO 2012
       DGMAS(2) = 11.
       GO TO 2015
2012   CONTINUE
C->  CHA , TEEP HE ET
       DGMAS(2) = 10.
       DGMAS(8) = TIME2 + DIMP - TN
       GO TO 2015
2014   CONTINUE
       if( time1 .GT. 0.0 ) go to 20015
C->  CHAA HE O, TEEP ET
       DGMAS(2) = 1.
       DGMAS(8) = HXBK
       TIME2 = TN + HXBK
       DGMAS(6) = 1.
       DGMAS(12) = HXBK
       TIME6 = TN + HXBK
       go to 2015
20015  continue
C->     ᭮ p p
       DGMAS(2) = 11.
       DGMAS(8) = 0.0
       TIME2 = TN + HXBK
       DGMAS(6) = 11.
       DGMAS(12) = 0.0
       TIME6 = TN + HXBK
2015   CONTINUE
C----------------------------------------------------------------------
C--->  BEHT AHOHO P.
C----------------------------------------------------------------------
       HXBA = -1.
       A = UOPBC - UOPBC1
       IF( A .GT. 0 ) GO TO 400
       IF( A .EQ. C ) GO TO 400
       HXBA = H0 * (UYPR + UOPBC)/(A-C)
       IF( HXBA .LT. 0.0  .OR.  HXBA .GT. H0 ) HXBA = -1.
C----------------------------------------------------------------------
C-->  OPMPEM BXOHO CHA!
400    CONTINUE
       IF( HXBA .GE. 0.0 ) GO TO 2019
C->  HA AE EPEHEO POHTA HA AHHOM BEHTE HET.
       IF( TIME5 .GT. 0.0 ) GO TO 2016
C->  CHAA HE O  HET
       DGMAS(5) = 0.0
       GO TO 2020
2016   CONTINUE
C->  CHA   ET
       IF( (TIME5 + DIMP) .LE. (TN+H0) ) GO TO 2017
       DGMAS(5) = 11.
       GO TO 2020
2017   CONTINUE
C->  CHA , TEEP HE ET
       DGMAS(5) = 10.
       DGMAS(11) = TIME5 + DIMP - TN
       GO TO 2020
2019   CONTINUE
       if( time1 .GT. 0.0 ) go to 20020
C->  CHAA HE O, TEEP ET
       DGMAS(5) = 1.
       DGMAS(11) = HXBA
       TIME5 = TN + HXBA
       DGMAS(3) = 1.
       DGMAS(9) = HXBA
       TIME3 = TN + HXBA
       go to 2020
20020  continue
C->     ᭮ p p
       DGMAS(5) = 11.
       DGMAS(11) = 0.0
       TIME5 = TN + HXBA
       DGMAS(3) = 11.
       DGMAS(9) = 0.0
       TIME3 = TN + HXBA
2020   CONTINUE
C----------------------------------------------------------------------
C
C           BEHT A  "C"
C
C----------------------------------------------------------------------
C--->  BEHT KATOHO P.
C----------------------------------------------------------------------
       HXCK = -1.
       A = UOPCA1 - UOPCA
       IF( A .GT. 0 ) GO TO 500
       IF( A .EQ. C ) GO TO 500
       HXCK = H0 * (UYPR - UOPCA)/(A-C)
       IF( HXCK .LT. 0.0  .OR.  HXCK .GT. H0 ) HXCK = -1.
C----------------------------------------------------------------------
C-->  OPMPEM BXOHO CHA!
500    CONTINUE
       IF( HXCK .GE. 0.0 ) GO TO 2024
C->  HA AE EPEHEO POHTA HA AHHOM BEHTE HET.
       IF( TIME3 .GT. 0.0 ) GO TO 2021
C->  CHAA HE O  HET
       DGMAS(3) = 0.0
       GO TO 2025
2021   CONTINUE
C->  CHA   ET
       IF( (TIME3 + DIMP) .LE. (TN+H0) ) GO TO 2022
       DGMAS(3) = 11.
       GO TO 2025
2022   CONTINUE
C->  CHA , TEEP HE ET
       DGMAS(3) = 10.
       DGMAS(9) = TIME3 + DIMP - TN
       GO TO 2025
2024   CONTINUE
       if( time1 .GT. 0.0 ) go to 20025
C->  CHAA HE O, TEEP ET
       DGMAS(3) = 1.
       DGMAS(9) = HXCK
       TIME3 = TN + HXCK
       DGMAS(4) = 1.
       DGMAS(10) = HXCK
       TIME4 = TN + HXCK
       go to 2025
20025  continue
C->     ᭮ p p
       DGMAS(3) = 11.
       DGMAS(9) = 0.0
       TIME3 = TN + HXCK
       DGMAS(4) = 11.
       DGMAS(10) = 0.0
       TIME4 = TN + HXCK
2025   CONTINUE
C----------------------------------------------------------------------
C--->  BEHT AHOHO P.
C----------------------------------------------------------------------
       HXCA = -1.
       A = UOPCA - UOPCA1
       IF( A .GT. 0 ) GO TO 600
       IF( A .EQ. C ) GO TO 600
       HXCA = H0 * (UYPR + UOPCA)/(A-C)
       IF( HXCA .LT. 0.0  .OR.  HXCA .GT. H0 ) HXCA = -1.
C----------------------------------------------------------------------
C-->  OPMPEM BXOHO CHA!
600    CONTINUE
       IF( HXCA .GE. 0.0 ) GO TO 2029
C->  HA AE EPEHEO POHTA HA AHHOM BEHTE HET.
       IF( TIME6 .GT. 0.0 ) GO TO 2026
C->  CHAA HE O  HET
       DGMAS(6) = 0.0
       GO TO 2030
2026   CONTINUE
C->  CHA   ET
       IF( (TIME6 + DIMP) .LE. (TN+H0) ) GO TO 2027
       DGMAS(6) = 11.
       GO TO 2030
2027   CONTINUE
C->  CHA , TEEP HE ET
       DGMAS(6) = 10.
       DGMAS(12) = TIME6 + DIMP - TN
       GO TO 2030
2029   CONTINUE
       if( time1 .GT. 0.0 ) go to 20030
C->  CHAA HE O, TEEP ET
       DGMAS(6) = 1.
       DGMAS(12) = HXCA
       TIME6 = TN + HXCA
       DGMAS(1) = 1.
       DGMAS(7) = HXCA
       TIME1 = TN + HXCA
       go to 2030
20030  continue
C->     ᭮ p p
       DGMAS(6) = 11.
       DGMAS(12) = 0.0
       TIME6 = TN + HXCA
       DGMAS(1) = 11.
       DGMAS(7) = 0.0
       TIME1 = TN + HXCA
2030   CONTINUE
C----------------------------------------------------------------------
C-->  A KAK HA CET "ETOKOBO A"?
C----------------------------------------------------------------------
C      PRZV = TOKNG * TOKNG1
C      HXTOK = 0.0
C      IF( PRZV .GE. 0.0 ) GO TO 3000
C---> AA.
C      HXTOK = H0 * TOKNG / (TOKNG - TOKNG1)
C      IF( TIME0 .GT. 0.0  ) GO TO 3000
C      TIME0 = TN + HXTOK
C3000   CONTINUE
C       IF( TN .GE. (TIME0+TIMEP) ) GO TO 9999
C--> AA => OHMC
C       DO 4000 I=1,12
C       DGMAS(I) = 0.0
C4000   CONTINUE
C--> AOMHMC.
C9999   CONTINUE
       URMAS(2) = TIME1
       URMAS(3) = TIME2
       URMAS(4) = TIME3
       URMAS(5) = TIME4
       URMAS(6) = TIME5
       URMAS(7) = TIME6
       URMAS(8)= TIME0
       if ( TN .gt. 0.0 ) return
       DO 10123 I= 1,6
       DGMAS(I)  = 11.
       DGMAS(I+6)= 0.0
10123  CONTINUE
       time1 = h0/10.
       time2 = time1
       time3 = time1
       time4 = time1
       time5 = time1
       time6 = time1
       RETURN
C----------------------------------------------------------------------
       END
