         SUBROUTINE DM0024 ( MSW, RMSW, YALL, JALL, LOGYTR,
     *                       TOKN, TOKN1, VALLN, VALLN1, KOD,
     *                       MSWALL, RMSWAL, ADRMSW )
CXXX----KOMEKC "MS1" --> BEPC 1.1  (19 䥢ࠫ 1992.)------------
C   OPOPAMMA:  DM0024 ( MSW, RMSW, YALL, JALL, LOGYTR
C  -------------             TOKN, TOKN1, VALLN, VALLN1, KOD,
C                            MSWALL, RMSWAL, ADRMSW )
C
C   HAHAEHE:    B ABCMOCT OT HAEH AA ZAPROS [MASPRT(28)]:
C   -----------    BOHET CEE HK:
C
C
C                  A) ZAPROS = 1
C                  -------------
C                    CPOC AA FQ - BEH P. APAM. OPEEEH;
C                  === H EO HE PACTBAEM ==
C
C                  B) ZAPROS = 2
C                     ----------
C                      == B CAE HEBOO HAEH AA FQ -->
C                  BCEHE
C
C
C              FQ - PACET P. HAPEH BOHEH -->
C                  MEXAHM TOO AA OBOET CHXPOHPOBAT
C                  BOHEH PAHX DM_MOHTOPOB C .TA # 4;
C
C                  C) ZAPROS = 3
C                     **********
C                     HE OEPBAETC ( PEEPB );
C
C                  D) ZAPROS = 4
C                     **********
C                     HE OEPBAETC;
C
C----------------------------------------------------------------------
C
C              OPAATBAET MAKPOMOE HEHX HAMECKX BEHEB:
C
C  +-----+-------------------------------------------+----------------+
C  I     I                               I  EPEA-  I   PACETHA    I
C  I T I       HAMEHOBAHE BEHA      I  TOHA   I    OPMA     I
C  I     I                               I  HK  I                I
C  I-----I-------------------------------I-----------I----------------I
C  I     I  POOPOHAHO-CMMPEE  I           I                I
C  I 310 I       (  - PETOP )       I     K     I YN1=SUM(K*XN1) I
C  I     I                               I           I                I
C  I-----I-------------------------------I-----------I----------------I
C  I     I         HTEPPEE         I           I YN1 = YN +     I
C  I 311 I       (  - PETOP )       I   1/(TS)  I H0 * XN1 / TAU I
C  I     I                               I           I                I
C  I-----I-------------------------------I-----------I----------------I
C  I     I                               I           I YN1=YN*EXP(-H0/I
C  I 312 I         HEPOHHOE           I 1/(TS+1)  ITAU)+(1-EXP(-H0/I
C  I     I                               I           ITAU))*XN1       I
C  I-----I-------------------------------I-----------I----------------I
C  I     I    EHEPATOP O-OPAHOO   I I*        I I = UMAX -     I
C  I 319 I       HAA                 I I  *      I (UMAX-UMIN)*T/ I
C  I     I                               I I    *    I  TI            I
C  I-----I-------------------------------I-----------I----------------I
C  I     I         EPEHPEE      I           I YN1=YN*EXP(-H0/I
C  I 313 I       (  - PETOP )       I TS/(TS+1) ITAU) + EXP(-H0/ I
C  I     I                               I           ITAU * (XN1-XN)  I
C  +-----+-------------------------------+-----------+----------------+
C  I     I                                   I I*        I
C  I 350 I   .     I I  *      I
C  I     I                             I I    *    I
C  +-----+-------------------------------+-----------+----------------+
C  I     I                                   I I*        I
C  I 355 I   .     I I  *      I
C  I     I  ,ਭ㤨⥫쭠 樨 I I    *    I
C  I-----I-----------------------------------I-----------I
C                ******************************************************
C                PHAK TIP # 4 -> O. MAKPOMOE.
C
C----------------------------------------------------------------------
C              EMEHT OCBATC:
C
C       # T 310  0 
C              MAS < NBXOD  #1 #CM1 K1  #2 #CM2 K2  ... >
C              MAS < NGARM  W  A0  A1  FI1  A2  FI2... >
C
C      E
C          NBXOD  -   KOECTBO TOKOB EMEHTOB CXEM , KOTOPE
C                     COTC B KAECTBE BXOHX CHAOB;
C          #I,#CMI- HOMEP EMEHTA  HOMEP TOKA EMEHTA ,
C                     COEMOO B KAECTBE BXOHOO CHAA;
C          KI       - KOEHT POOPOHAHOCT TOKA I-TOO
C                     EMEHTA;
C          NGARM  -   KOECTBO EMEHTOB APMOHECKOO PA
C                     OCBAEO AAHH CHA, OABAEM
C                     HA BXO PETOPA (C ETOM OCT. COCTAB.);
C          W    -     ACTOTA OCHOBHO APMOHK (  );
C          A0,A1,...- AMT COOTBETBX APMOHK CHAA;
C          FI1,FI2...-HA. A COOTBETBX APMOHK CHAA;
C      ----------------------------------------------------------------
C
C       # T 311  0   #  #CM  TAU
C       # T 312  0   #  #CM  TAU
C       # T 313  0   #  #CM  TAU
C
C      E
C          # ,#CM - HOMEP EMEHTA  HOMEP TOKA EMEHTA ,
C                     COEMOO B KAECTBE BXOHOO CHAA;
C          TAU    -   OCTOHHA BPEMEH;
C----------------------------------------------------------------------
C        # T 319 UMAX UMIN TZ TP TI
C       E
C            UMAX  - MAKCM.HAPEHE
C            UMIN  - MHMA.HAPEHE
C            TZ    =  CB
C             TP   -  EPO
C              TI  -  TEHOCT
C      ----------------------------------------------------------------
C----------------------------------------------------------------------
C       # T 350  0   #1 #CM1 #2 #2    L
C
C      E
C          #1,#CM1- HOMEP EMEHTA  HOMEP TOKA EMEHTA ,
C                     COEMOO B KAECTBE BXOHOO ;
C          #2,#CM2- HOMEP EMEHTA  HOMEP TOKA EMEHTA ,
C                     COEMOO B KAECTBE BXOHOO   ;
C              -     . 
C              -    
C          L      -     
C----------------------------------------------------------------------
C       # T 355  0   #1 #CM1 #2 #2 #3 #3 #4 #4  UY
C
C      E
C          #1,#CM1- HOMEP EMEHTA  HOMEP TOKA EMEHTA ,
C                     COEMOO B KAECTBE  ;
C          #2,#CM2- HOMEP EMEHTA  HOMEP TOKA EMEHTA ,
C                     COEMOO B KAECTBE BXOHOO   ;
C          #3,#CM3- HOMEP EMEHTA  HOMEP TOKA EMEHTA ,
C                     COEMOO B KAECTBE   ;
C          #4,#CM4- HOMEP EMEHTA   TOKA EMEHTA ,
C                     COEMOO B KAECTBE BXOHOO   ;
C             -  । 㣫 ᪮ , ⨦ ண -
C                   稢 ० ਭ㤨⥫쭮 樨 .
C          UY     -  祭 ᨣ ࠢ  ୮ ०
C          
C----------------------------------------------------------------------
C
C   METO:     OPEEEHE BXOHX CHAOB HEHX HAMECKX
C   -----      BEHEB B COOTBETCTB C X EPEATOHM HKM.
C
C   APAMETP:     MSW, RMSW - PABEE COBO COCTOH MAKPOMOE
C   ---------      ( "OTPEOK" MACCB MSWALL -> C.M. / GETMSW );
C                  YALL - MATPA P0BOMOCT AHAPEMO E;
C                  JALL - BEKTOP CTOHKOB TOKA AHAPEMO E;
C                  VALLN - BEKTOP OBX HAPEH AHAPEMO E:
C                          B T = TN;
C                  VALLN1- BEKTOP OBX HAPEH AHAPEMO E:
C                          B T = TN + H0;
C                  TOKN    TOKN1  -  HAEH "TOKOB" P T :=
C                                     TN    TN + H0;
C                                   PAMEPHOCT CM. MASPRT(46)=NNTOK;
C                  LOGYTR - BEKTOP PHAKOB K.. OB:
C                  COETC B MAKPOMOEX C PHAKOM TA = 5;
C                  PAMEPHOC MACCBOB P "ALL" OPEETC:
C                   MAX_DIMENSION ---> NDALL = MASPRT(23)
C                   TEKA_PAMEPHOCT ---> NSYS = MASPRT(26)
C                  KOD - APAMETP OPATHO CB C MOHTOPOM DM....
C                   ( =1 P OO OK. OPEHOCT );
C                 MSWALL( (RMSWAL ) - BEC CCOK MSW_ALL,
C                 ADRMSW - APEC TEK. COAB MSW ( RMSW );
C
C
C   OPOPAMM:  1. COMMON PROF1, PROF2, PROF3;
C   ------------      DEPOST;
C
C   PMEAHE:  1.CTPKTP MSW COBA MAKPOMOE AHHOO TA CM. HE
C   ----------   2. P ZAPROS ^=   1  2 - COOEHE  XO;
C
C
C               "OCTOHHA" ACT MSW TOB # 310,311,312,313:
C                ----------------------------------------------
C
C  +-------+--------+--------+--------+------+------+-------+---+
C  I HOMEP I HOMEP  I HOMEP  I PHAKI KO I KO. IAP.   IPE I
C  I EME I TA   I /    I TA   I ECT I BB. IHA.   IE I
C  I HTA   I MOE I PACETAI MOE I BO   I HA I"TOKN" IPB I
C  I       I        I DM.....I       .I OBI EH.I"TOKN1"I   I
C  +-------+--------+--------+--------+------+------+-------+---+
C  I  1    I   2    I   3    I    4   I   5  I  6   I  7    I 8 I
C  +-------+--------+--------+--------+------+------+-------+---+
C
C                OPMAT RMSW T # 310:
C                ----------------------
C+-----------I--------------I------I-----------------------------------
C  # COBA   I    # COBA B I KTO  I
C OT HAAA  I    OTPEKE   IOPE.I
C BCEO MSW  I    RMSW B    I      I       OOHAEHE - HAEHE
C OCAH   I    FM0020    I      I
C------------I--------------I------I-----------------------------------
C     9      I     0        I      I HOMEP A ( BCEA 0 )
C----------------------------------------------------------------------
C    10      I     1        I  DM  I  FQ - A HOBE HA. BCEH
C            I              I      I   (  CHXPO. MAKPO. P.TIP # 4 )
C    11      I     2        I  FM  I  NBXOD-KOECTBO TOKOB, CO-
C            I              I      I        EMX KAK BXOHE CHA;
C    12      I     3        I  FM  I  #1 - HOMEP EMEHTA;
C    13      I     4        I  FM  I  #CM1 - HOMEP TOKA EMEHTA #1;
C    14      I     5        I  FM  I  K1   - KOEHT POOPOHA-
C            I              I      I         HOCT TOKA #CM1 -TA #1;
C    15      I     6        I  LM  I  ATOKM1 - AP B TOKN/N1 HAEH
C            I              I      I           TOKA HOMEP #CM1
C            I              I      I           EMEHTA #1;
C  8+I*4     I  -1+I*4      I  FM  I  #I -      -"-
C  9+I*4     I     I*4      I  FM  I  #CMI -      -"-
C 10+I*4     I   1+I*4      I  FM  I  KI   -      -"-
C 11+I*4     I   2+I*4      I  LM  I  ATOKMI -    -"-
C .......    I   .......    I  ... I  ..........................
C12+NBXOD*4  I  3+NBXOD*4   I  FM  I  NGARM -KOECTBO APMOHK, C.
C            I              I      I          OCAH A. CHAA;
C            I              I      I         (C ETOM OCT. COCTAB.);
C 13+NBXOD*4 I  4+NBXOD*4   I  FM  I  W  -   ACTOTA OCH. APMOHK();
C 14+NBXOD*4 I  5+NBXOD*4   I  FM  I  A0  -  AMTA OCT. COCTAB-
C            I              I      I         E A. CHAA;
C 15+NBXOD*4 I  6+NBXOD*4   I  FM  I  A1  -  AMTA 1-O APMOHK
C            I              I      I         AAHHOO CHAA;
C 16+NBXOD*4 I  7+NBXOD*4   I  FM  I  FI1 -  HA. AA 1-O APMOHK;
C 17+NBXOD*4 I  8+NBXOD*4   I  FM  I  A2  -  AMTA 2-O APMOHK;
C 18+NBXOD*4 I  9+NBXOD*4   I  FM  I  FI2 -  HA. AA 2-O APMOHK;
C .......    I   .......    I  ... I  ..........................
C----------------------------------------------------------------------
C
C  OA HA MSW --> LM<BC> = 12 + 4*NBXOD + 2*NGARM
C
C  HA EPEMEH. ACT --> LM<RMSW> = 3 + 4*NBXOD + 2*NGARM
C
C----------------------------------------------------------------------
C
C              OPMAT RMSW T # 311,312,313:
C              ------------------------------
C+-----------I--------------I------I-----------------------------------
C  # COBA   I    # COBA B I KTO  I
C OT HAAA  I    OTPEKE   IOPE.I
C BCEO MSW  I    RMSW B    I      I       OOHAEHE - HAEHE
C OCAH   I    FM0020    I      I
C------------I--------------I------I-----------------------------------
C     9      I     0        I      I HOMEP A ( BCEA 0 )
C----------------------------------------------------------------------
C    10      I     1        I  DM  I  FQ - A HOBE HA. BCEH
C            I              I      I   (  CHXPO. MAKPO. P.TIP # 4 )
C    11      I     2        I  FM  I         PEEPB
C            I              I      I
C    12      I     3        I  FM  I  #  - HOMEP EMEHTA;
C    13      I     4        I  FM  I  #CM  - HOMEP TOKA EMEHTA #1;
C    14      I     5        I  LM  I  ATOKM  - AP B TOKN/N1 HAEH
C            I              I      I           TOKA HOMEP #CM
C            I              I      I           EMEHTA #;
C    15      I     6        I  FM  I  TAU  - OCTOHHA BPEMEH;
C    16      I     7        I  FM  I         PEEPB
C----------------------------------------------------------------------
C
C              OPMAT RMSW T # 319
C              ------------------------------
C+-----------I--------------I------I-----------------------------------
C  # COBA   I    # COBA B I KTO  I
C OT HAAA  I    OTPEKE   IOPE.I
C BCEO MSW  I    RMSW B    I      I       OOHAEHE - HAEHE
C OCAH   I    FM0020    I      I
C------------I--------------I------I-----------------------------------
C     9      I     0        I      I HOMEP A ( BCEA 0 )
C----------------------------------------------------------------------
C    10      I     1        I  DM  I  FQ - A HOBE HA. BCEH
C            I              I      I   (  CHXPO. MAKPO. P.TIP # 4 )
C    11      I     2        I  FM  I         PEEPB
C            I              I      I
C    12      I     3        I  FM  I  UMAX - MAK. HAPEHE
C    13      I     4        I  FM  I  UMIN - MH. HAPEHE
C    14      I     5        I  LM  I  TZ   - CB O AE
C    15      I     6        I  FM  I  TP   - EPO CHAA
C    16      I     7        I  FM  I  TI   - TEHOCT CHAA
C----------------------------------------------------------------------
C  OA HA MSW --> LM<BC> = 16
C
C  HA EPEMEH. ACT --> LM<RMSW> = 7
C             OPMAT RMSW T # 350
C              ------------------------------
C+-----------I--------------I------I-----------------------------------
C  # COBA   I    # COBA B I KTO  I
C OT HAAA  I    OTPEKE   IOPE.I
C BCEO MSW  I    RMSW B    I      I       OOHAEHE - HAEHE
C OCAH   I    FM0020    I      I
C------------I--------------I------I-----------------------------------
C     9      I     0        I      I HOMEP A ( BCEA 0 )
C----------------------------------------------------------------------
C    10      I     1        I  DM  I  FQ - A HOBE HA. BCEH
C            I              I      I   (  CHXPO. MAKPO. P.TIP # 4 )
C    11      I     2        I  FM  I         PEEPB
C            I              I      I
C    12      I     3        I  FM  I  #1 - HOMEP EMEHTA;
C    13      I     4        I  FM  I  #CM1 - HOMEP TOKA EMEHTA #1;
C    14      I     5        I  LM  I  ATOKM1 - AP B TOKN/N1 HAEH
C            I              I      I           TOKA HOMEP #CM1
C            I              I      I           EMEHTA #1;
C    15      I     6        I  FM  I  #2 - HOMEP EMEHTA;
C    16      I     7        I  FM  I  #CM2 - HOMEP TOKA EMEHTA #1;
C    17      I     8        I  LM  I  ATOKM2 - AP B TOKN/N1 HAEH
C            I              I      I           TOKA HOMEP #CM2
C            I              I      I           EMEHTA #2;
C    18      I     9        I  FM  I     -         ;
C    19      I     10       I  FM  I     -  . ;
C    20      I     11       I  FM  I  L    -      ;
C    21      I     12       I  FM  I          PEEPB
C----------------------------------------------------------------------
C             OPMAT RMSW T # 355
C              ------------------------------
C+-----------I--------------I------I-----------------------------------
C  # COBA   I    # COBA B I KTO  I
C OT HAAA  I    OTPEKE   IOPE.I
C BCEO MSW  I    RMSW B    I      I       OOHAEHE - HAEHE
C OCAH   I    FM0020    I      I
C------------I--------------I------I-----------------------------------
C     9      I     0        I      I HOMEP A ( BCEA 0 )
C----------------------------------------------------------------------
C    10      I     1        I  DM  I  FQ - A HOBE HA. BCEH
C            I              I      I   (  CHXPO. MAKPO. P.TIP # 4 )
C    11      I     2        I  FM  I         PEEPB
C            I              I      I
C    12      I     3        I  FM  I  #1 - HOMEP EMEHTA;( ०
C            I              I      I  ਭ㤨⥫쭮 樨 )
C    13      I     4        I  FM  I  #CM1 - HOMEP TOKA EMEHTA #1;
C    14      I     5        I  LM  I  ATOKM1 - AP B TOKN/N1 HAEH
C            I              I      I           TOKA HOMEP #CM1
C            I              I      I           EMEHTA #1;
C    15      I     6        I  FM  I  #2 - HOMEP EMEHTA;
C    16      I     7        I  FM  I  #CM2 - HOMEP TOKA EMEHTA #1;
C    17      I     8        I  LM  I  ATOKM2 - AP B TOKN/N1 HAEH
C            I              I      I           TOKA HOMEP #CM2
C            I              I      I           EMEHTA #2;
C    18      I     9        I  FM  I  #3 - HOMEP EMEHTA;
C    19      I     10       I  FM  I  #CM3 - HOMEP TOKA EMEHTA #1;
C    20      I     11       I  LM  I  ATOKM3 - AP B TOKN/N1 HAEH
C            I              I      I           TOKA HOMEP #CM3
C            I              I      I           EMEHTA #3;
C    21      I     12       I  FM  I  #4 - HOMEP EMEHTA;
C    22      I     13       I  FM  I  #CM4 - HOMEP TOKA EMEHTA #1;
C    23      I     14       I  LM  I  ATOKM4 - AP B TOKN/N1 HAEH
C            I              I      I           TOKA HOMEP #CM4
C            I              I      I           EMEHTA #4;
C    24      I     15       I  FM  I  OME  - । 㣫 ᪮ ;
C    25      I     16       I  FM  I  UY   - 祭 ᨣ ࠢ;
C----------------------------------------------------------------------
C
C----------------------------------------------------------------------
C
C     B MACCBE TOKN  TOKN1 COEPTC:
C     **********************************
C     TOKN/N1(1) - HAEHE BXOHOO CHAA;
C
CZZZ-------------------------------------------------------------------
         COMMON /PROF1/ MASPRT(100)
         COMMON /PROF2/ MACTAB(800)
         COMMON /PROF3/ FUNTAB(50)
         DIMENSION MSW(*), RMSW(*), YALL(*), JALL(*), LOGYTR(*)
         DIMENSION VALLN(*), RMASPT(1), VALLN1(*), TOKN(*), TOKN1(*)
         DIMENSION MSWALL(*), RMSWAL(*)
         DIMENSION INTMAS(1), STMAS(100), DGMAS(12)
         EQUIVALENCE ( MASPRT(1), RMASPT(1) )
         EQUIVALENCE ( N , RN )         
         INTEGER ADRMSW
         REAL JALL, JNEL, MAXITR,INTMAS
         EQUIVALENCE ( ZAPROS, MASPRT(28) )
         EQUIVALENCE ( NNTOK,  MASPRT(46) )
         EQUIVALENCE ( NSYS,   MASPRT(26) )
         EQUIVALENCE ( NWTRE,  MASPRT(14) )
         EQUIVALENCE ( TN,     MASPRT(29) )
         EQUIVALENCE ( H0,     MASPRT(30) )
         EQUIVALENCE ( H1,     MASPRT(32) )
         EQUIVALENCE ( H2,     MASPRT(33) )
         EQUIVALENCE ( FITER,  MASPRT(65) )
         EQUIVALENCE ( EITER,  MASPRT(67) )
         EQUIVALENCE ( NLITER, MASPRT(79) )
         EQUIVALENCE ( MAXITR, MASPRT(80) )
         EQUIVALENCE ( NSITER, MASPRT(88) )
         EQUIVALENCE ( ZEROCP, MASPRT(50) )
         INTEGER FITER, TIP, ZAPROS
       KOD = 0
C**********************************************************************
       TIP = MSW(2)
       NTIP = TIP - 309
       IF ( TIP .EQ. 355 ) GO TO 9900 
       IF ( NTIP . EQ . 10.OR.NTIP.EQ.41 ) GO TO 9900
       IF ( NTIP .GE. 1 .AND. NTIP .LE. 4 ) GO TO 9900
C######################################################################
9999     CONTINUE
         NWTRE = MASPRT(14)
         WRITE(NWTRE,9998) MSW(1), MSW(2)
9998     FORMAT( ' *** O. CO B DM0024 - APOC HA OCBAHE O
     =O TA ***'/
     =    ' *** EMEHT # ', I10, ' T MOE # ', I10, ' ***'//)
         CALL SUBERR(0)
C######################################################################
9900   CONTINUE
C--->  BOP PEMA APOCA..
6666   GO TO( 100, 200), ZAPROS
C----------------------------------------------------------------------
C===> HAE OKA
         NWTRE = MASPRT(14)
         WRITE(NWTRE,9997) MSW(3), ZAPROS
9997     FORMAT( ' *** DM MOHTOP #', I4, ' APOC OCBAH OOEH
     = ***'/ ' *** ZAPROS = ', I5, ' - HOPPETC ***')
         RETURN
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C---- ZAPROS = 1 ------------------------------------------------------
100    CONTINUE
C==> CPOC AA       OCHOBHO PACET BOHEH;
       MSW(10) = 0
       RETURN
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C-----ZAPROS = 2 ------------------------------------------------------
200    CONTINUE
C-->  HHO  PAOTAT ?
       IF ( MSW(10) .EQ. 1 ) RETURN
C----------------------------------------------------------------------
C-->  PETC .............................
C-->  ZAPROS = 2 --> PACTAT HAEH....
       IF ( NTIP .EQ . 10) GO TO 5000
       IF ( TIP .EQ . 355) GO TO 7000       
       IF ( NTIP .EQ . 41) GO TO 6000
       GO TO (1000,2000,3000,4000),NTIP
C######################################################################
1000   CONTINUE
C----------------------------------------------------------------------
C-->   POOPOHAHO CMMPEE BEHO ( T 310 )
C----------------------------------------------------------------------
       NBXOD = MSW(11)
       NGARM = MSW(12 + 4*NBXOD)
       SIGNAL = 0.
       IF( NGARM .LT. 1 ) GO TO 1110
C----------------------------------------------------------------------
C--> PABM HAEHE AAHHOO BXOHOO CHAA
       W = RMSW(13 + 4*NBXOD)
       A0 = RMSW(14 + 4*NBXOD)
       SIGNAL = A0
       I1 = 2*(NGARM - 1)
       IF( I1 .EQ. 0 ) GO TO 1110
          DO 1100 I=1,I1,2
          NRMSW = 14 + I + 4*NBXOD
          AI = RMSW(NRMSW)
          FII= RMSW(NRMSW+1)
          N = I / 2 + 1
          SIGNAL = SIGNAL + AI * SIN(N*W*(TN+H0) + FII)
1100   CONTINUE
1110   CONTINUE
C----------------------------------------------------------------------
C--> POCMMPEM BXOHE CHA
       IF(NBXOD .EQ. 0 ) GO TO 1210
          DO 1200 I=1,NBXOD
          NMSW = 10 + I*4
          AKI  = RMSW(NMSW)
          TOKI = TOKN1( MSW(NMSW + 1) )
          SIGNAL = SIGNAL + AKI*TOKI
1200   CONTINUE
1210   CONTINUE
C----------------------------------------------------------------------
C--> AEM B TOKN1
       ITOK = MSW(7)
       TOKN1(ITOK) = SIGNAL
C----------------------------------------------------------------------
C-->  AKCP. KOHE BCEH       ( FQ A )
       MSW(10) = 1
       RETURN
C######################################################################
2000   CONTINUE
C----------------------------------------------------------------------
C-->   HTEPPEE BEHO ( T 311 )
C----------------------------------------------------------------------
       TAU = RMSW(15)
       NTOK=  MSW(14)
       TOKBX= TOKN1(NTOK)
C----------------------------------------------------------------------
C--> AEM B TOKN1
       ITOK=  MSW(7)
       TOKN1(ITOK) = TOKN(ITOK) + H0 * TOKBX / TAU
C----------------------------------------------------------------------
C-->  AKCP. KOHE BCEH       ( FQ A )
       MSW(10) = 1
       RETURN
C######################################################################
3000   CONTINUE
C----------------------------------------------------------------------
C-->   HEPOHHOE BEHO ( T 312 )
C----------------------------------------------------------------------
       TAU = RMSW(15)
       NTOK=  MSW(14)
       TOKBX= TOKN1(NTOK)
C----------------------------------------------------------------------
C--> AEM B TOKN1
       ITOK=  MSW(7)
       TOKN1(ITOK) = TOKN(ITOK) * EXP(-H0/TAU) +
     +               ( 1 - EXP(-H0/TAU) ) * TOKBX
C----------------------------------------------------------------------
C-->  AKCP. KOHE BCEH       ( FQ A )
       MSW(10) = 1
       RETURN
C######################################################################
4000   CONTINUE
C----------------------------------------------------------------------
C-->   EPEHPEE BEHO ( T 313 )
C----------------------------------------------------------------------
       TAU = RMSW(15)
       NTOK=  MSW(14)
       TOKBX = TOKN1(NTOK) - TOKN(NTOK)
C----------------------------------------------------------------------
C--> AEM B TOKN1
       ITOK=  MSW(7)
       TOKN1(ITOK) = TOKN(ITOK) * EXP(-H0/TAU) +
     +               EXP(-H0/TAU) * TOKBX
C----------------------------------------------------------------------
C-->  AKCP. KOHE BCEH       ( FQ A )
       MSW(10) = 1
       RETURN
C######################################################################
5000   CONTINUE
C----------------------------------------------------------------------
C-->   EHEPATOP O-OPAHOO CHAA ( T # 319 )
C----------------------------------------------------------------------
       UMAX  = RMSW(12)
       UMIN = RMSW(13)
       TZ = RMSW(14)
       TP = RMSW(15)
       TI = RMSW(16)
C----------------------------------------------------------------------
C--> AEM B TOKN1
       ITOK=  MSW(7)
       TOKN1(ITOK) = 0.0
       T1 = TN +H0 - TZ
       IF ( T1 .LT.0.) GO TO 5005
       T2 = AMOD(T1,TP)
       IF(T2.LE.TI) TOKN1(ITOK)=UMAX -(UMAX-UMIN)*T2/TI
C----------------------------------------------------------------------
C-->  AKCP. KOHE BCEH       ( FQ A )
5005   MSW(10) = 1
       RETURN
C######################################################################
6000   CONTINUE
C----------------------------------------------------------------------
C-->   㫠 ᯥ樠쭮  ᨭ஭ 設 ( 350 -150)
C----------------------------------------------------------------------
       NTOK=  MSW(14)
       TOKBX = ABS(TOKN1(NTOK)) 
       NTOK=  MSW(17)
       OMEGA = TOKN1(NTOK) 
       TETA  = RMSW(18)*OMEGA   
       EML   = RMSW(19)
       XR    = RMSW(20)
C----------------------------------------------------------------------
       TOKID = (COS(TETA) - 0.5)*EML / (XR*2.)
       IF ( TOKBX.GE.TOKID ) GOTO 6010
        UY0 = 2.*TOKBX*XR / EML - COS(TETA)
        GOTO  6100
6010   CONTINUE
       TOKID = COS(TETA + 0.5236 )*EML / (XR*2.)
       IF ( TOKBX.GE.TOKID ) GOTO 6020
        GAMMA = (1.0472 - TETA)*0.5
        FI   = ASIN(XR*TOKBX / (EML*SIN(GAMMA)))
        UY0 = COS(3.14159 - FI -GAMMA )
        GOTO  6100
6020   CONTINUE
       TOKID = (SIN(TETA) + COS(TETA+ 0.5236))*EML / (XR*2.)
       IF ( TOKBX.GE.TOKID ) GOTO 6030
        UY0 = 2.*TOKBX*XR / EML - COS(TETA + 0.5236)
        GOTO  6100
6030   CONTINUE
       TOKID = (COS(TETA) + 1.0 )*EML / (XR*2.)
       IF ( TOKBX.GE.TOKID ) GOTO 6040
        FI   = ACOS(2.*XR*TOKBX / EML - COS(TETA))
        UY0 = COS(FI + 0.5236 )
        GOTO  6100
6040   CONTINUE
         WRITE(NWTRE,6998) MSW(12), MSW(13)
6998     FORMAT( ' *** CO B DM0024 -     350
     =O TA ***'/
     =    ' *** EMEHT # ', I10, ' T MOE # ', I10, ' ***'//)
         CALL SUBERR(0)
C----------------------------------------------------------------------
6100     CONTINUE
C--> AEM B TOKN1
       ITOK=  MSW(7)
       TOKN1(ITOK) = UY0
C----------------------------------------------------------------------
C-->  AKCP. KOHE BCEH       ( FQ A )
       MSW(10) = 1
       RETURN
C######################################################################
7000   CONTINUE
C----------------------------------------------------------------------
C-->   㫠 ᯥ樠쭮  ᨭ஭ 設 ( 355)
C----------------------------------------------------------------------
       NTOK=  MSW(14)
       TOKYP = ABS(TOKN1(NTOK)) 
       NTOK=  MSW(17)
       TOKPE = TOKN1(NTOK) 
       NTOK=  MSW(20)
       CPERE = TOKN1(NTOK) 
       NTOK=  MSW(23)
       OMEGA = TOKN1(NTOK) 
       WOGR  = RMSW(24)   
       UY   = RMSW(25)
C----------------------------------------------------------------------
C-->  ਭ㤨⥫쭮 樨  ??? ....
C----------------------------------------------------------------------
       IF ( OMEGA .LE. WOGR ) GO TO 7010 
        UY =   TOKPE
       GO TO 7100
7010   CONTINUE
C-->   ० : ﬨ⥫   ?       
        KEY = MSW(12)
        IF ( TOKYP .LE. 0.001 )  KEY = 0
        IF ( CPERE .GT. 0.1 )  KEY = 1
        MSW(12) = KEY        
        IF (KEY .EQ. 0 )  UY = TOKPE 
C----------------------------------------------------------------------
7100     CONTINUE
C--> AEM B TOKN1
       ITOK=  MSW(7)
       TOKN1(ITOK) = UY
C----------------------------------------------------------------------
C-->  AKCP. KOHE BCEH       ( FQ A )
       MSW(10) = 1
       RETURN
C######################################################################
       END
