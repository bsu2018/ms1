       SUBROUTINE PSUB6( NEL, URMAS, STMAS, DGMAS, INTMAS )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT HOP  1988 .)------------
C   OPOPAMMA: PSUB6( NEL, URMAS, STMAS, DGMAS, INTMAS )
C   -------------
C   HAHAEHE:  / OOBATE  MOEPOBAH
C   ----------   AKOHOB PABEH  KOMEHCATOPOM
C                MOHOCT CKAEH ( AKTBHM TPOM B )
C                  ( MOE #17 - J P.)
C   BAPAHT:    BOMOH BA BAPAHTA MOE:
C   ---------  1.PHAK MOE = 0, MOE HEHA,
C                O BEHAM, EPEABAEMM OOBATEEM 
C                HAEHM TOKOB  HAPEH EMEHTOB CXEM
C                O MOMEHTA BPEMEH TN BKTEHO B OPOPAMME
C                OPEETC HAEH G,J-APAMETPOB MOE  T=TN+1
C              2.PHAK MOE = 1, MOE TEPAOHHA,
C                O BEHAM, EPEABAEMM OOBATEEM 
C                HAEHM TOKOB  HAPEH EMEHTOB CXEM
C                O MOMEHTA BPEMEH TN+1 BKTEHO B OPOPAMME
C                OPEETC HAEH G,J-APAMETPOB B MOMEHT TN+1
C                TEPAOHHM COCOOM
C   METO:     OEBEH.
C   -----
C  APAMETP:   NEL - HOMEP EMEHTA,  KOTOPOO PSUB PAOTAET;
C  ---------    URMAS - MACCB AHHX OOBATE:
C                       1-E COBO - KOECTBO APAMETPOB B CCKE
C                       ( ACAHO EM COM B BEECTBEHH MACCB);
C                       2-E COBO - PHAK MOE ( CM.BAPAHT );
C                       3-E COBO - MOMEHT BKEH MOE  T0;
C                       4-E COBO - KO AKOHA PABEH ( K );
C                       5-E COBO - EPO BCEH HTEPAHX
C                                   BEH;
C                       6-E COBO - KOECTBO TOKOB CXEM;
C                       7-E COBO - KOECTBO HAPOK;
C                       8-E COBO - TOHOCT OPEEEH CTAHOBB-
C                                   EOC PEMA;
C                       9-E COBO - <0 - PACET BEETC O CTAHOB.
C                                   PEMA, B P.CAE - BBO HTEP.
C                                   BEH EPE KA EPO O
C                                   OKOHAH MOEPOBAH;
C----------------------------------------------------------------------
C              STMAS - MACCB AHHX, EPEABAEMX B PSUB:
C
C      COBO           OOHAEHE   -   HAEHE
C      1               TN - BPEM N - O AA PACETA;
C      2               H0 - A HTEPPOBAH;
C      3               I1 - HAEHE 1-O TOKA, ATPEOBAHHOO
C                           OOBATEEM,  MOMEHTA BPEMEH TN;
C         AEE AHAOHO HAEH OCTAHX TOKOB;
C   N=3+NTOKOB       U1 - HAEHE 1-O HAPEH, ATPEOBAHHOO
C                           OOBATEEM,  MOMEHTA BPEMEH TN;
C         AEE AHAOHO HAEH OCTAHX HAPEH;
C
C----------------------------------------------------------------------
C              DGMAS(1) - PXOT HOMEP APOCA,
C                         EC DGMAS(1)=1, TO TO EPB BXO B
C                         OPOPAMM PSUB HA AHHOM AE,
C                         EC DGMAS(1)=2, TO TO HE EPBA TEPA
C                         BXOT PHAK MOE
C              DGMAS(2) - PXOT HAEHE TOKA MOE B MOMEHT TN+1,
C                         EC HOMEP APOCA = 1 ( DGMAS(1) ), TO
C                         TO HAEHE TOKA MOE, BCEHHOE HA
C                         PEEM AE,
C                         EC HOMEP APOCA = 2 ( DGMAS(1) ), TO
C                         TO HAEHE TOKA MOE, BCEHHOE HA
C                         PEE TEPA AHHOO AA
C                         BXOT  J-APAMETP (CT.TOKA CHTET.CXEM)
C              DGMAS(3) - G-APAMETP (POBOMOCT CHTETECKO CXEM)
C              DGMAS(4) - PH- AKTBHA MOHOCT KOMEHCPEMO HAPK
C              DGMAS(5) - QO - OMEHHA MOHOCT KOMEHCATOPA
C
C
C----------------------------------------------------------------------
C              INTMAS - MACCB  BXCOT (200) EMEHTOB,COETC
C                       B OPOPAMME  AOMHAH PETATOB
C                       POMETOHX BCEH.
C----------------------------------------------------------------------
C
C   OPOPAMM: HET
C   -------------
C
C   PMEAHE: CMMA KOECTBA TPEEMX TOKOB  HAPEH
C   ----------  HE OHA PEBAT 48.
C               ( KOHTPO HE POBOTC )
C----------------------------------------------------------------------
       DIMENSION URMAS(*), STMAS(*), DGMAS(*), INTMAS(*)
       COMMON /PROF1/ MASPRT(200)
       EQUIVALENCE ( NWTR ,MASPRT(13) )
       EQUIVALENCE ( NWTRE,MASPRT(14) )
       EQUIVALENCE ( TMAX ,MASPRT(43) )
C
C
C
C
C
C
C
C
       REAL INTMAS,KPD,KMH,KMK
C----------------------------------------------------------------------
       TN = STMAS(1)
       H0 = STMAS(2)
       T0 = URMAS(3)
       IF(URMAS(2).EQ.0.AND.DGMAS(1).NE.1) RETURN
       DGMAS(1) = URMAS(2)
C----------------------------------------------------------------------
       K=URMAS(4)
C      K - HOMEP AKOHA PABEH
C--> P AC OPM AKOHOB PABEH COOBAHO COKPAEHE "PK"
C    TO OTHOEHE DW(ETA W) MEHEH HEP KOMEHCATOPA C
C    MOMEHTA BKEH A EOE CO EPOOB K TEHOCT EPOA T
C======================================================================
C--> K=1        AKOH FRIZE  IK=-IH+PH/UK**2*UK(T)
C          E CTAA HEP HAKOTE
C    K=2        AKOH FRIZE  IK=-IH+(PH-PK)/UK**2*UK(T)
C          CO CTAAE HEP A EPO
C    K=3        IK=-IH+PH/UK**2*UK*SQRT(2.)*SIN(OMEGA*T)
C          E CTAA HEP HAKOTE
C    K=4        IK=-IH+PH/UK*SQRT(2.)*SIN(OMEGA*TN)-PK/UK**2*UK(T)
C          CTAA O KPBO HAPEH
C    K=5        IK=-IH+(PH-PK)/UK*SQRT(2.)*SIN(OMEGA*T)
C          CTAA O SIN AKOH
C    K=6        IK=-IH+PH*(1.-COS(2.*OMEGA*T)/UK(T)
C          P. O POM E CTAA
C    K=7        IK=-IH+PH*(1.-COS(2.*OMEGA*T)/UK(T)-PK/UK**2*UK(T)
C          POM CO CTAAE O KPBO HAPEH
C    K=8        IK=-IH+(PH-PK)*(1.-COS(2.*OMEGA*T))/UK(T)
C          POM  CO CTAAE O KPBO MOHOCT OT SIN
C    K=9        IK=0.
C          PACET HTEPAHX APAMETPOB PEMA E KOMEHCA
C    K=10  PACET O POM E OAOTK EEH HA H
C
C    K=11  PACET TOKO J-APAMETPA, G = 0.
C
C    K=12  O POM CO CTA. O KPBO MOHOCT
C                IK = -IH + (PH-PK) * (1-COS(2*WT))/UK(T)
C    K=13  O POM CO CTA. O KPBO MOHOCT
C                TO E.......PH+PK
C    K=14        IK = -IH + IH**2/(PH+PK)
C
C    B CCKE APAMETPOB PSUB5 OCE CTAHAPTHX APAMETPOB CET:
C    T - EPO BCEH APAMETPOB AKOHA;
C    NTOKOB - KOECTBO BBOMX TOKOB;
C    NNAGR - KOECTBO HAPOK B . E.
C    EPS - OKA OPEEEH CTAHOBBEOC PEMA
C    M -  BAPAHT BBOA HTEPAHX APAMETPOB ( 0   HE 0 )
C         PMEAH: 1. KOECTBO BBOMX HAPEH OHO T
C         -----------    PABHO KOECTB BBOMX TOKOB;
C                     2. OPOK BBOA  TOKOB EMEHTOB  X HA-
C                        PEH EH;
C                     3. EPBM B CCKAX BBOA CET TOK  HAP-
C                        EHE KOMEHCATOPA, BTOPM - TOK  HAPE-
C                        HE KOMEHCPEMO HAPK, AEE - TOK 
C                        HAPEH OCTAHX HAPOK, AEE - TOK
C                         HAPEH OCTAHX EMEHTOB.
C         COEPAHE  STMAS
C         -----------------
C    ------------------------------------------------------------------
C    HOMEP EMEHTA                     HAEHE
C    ------------------------------------------------------------------
C    1                                  CTAHAPTHE APAMETP PSUB5
C    2                                         =  "  =  "  =
C    2+I           ( I OT 1 O NTOKOB)  HAEH TOKOB EMEHTOB
C    2+NTOKOB+I    ( I OT 1 O NTOKOB)  HAEH HAPEH EMEHTOB
C    ------------------------------------------------------------------
C
C         COEPAHE INTMAS
C         -----------------
C    ------------------------------------------------------------------
C    HOMEP EMEHTA                     HAEHE
C    1                                  MOMEHT BPEMEH PEEO AA
C                                       ( TN-1 ) ;
C    2                                  EOE KOECTBO EPOOB, PO-
C                                       EX C MOMEHTA BKEH KOM-
C                                       EHCATOPA ( PER ) ;
C    3                                  HEP, OTAHHA ( PHTA )
C                                       KOMEHCATOPOM C HAAA AHHOO
C                                       EPOA ( TEKEE DW ) ;
C    4                                  HEP OTAHHA ( PHTA )
C                                       KOMEHCATOPOM C MOMEHTA BKE-
C                                       H  ( T0 ) A EOE CO PO-
C                                       EX EPOOB ;
C    5                                  TEKEE HAEHE HTEPAHO
C                                       CMM   BCEH  PH
C                                       ( APAMETPA AKOHA PABEH);
C    6                                  PH - HAEHE APAMETPA AKOHA,
C                                       COEMOE HA AHHOM AE ;
C    7                                  UH**2 - KBAPAT ECTBEO
C                                       HAEH HAPEH KOMEHCATO-
C                                       PA ( APAMETP AKOHA PABEH,
C                                       COEM HA AHHOM AE ) ;
C    8                                  TEKEE HAEHE HTEPAHO
C                                       CMM (IK+IH)**2*DT,  B-
C                                       CEH KOEHTA MOHOCT
C                                       HAPK C KOMEHCATOPOM ;
C    9                                  EC INTMAS(9) = 1, TO POECC
C                                       CTAHOBBC
C   10                                  T * P+  - COCTABA OMEHHO
C                                       MOHOCT KOMEHCATOPA
C   11                                  T * P-  - TO E
C   12                                  T+  - HTEPBA OOTEHX
C                                       HAEH MH.MOHOCT KOM-PA
C   13                                  T-  - HTEPBA OTPATEHX
C                                       HAEH MH.MOHOCT KOM-PA
C   14                                  QO  - OMEHHA MOHOCT KOM.
C   15                                  UK**2 * T -  CTAA
C                                       AACA HEP KOMEHCATOPA
C   16                                  DW A 1- EPO PAOT KM
C   17                                  IH**2 - APAMETP AKOHA
C                                       PABEH, HA AHHOM AE
C   18                                  HTEP.CMMA P(H+K)
C   19                                  P(H+K) - APAMETP AKOHA P.
C   20                                  TEK.H.HTEP.CMM TOKA HAP.
C    20 +I          (I OT 1 O NTOKOB)  TEKE HAEH HTEPAHX
C                                       CMM  BCEH ECTBX
C                                       HAEH TOKOB ;
C    20+NTOKOB+I    (I OT 1 O NTOKOB)  TO E  HAPEH ;
C    20+2*NTOKOB+I  (I OT 1 O NTOKOB)  TO E  AKTBHX MOHOCTE ;
C    ------------------------------------------------------------------
C-->  NMOD - OCTMOE KOECTBO MOEE AHHOO TA B CXEME
      NMOD = 3
C-->  POBOTC PACPEEEHE MACCBA  INTMAS  
C     MOEE AHHOO TA  -  PAHX EMEHTOB CXEM
C-----------------------------------------------------------------------
 124  DO 122 I=1,NMOD
      II = I
      NEL1 = IFIX(INTMAS(I))
      IF(NEL.EQ.NEL1) GO TO 123
 122  CONTINUE
 127  DO 125 I=1,NMOD
      III=I + 1
      NNEL = IFIX(INTMAS(NMOD+1))
      IF(NNEL.EQ.I) GO TO 126
 125  CONTINUE
      INTMAS(NMOD+1) = 1.
      II = 1
      INTMAS(1) = FLOAT(NEL)
      GO TO 123
 126  INTMAS(III) = FLOAT(NEL)
      INTMAS(NMOD+1) = INTMAS(NMOD+1) + 1
      NNEL = IFIX(INTMAS(NMOD+1))
      IF(NNEL.GT.NMOD) GO TO 128
      GO TO 124
 128  WRITE(NWTRE,170) NMOD
      TMAX = TN
      RETURN
 123  NJ = (II - 1) * 65  + NMOD + 1
C----------------------------------------------------------------------
      IF(TN.LE.T0) GO TO 103
 104  IF(TN.LT.T0) RETURN
      NTOKOB = URMAS(6)
      IF(DGMAS(1).EQ.2) GO TO 102
      T=URMAS(5)
      EPS = URMAS(8)
      NNAGR=URMAS(7)
      PI=3.141593
      DT=TN-INTMAS(NJ+1)
      PER=AINT((TN-T0)/T)
      IF(PER.GT.INTMAS(NJ+2)) GO TO 105
C-->  BCEHE HTEPAHO CMM  PH
 106  INTMAS(NJ+5) = INTMAS(NJ+5)+STMAS(4)*STMAS(2+NTOKOB+1)*DT
      INTMAS(NJ+8) = INTMAS(NJ+8) + (STMAS(3) + STMAS(4))**2*DT
      INTMAS(NJ+18) = INTMAS(NJ+18) + (STMAS(4)+STMAS(3))*
     *STMAS(2+NTOKOB+1)*DT
      INTMAS(NJ+20) = INTMAS(NJ+20) + STMAS(4)**2*DT
C     BCEHE OCTAHX HTEPAHX CMM
      DO 101 I=1,NTOKOB
      INTMAS(NJ+20+I) = INTMAS(NJ+20+I) + STMAS(2+I)**2*DT
      INTMAS(NJ+20+NTOKOB+I)=INTMAS(NJ+20+NTOKOB+I)+STMAS(2+NTOKOB+I)
     ***2*DT
 101  INTMAS(NJ+20+2*NTOKOB+I)=INTMAS(NJ+20+2*NTOKOB+I)+STMAS(2+I)*
     *STMAS(2+NTOKOB+I)*DT
C-->  BCEHE HTEPAHO CMM  HEP KOMEHCATOPA
      INTMAS(NJ+3) = INTMAS(NJ+20+2*NTOKOB+1)
C----------------------------------------------------------------------
C-->  BCEHE OMEHHO MOHOCT KOMEHCATOPA  QO
      IF(STMAS(2+1)*STMAS(2+NTOKOB+1)) 121,115,115
 115  INTMAS(NJ+10) = INTMAS(NJ+10) + STMAS(2+1)*STMAS(2+NTOKOB+1)*DT
      INTMAS(NJ+12) = INTMAS(NJ+12) + DT
      GO TO 116
 121  INTMAS(NJ+11) = INTMAS(NJ+11) + STMAS(2+1)*STMAS(2+NTOKOB+1) *DT
      INTMAS(NJ+13) = INTMAS(NJ+13) + DT
C----------------------------------------------------------------------
 116  IF(PER.GT.INTMAS(NJ+2)) GO TO 107
C-->  AOMHM BPEM TOO AA HA EE
      INTMAS(NJ+1)=INTMAS(NJ+1)+DT
C======================================================================
C     ABHA OPMA TEPA, BCEHE TOKA KOMEHCATOPA
 102  GO TO (1,2,3,4,5,6,7,8,9,10,11,12,13,14),K
      WRITE(NWTR,210) K
      TMAX=TN
      RETURN
C----------------------------------------------------------------------
   1  IF(INTMAS(NJ+7)) 129,131,129
 131  DGMAS(2) = 0.
      DGMAS(3) = 0.
      GO TO 132
 129  DGMAS(2) = -STMAS(4)
      DGMAS(3) = INTMAS(NJ+6)/INTMAS(NJ+7)
      GO TO 132
C----------------------------------------------------------------------
   2  IF(INTMAS(NJ+7)) 229,231,229
 231  DGMAS(2) =0.
      DGMAS(3) =0.
      GO TO 132
 229  DGMAS(2) = -STMAS(4)
      DGMAS(3) = INTMAS(NJ+6)/INTMAS(NJ+7)
      IF(INTMAS(NJ+15).NE.0.) DGMAS(3)=DGMAS(3)-INTMAS(NJ+4)/
     *INTMAS(NJ+15)
      GO TO 132
C----------------------------------------------------------------------
   3  DGMAS(3) = 0.
      IF(INTMAS(NJ+7)) 329,331,329
 331  DGMAS(2) = 0.
      GO TO 132
 329  DGMAS(2) = -STMAS(4)+INTMAS(NJ+6)/SQRT(INTMAS(NJ+7))*SQRT(2.)*
     *SIN(2.*PI*50.*TN)
      GO TO 132
C----------------------------------------------------------------------
   4  DGMAS(3) = 0.
      IF(INTMAS(NJ+15).NE.0.) DGMAS(3) = INTMAS(NJ+4)/INTMAS(NJ+15)
      IF(INTMAS(NJ+7)) 429,431,429
 431  DGMAS(2) = 0.
      GO TO 132
 429  DGMAS(2) = -STMAS(4)+INTMAS(NJ+6)/SQRT(INTMAS(NJ+7))*SQRT(2.)*
     *SIN(2.*PI*50.*TN)
      GO TO 132
C----------------------------------------------------------------------
   5  DGMAS(3) = 0.
      IF(INTMAS(NJ+7)) 529,531,529
 531  DGMAS(2) = 0.
      GO TO 132
 529  DGMAS(2) = -STMAS(4)+(INTMAS(NJ+6)/SQRT(INTMAS(NJ+7))-
     *INTMAS(NJ+4)/INTMAS(NJ+15))*SQRT(2.)*SIN(2.*PI*50.*TN)
      GO TO 132
C----------------------------------------------------------------------
   6  DGMAS(2) = -STMAS(4)
      DG1 = 1. - COS(2.*2.*PI*50.*TN)
      DG2 = STMAS(2+NTOKOB+1)**2
      IF(DG1.GT.DG2.AND.DG2.LT.1.E-10) GO TO 132
      DG1 = DG1*INTMAS(NJ+6)
      IF(INTMAS(NJ+6).EQ.0.) DGMAS(2) = 0.
      DGMAS(3) = DG1/DG2
      GO TO 132
C----------------------------------------------------------------------
   7  DGMAS(2) = -STMAS(4)
      DG1 = 1. - COS(2.*2.*PI*50.*TN)
      DG2 = STMAS(2+NTOKOB+1)**2
      IF(DG1.GT.DG2.AND.DG2.LT.1.E-10) GO TO 132
      DG1 = DG1*INTMAS(NJ+6)
      IF(INTMAS(NJ+6).EQ.0.) DGMAS(2) = 0.
      DGMAS(3) = DG1/DG2
      IF(INTMAS(NJ+15).NE.0.) DGMAS(3) = DGMAS(3) - INTMAS(NJ+4)/
     *INTMAS(NJ+15)
      GO TO 132
C----------------------------------------------------------------------
   8  DGMAS(2) = -STMAS(4)
      DG1 = 1. - COS(2.*2.*PI*50.*TN)
      DG2 = STMAS(2+NTOKOB+1)**2
      IF(DG1.GT.DG2.AND.DG2.LT.1.E-10) GO TO 132
      DG3 = INTMAS(NJ+6)
      IF(INTMAS(NJ+6).EQ.0.) DGMAS(2) = 0.
      IF(INTMAS(NJ+15).NE.0.) DG3 = DG3 - INTMAS(NJ+4)/INTMAS(NJ+15)
      DG1 = DG1*DG3
      DGMAS(3) = DG1/DG2
      GO TO 132
   9  DGMAS(2) = 0.
      DGMAS(3) = 0.
      GO TO 132
C----------------------------------------------------------------------
  10  DGMAS(2) = -STMAS(4)
      DG1 = 1. - COS(2.*2.*PI*50.*TN)
      DG2 = STMAS(2+NTOKOB+1)**2
      DG1 = DG1*INTMAS(NJ+6)
      IF(INTMAS(NJ+6).EQ.0.) DGMAS(2) = 0.
      DGMAS(3) = DG1/DG2
      GO TO 132
C----------------------------------------------------------------------
  11  DGMAS(3) = 0.
      DGMAS(2) = -STMAS(4) + INTMAS(NJ+6) * (1.- COS(2.*2.*PI*50.*TN))
     */STMAS(2+NTOKOB+1)
      GO TO 132
C----------------------------------------------------------------------
  12  DGMAS(2) = -STMAS(4)
      DG1 = 1. - COS(2.*2.*PI*50.*TN)
      DG2 = STMAS(2+NTOKOB+1)**2
      IF(INTMAS(NJ+15).NE.0) DG1 = DG1 - INTMAS(NJ+4)/INTMAS(NJ+15)
      DG1 = DG1*INTMAS(NJ+6)
      IF(INTMAS(NJ+6).EQ.0.) DGMAS(2) = 0.
      DGMAS(3) = DG1/DG2
      GO TO 132
C----------------------------------------------------------------------
  13  DGMAS(2) = -STMAS(4)
      DG1 = 1. - COS(2.*2.*PI*50.*TN)
      DG2 = STMAS(2+NTOKOB+1)**2
      IF(INTMAS(NJ+15).NE.0) DG1 = DG1 + INTMAS(NJ+4)/INTMAS(NJ+15)
      DG1 = DG1*INTMAS(NJ+6)
      IF(INTMAS(NJ+6).EQ.0.) DGMAS(2) = 0.
      DGMAS(3) = DG1/DG2
      GO TO 132
C----------------------------------------------------------------------
 14   IF(INTMAS(NJ+19)) 1429,1431,1429
 1431 DGMAS(2) = 0.
      DGMAS(3) = 0.
      GO TO 132
 1429 DGMAS(2) = -STMAS(4)
      DGMAS(3) = INTMAS(NJ+17)/INTMAS(NJ+19)
      GO TO 132
C----------------------------------------------------------------------
C
 132  DGMAS(4) = INTMAS(NJ+3) + INTMAS(NJ+4)
      DGMAS(5) = INTMAS(NJ+14)
      RETURN
 103  IH = NJ + 1
      IB = NJ+65
      DO 114 I=IH,IB
 114  INTMAS(I) = 0.
      INTMAS(NJ+1) =T0
      DGMAS(2) = 0.
      DGMAS(3) = 0.
      GO TO 104
C-->  AKOHM BCEH  PEEO EPOA
 105  DT1=T0+PER*T-INTMAS(NJ+1)
      DT2=DT-DT1
      DT=DT1
      GO TO 106
 107  INTMAS(NJ+2)=PER
      INTMAS(NJ+1) = T0+PER*T+DT2
      INTMAS(NJ+4) = INTMAS(NJ+4) + INTMAS(NJ+3)
      INTMAS(NJ+14) = PI/T * (INTMAS(NJ+10) * INTMAS(NJ+13) / T -
     *INTMAS(NJ+11) * INTMAS(NJ+12) / T)
      IF(INTMAS(NJ+2).EQ.2.) INTMAS(NJ+16)=INTMAS(NJ+4)
C
C----------------------------------------------------------------------
C-->  POBEPKA HA CTAHOBBC PEM
      PNOB = INTMAS(NJ+5)/T
      PNOB1= INTMAS(NJ+18)/T
      INTMAS(NJ+15) = INTMAS(NJ+20+NTOKOB+1)
      UNOB = INTMAS(NJ+20+NTOKOB+1)/T
      IF(INTMAS(NJ+20+2*NTOKOB+2).LE.1.E-32.OR.PNOB.LE.1.E-32.
     *OR.UNOB.LE.1.E-32) GO TO 111
      EPS1 = ABS(INTMAS(NJ+3)/INTMAS(NJ+20+2*NTOKOB+2))
      IF(EPS1.GT.EPS) GO TO 108
      EPS2 = ABS((PNOB - INTMAS(NJ+6))/PNOB)
      IF(EPS2.GT.EPS) GO TO 108
      EPS3 = ABS((UNOB - INTMAS(NJ+7))/UNOB)
      IF(EPS3.GT.EPS) GO TO 108
C-->  CTAHOBBC PEM
      INTMAS(NJ+9) = 1.
 133  PAKT = 0.
      INTMAS(NJ+17) = INTMAS(NJ+20)/T
      DO 112 I=1,NTOKOB
      INTMAS(NJ+20+I) = SQRT(INTMAS(NJ+20+I)/T)
      INTMAS(NJ+20+NTOKOB+I) = SQRT(INTMAS(NJ+20+NTOKOB+I)/T)
      INTMAS(NJ+20+2*NTOKOB+I) = INTMAS(NJ+20+2*NTOKOB+I)/T
 112  PAKT = PAKT + INTMAS(NJ+20+2*NTOKOB+I)
      WRITE(NWTR,120)
      WRITE(NWTR,130) (INTMAS(NJ+20+I),INTMAS(NJ+20+NTOKOB+I),
     *INTMAS(NJ+20+2*NTOKOB+I),I=1,NTOKOB)
      PNAGR = 0.
      DO 113 I=1,NNAGR
 113  PNAGR = PNAGR + INTMAS(NJ+21+2*NTOKOB+I)
      PPOT = PAKT - PNAGR
      KPD = PNAGR/PAKT
      WRITE(NWTR,140)
      WRITE(NWTR,130) PNAGR,PPOT,KPD
      DZIL = SQRT(INTMAS(NJ+8)/T)
      KMH = INTMAS(NJ+20+2*NTOKOB+2)/(INTMAS(NJ+20+2)*
     *INTMAS(NJ+20+NTOKOB+2))
      KMK = INTMAS(NJ+20+2*NTOKOB+2)/(DZIL*
     *INTMAS(NJ+20+NTOKOB+2))
      SK = INTMAS(NJ+20+1)*INTMAS(NJ+20+NTOKOB+1)
      WRITE(NWTR,150)
      WRITE(NWTR,130) KMH,KMK,SK
C     PER = PER - 1.                   BOMOHA PHA CO
      WK=INTMAS(NJ+16)
      WRITE(NWTR,160)
      WRITE(NWTR,130) PER,STMAS(1),INTMAS(NJ+4)
C        O T  A  K A       BBO INTMAS      ************************
C     WRITE(NWTR,200)
C200  FORMAT(//20X,'INTMAS       PSUB6 '/)
C
C191  WRITE(NWTR,190)(INTMAS(I),I=1,200)
C        K O H E     OTAOHX OEPATOPOB
      WRITE(7,180) KMH,KMK,SK,PPOT,KPD,PER,WK
      IF(URMAS(9).GE.0.) GO TO 134
C --> OCE OEPATOP  - OKOHAHE MOEPOBAH O OCTEH
C     CTAHOBBEOC POECCA B E C PABEMM KOMEHCAATOPOM
      TMAX = TN
      RETURN
 111  WRITE(NWTRE,110)
C-->  POECC HE CTAHOBC
C     AEM HOBE HAEH APAMETPOB AKOHA PABEH
 108  IF(URMAS(9).GE.0.) GO TO 133
 134  INTMAS(NJ+6) = PNOB
      INTMAS(NJ+7) = UNOB
      INTMAS(NJ+17) = INTMAS(NJ+20)/T
      INTMAS(NJ+19) = PNOB1
C-->  HAHEM HAKOEHE HTEPAHX CMM C HAAA
      INTMAS(NJ+5) = STMAS(4)*STMAS(2+NTOKOB+1)*DT2
      INTMAS(NJ+18) = (STMAS(3)+STMAS(4))*STMAS(2+NTOKOB+1)*DT2
      INTMAS(NJ+20) = STMAS(4)**2*DT2
      IF(STMAS(2+1)*STMAS(2+NTOKOB+1)) 117,118,118
 118  INTMAS(NJ+10) = STMAS(2+1) * STMAS(2+NTOKOB+1) * DT2
      INTMAS(NJ+12) = DT2
      INTMAS(NJ+11) = 0.
      INTMAS(NJ+13) = 0.
      GO TO 119
 117  INTMAS(NJ+11) = STMAS(2+1) * STMAS(2+NTOKOB+1) * DT2
      INTMAS(NJ+13) = DT2
      INTMAS(NJ+10) = 0.
      INTMAS(NJ+12) = 0.
 119  DO 109 I=1,NTOKOB
      INTMAS(NJ+20+I) = STMAS(2+I)**2*DT2
      INTMAS(NJ+20+NTOKOB+I) = STMAS(2+NTOKOB+I)**2*DT2
 109  INTMAS(NJ+20+2*NTOKOB+I) = STMAS(2+I)*STMAS(2+NTOKOB+I)*DT2
      INTMAS(NJ+8) = (STMAS(3) + STMAS(4))**2*DT2
      INTMAS(NJ+3) = INTMAS(NJ+20+2*NTOKOB+1)
      GO TO 102
 110  FORMAT(1X,'OOPTEHA HAPKA, POOA CTAT')
 120  FORMAT(1X,'ECTB. H. TOKOB.',5X,'ECTB. H. HAP.',5X,
     *'AKTBHE MOHOCT')
 130  FORMAT(1X,E12.5,20X,E12.5,20X,E12.5)
 140  FORMAT(1X,'AKT.MOHOCT HAPOK',5X,'MOHOCT OTEP HEP',5X
     *,' K... BCE E')
 150  FORMAT(1X,'KO. MOHOCT HAPK',5X,'KO.MO. C KOMEHCATOPOM
     *','OHA MOHOCT KOMEHCATOPA')
 160  FORMAT(1X,'BPEM EPEX. PEMA KM (EPO)',5X,'BPEM AA BBO
     *A TN',5X,'HEP,PHTA KOMEHCATOPOM')
 170  FORMAT(1X,'KOECTBO MOEE TA 17 PEBCO OCTMOE ( ',I2
     *,' )')
 180  FORMAT(7E11.4)
C190  FORMAT(10E12.3)
 210  FORMAT(///'HOMEP AOPTMA K = ',I3,'HE KAAH B KATAOE'/)
      END
