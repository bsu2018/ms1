       SUBROUTINE FM0016(BA0T, KNOTT, PAR0T, RMSW, LM )
CXXX----KOMèãEKC "MS1" --> BEPCàü 1.1  (OT  ÑEKAÅPü  1987 É.)-----------
C   èOÑèPOÉPAMMA: FM0016(BA0T, KNOTT, PAR0T, RMSW, LM )
C   -------------
C   HAáHAóEHàE:  HACTPOâKA MAKPOMOÑEãEâ ñàîPOBõX ãOÉàóECKàX ùãEMEHTOB:
C   ----------
C               +-----+--------------------------------------+
C               I     I                                      I
C               I Tàè I    HAàMEHOBAHàE ùãEMEHTA             I
C               I     I                                      I
C               +-----+--------------------------------------+
C               I 333 I ñàîPOBOâ  RS-TPàÉÉEP                 I
C               +-----+--------------------------------------+
C               I 334 I ñàîPOBOâ   D-TPàÉÉEP                 I
C               +-----+--------------------------------------+
C               I 335 I ñàîPOBOâ   T-TPàÉÉEP                 I
C               +-----+--------------------------------------+
C               I 360 I KOMèAPATOP(1)                        I
C               +-----+--------------------------------------+
C               I 361 I KOMèAPATOP(2)                        I
C               +-----+--------------------------------------+
C                èPàáHAK TIP # 4 -> ãOÉ. MAKPOMOÑEãú.
C                ( DM0020, LM0008 )
C                      îOPMàPìET "èEPEMEHHìû" óACTú RMSW OèàCAHàü
C
C                      ÑãàHA:  Ñãü BCEX TàèOB :==>+1<VAR>
C----------------------------------------------------------------------
C              ùãEMEHTõ OèàCõBAûTCü:
C
C         ù # T 33X ì 0 è   #ùã1 #CM1  #ùã2 #CM2 ;
C
C         ÉÑE
C          #ùãI,#CMI- HOMEP ùãEMEHTA à HOMEP TOKA ùãEMEHTA ,
C                     àCèOãúáìEMOÉO B KAóECTBE BXOÑHOÉO CàÉHAãA;
C         -------------------------------------------------------------
C
C         ù # T 360 ì 0 è   #ùã1 #CM1  #ùã2 #CM2 ;
C
C         ÉÑE
C          #ùãI,#CMI- HOMEP ùãEMEHTA à HOMEP TOKA ùãEMEHTA ,
C                     àCèOãúáìEMOÉO B KAóECTBE BXOÑHOÉO CàÉHAãA;
C         -------------------------------------------------------------
C
C         ù # T 361 ì 0 è   ì1  ì2  ì3  ì4 ;
C
C         ÉÑE
C            ìI     - HOMEPA ìáãOB, HAèPüÜEHàü MEÜÑì KOTOPõMà
C                     àCèOãúáìûTCü B KAóECTBE BXOÑHõX CàÉHAãOB;
C         -------------------------------------------------------------
C
C   METOÑ:         PAáMETKA èOãEâ RMSW èOÑ MOÑEãú
C   -----
C
C   èAPAMETPõ:     BA0T, KNOTT, PAR0T - "OTPEáKà" àHîOPMAñàOHHõX
C  ----------      MACCOBOB BA0, KNOT, PAR0 ( CM. INPUT0 à GETMSW );
C                  RMSW - "èEPEMEHHAü" óACTú MSW ( "OTPEáOK" MSWALL );
C                  LM - ÑãàHA "èEPEMEHHOâ" óACTà RMSW èPà FGMSW = 0;
C                  LM - ÑãàHA BCEÉO MSW OèàCAHàü      èPà FGMSW = 1;
C
C   èOÑèPOÉPAMMõ:  1.COMMON PROF1
C   ------------
C
C   èPàMEóAHàE:    1. KOHTPOãú B MàHàMAãúHOM OÅ"EME;
C   -----------    2. BCE HE OèPEÑEãüEMõE èOãü RMSW áAHìãüûTCü;
C                  3. HàÜE èPàBOÑüTCü îOPMATõ RMSW:
C
C
C              îOPMAT RMSW Tàè # 33X à 360:
C              ----------------------------
C+-----------I--------------I------I-----------------------------------
C  # CãOBA   I    # CãOBA B I KTO  I
C OT HAóAãA  I    OTPEáKE   IOèPEÑ.I
C BCEÉO MSW  I    RMSW B    I      I       OÅOáHAóEHàE - áHAóEHàE
C OèàCAHàü   I    FM0016    I      I
C------------I--------------I------I-----------------------------------
C     9      I     0        I      I HOMEP ìáãA ( BCEÉÑA 0 )
C----------------------------------------------------------------------
C    10      I     1        I  DM  I        PEáEPB
C            I              I      I
C    11      I     2        I  DM  I        PEáEPB
C            I              I      I
C    12      I     3        I  FM  I  #ùã1 - HOMEP ùãEMEHTA;
C    13      I     4        I  FM  I  #CM1 - HOMEP TOKA ùãEMEHTA #ùã1;
C    14      I     5        I  LM  I  ATOKM1 - AÑP B TOKN/N1 áHAóEHàü
C            I              I      I           TOKA HOMEP #CM1
C            I              I      I           ùãEMEHTA #ùã1;
C    15      I     6        I  FM  I  #ùã2 -      -"-
C    16      I     7        I  FM  I  #CM2 -      -"-
C    17      I     8        I  LM  I  ATOKM2 -    -"-
C----------------------------------------------------------------------
C  OÅôAü ÑãàHA MSW --> LM<BCü> = 17
C
C  ÑãàHA èEPEMEH. óACTà --> LM<RMSW> = 8
C----------------------------------------------------------------------
C
C
C              îOPMAT RMSW Tàè # 335:
C              ----------------------
C+-----------I--------------I------I-----------------------------------
C  # CãOBA   I    # CãOBA B I KTO  I
C OT HAóAãA  I    OTPEáKE   IOèPEÑ.I
C BCEÉO MSW  I    RMSW B    I      I       OÅOáHAóEHàE - áHAóEHàE
C OèàCAHàü   I    FM0016    I      I
C------------I--------------I------I-----------------------------------
C     9      I     0        I      I HOMEP ìáãA ( BCEÉÑA 0 )
C----------------------------------------------------------------------
C    10      I     1        I  DM  I        PEáEPB
C            I              I      I
C    11      I     2        I  DM  I        PEáEPB
C            I              I      I
C    12      I     3        I  FM  I  #ùã1 - HOMEP ùãEMEHTA;
C    13      I     4        I  FM  I  #CM1 - HOMEP TOKA ùãEMEHTA #ùã1;
C    14      I     5        I  LM  I  ATOKM1 - AÑP B TOKN/N1 áHAóEHàü
C            I              I      I           TOKA HOMEP #CM1
C            I              I      I           ùãEMEHTA #ùã1;
C----------------------------------------------------------------------
C  OÅôAü ÑãàHA MSW --> LM<BCü> = 14
C
C  ÑãàHA èEPEMEH. óACTà --> LM<RMSW> = 5
C----------------------------------------------------------------------
C
C
C                   îOPMAT RMSW Tàè # 361:
C                   ----------------------
C+-----------I--------------I------I-----------------------------------
C  # CãOBA   I    # CãOBA B I KTO  I
C OT HAóAãA  I    OTPEáKE   IOèPEÑ.I
C BCEÉO MSW  I    RMSW B    I      I       OÅOáHAóEHàE - áHAóEHàE
C OèàCAHàü   I    FM0016    I      I
C------------I--------------I------I-----------------------------------
C     9      I     0        I      I HOMEP ìáãA ( BCEÉÑA 0 )
C----------------------------------------------------------------------
C    10      I     1        I  DM  I        PEáEPB
C            I              I      I
C    11      I     2        I  DM  I        PEáEPB
C            I              I      I
C    12      I     3        I  FM  I  ì1   - HOMEP ìáãA;
C    13      I     4        I  FM  I  ì2   - HOMEP ìáãA;
C    14      I     5        I  FM  I  ì3   - HOMEP ìáãA;
C    15      I     6        I  FM  I  ì4   - HOMEP ìáãA;
C----------------------------------------------------------------------
C  OÅôAü ÑãàHA MSW --> LM<BCü> = 15
C
C  ÑãàHA èEPEMEH. óACTà --> LM<RMSW> = 6
CZZZ-------------------------------------------------------------------
       COMMON /PROF1/ MASPRT(200)
       DIMENSION BA0T(*), KNOTT(*), PAR0T(*), RMSW(*)
       EQUIVALENCE( NWTR, MASPRT(13) )
       EQUIVALENCE( NWTRE, MASPRT(14) )
       EQUIVALENCE( FGMSW, MASPRT(87) )
       EQUIVALENCE( H0   , MASPRT(30) )
       EQUIVALENCE ( RN  ,   N  )
       INTEGER  TIP, BA0T, FGMSW
       NEL = BA0T(1)
       TIP = BA0T(2)
       NTIP= TIP - 332
       GO TO ( 1 , 1 , 2  ), NTIP
       IF (  TIP .EQ. 360 ) GO TO 3
       IF (  TIP .EQ. 361 ) GO TO 4
C!!!-------------------------------------------------------------------
       WRITE(NWTRE, 501 ) NEL, TIP
501    FORMAT(/' *** ãOÉ. CÅOâ B FM0016 --> HOMEP TàèA HE HAò ***'/
     =  ' *** HOMEP ùãEMEHTA ', I5, ' HOMEP TàèA ', I5, ' ***'/)
C!!!-------------------------------------------------------------------
       CALL SUBERR(TIP)
C######################################################################
1      CONTINUE
C----------------------------------------------------------------------
C --->           ñàîPOBOâ RS-TPàÉÉEP
C --->           ñàîPOBOâ  D-TPàÉÉEP
C----------------------------------------------------------------------
C-->  èPàHüTú à óTO MOÜHO CîOPMàPOBATú..
       LM = 8
       DO 10 I=1,LM
10     RMSW(I) = 0.0
C---> BBEÑEM HOMEPA BXOÑHõX TOKOB.
       NEL1 = IFIX ( PAR0T(1) )
       NEL2 = IFIX ( PAR0T(3) )
       NSM1 = IFIX ( PAR0T(2) )
       NSM2 = IFIX ( PAR0T(4) )
C---> áAèOMHàM HOMEPA BXOÑHõX TOKOB.
       N = NEL1
       IF( N .GE. NEL ) GO TO 9999
       RMSW(3) = RN
       N = NEL2
       IF( N .GE. NEL ) GO TO 9999
       RMSW(6) = RN
       N = NSM1
       RMSW(4) = RN
       N = NSM2
       RMSW(7) = RN
       RETURN
C######################################################################
2      CONTINUE
C----------------------------------------------------------------------
C --->           ñàîPOBOâ  T-TPàÉÉEP
C----------------------------------------------------------------------
C-->  èPàHüTú à óTO MOÜHO CîOPMàPOBATú..
       LM = 5
       DO 20 I=1,LM
20     RMSW(I) = 0.0
C---> BBEÑEM HOMEPA BXOÑHõX TOKOB.
       NEL1 = IFIX ( PAR0T(1) )
       NSM1 = IFIX ( PAR0T(2) )
C---> áAèOMHàM HOMEPA BXOÑHõX TOKOB.
       N = NEL1
       IF( N .GE. NEL ) GO TO 9999
       RMSW(3) = RN
       N = NSM1
       RMSW(4) = RN
       RETURN
C######################################################################
3      CONTINUE
C----------------------------------------------------------------------
C --->           KOMèAPATOP(1)
C----------------------------------------------------------------------
C-->  èPàHüTú à óTO MOÜHO CîOPMàPOBATú..
       LM = 8
       DO 30 I=1,LM
30     RMSW(I) = 0.0
C---> BBEÑEM HOMEPA BXOÑHõX TOKOB.
       NEL1 = IFIX ( PAR0T(1) )
       NEL2 = IFIX ( PAR0T(3) )
       NSM1 = IFIX ( PAR0T(2) )
       NSM2 = IFIX ( PAR0T(4) )
C---> áAèOMHàM HOMEPA BXOÑHõX TOKOB.
       N = NEL1
       RMSW(3) = RN
       N = NSM1
       RMSW(4) = RN
       N = NEL2
       RMSW(6) = RN
       N = NSM2
       RMSW(7) = RN
       RETURN
C######################################################################
4      CONTINUE
C----------------------------------------------------------------------
C --->           KOMèAPATOP(2)
C----------------------------------------------------------------------
C-->  èPàHüTú à óTO MOÜHO CîOPMàPOBATú..
       LM = 6
       DO 40 I=1,LM
40     RMSW(I) = 0.0
C---> BBEÑEM HOMEPA BXOÑHõX ìáãOB.
       NY1 = IFIX ( PAR0T(1) )
       NY2 = IFIX ( PAR0T(2) )
       NY3 = IFIX ( PAR0T(3) )
       NY4 = IFIX ( PAR0T(4) )
C---> áAèOMHàM HOMEPA BXOÑHõX ìáãOB.
       N = NY1
       RMSW(3) = RN
       N = NY2
       RMSW(4) = RN
       N = NY3
       RMSW(5) = RN
       N = NY4
       RMSW(6) = RN
       RETURN
C######################################################################
9999   CONTINUE
C!!!-------------------------------------------------------------------
       WRITE(NWTRE, 555 ) NEL, TIP,N
555    FORMAT(/' *** OòàÅKA B FM0016 -->HEèPABàãúHO áAÑAHõ BXOÑHõE ÑAHHõ
     =E   ***'/' *** HA BXOÑ ùãEMEHTA ', I5, ' HOMEP TàèA ', I5,' ***',
     =         ' *** èOÑAETCü TOK ùãEMEHTA, àMEûôEÉO ÅOãúòàâ èOPüÑKOBõâ
     =HOMEP ( # ' ,I3,' )  *** ')
C!!!-------------------------------------------------------------------
       CALL SUBERR(TIP)
C----------------------------------------------------------------------
       RETURN
       END
