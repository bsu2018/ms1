         SUBROUTINE DM00B9(KQ,MQ,NPEL,MSWX, RMSWX, YALL, JALL, LOGYTR,
     *                       TOKXN, TOKXN1, VALLN, VALLN1, KOD,
     *         UOPN, UOPN1, UYPN, UYPN1, DTCIU )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C   OPOPAMMA:  DM00B9 (KQ,MQ,NPEL, MSWX, RMSWX, YALL, JALL, LOGYTR,
C   -------------            TOKXN, TOKXN1, VALLN, VALLN1, KOD,
C                             UOPN, UOPN1, UYPN, UYPN1, DTCIU )
C
C
C   HAHAEHE:    MOHTOP MOE P. BEHT  [ MO. # B9, .T # 6 ]
C   -----------    ****************************************************
C                  [ CE. PMEHEHE B MAKPOMOEX PEOPAOBATEE ]
C                  ----------------------------------------------------
C @ - OT 21.11.86.
C
C                      MACCB MSWX ( RMSWX ) - CEAHOO OPMATA:
C                      -------------
C**********************************************************************
C
C
C
C       OPMAT MSWV_EHT  DM00B9:
C       -------------------------------
C
C      COBO                   HAEHE
C
C      1       KD - KO COCTOH: =0 - AKPT, =1 - OTKPT;
C      2       HX - A OT TN, BOMOHOE BPEM EPEKEH;
C
C ( B [*] HOMEPA MSW_VEHT  / "MCIU50" )
C
C  [1] 3       TS - BPEM CTAPTA MCA( "E" KOMMTA );
C  [2] 4       TK - BPEM HA MCA( "E" KOMMTA );
C  [3] 5       CX - KO PAPEEH/APETA "C":
C                   =0 - C APEEHO OABAT HA BEHT,
C                   =1 - C PAPEEHO OABAT HA BEHT;
C [4] 6        TX - BPEM, C KOTOPOO ECTBET KO "CX";
C
C
C [5] 7        MCIU - KO MCA --->
C                     MCIU   = 00  --> "C" HET B [TN, TN+H0];
C                                       HXCIU = 0.0;
C                     MCIU   = 01  --> B [TN, TN+H0] -> EPEH POHT
C                                   MCA "C", HXCIU = HTEPBA OT
C                                      TN O EPEHEO POHTA "C";
C                     MCIU   = 10 -->  B [TN, TN+H0] -> AH POHT
C                                   MCA "C", HXCIU = HTEPBA
C                                      OT TN O AHEO POHTA MCA;
C                     MCIU   = 11 -->  B [TN, TN+H0] "C" BKEH,
C                                      COCTOHE HE MEH, HXCIU=0.0;
C
C
C [6] 8        HXCIU - A OT TN, O OEPEHOO POHTA "C";
C (---)
C     9              - A KD COCTOH;
C    10              - PEEPB
C********************************************************************
C
C
C
C                      MOE OPEEET HAE C. PABEH "C"
C                      HA BEHTE O AOPTM CPABHEH OOPHOO
C                       MOPEO HAPEH:
C
C                      UOPN, UOPN1 - HAEHE OOPHOO HAP. B TN, TN+H0
C                      UYPN, UYPN1 - HAEHE MOP. HAP. B TN, TN+H0
C
C                     - T HAPEH, A TAK E O "CX"  "TX" B MSWX
C                      HEOXOMO OPEET TOKO P "ZAPROS=3"
C                      O B TOKXN, TOKXN1 OT (1) - OH K TOM
C                      MOMEHT TAK E T OPEEEH;
C
C                     - B OCTAHX "ZAPROC=1, 10, 20, 4", OCTATOHO
C                       MET OPEEEHM TOKO RMWX  VALLN/N1;
C
C
C                      OPMAT MACCBOB TOKXN  TOKXN1:
C
C      1 - COBO -> TOK BEHT ;       ( OPEEETC  TN+H0 P
C                                         ZAPROS = 20 );
C      2 - COBO -> HAEHE CHAA P. "C" ( OPE. P ZAPROS=3);
C
C
C              DTCIU - TEHOCT MCA "C", P
C                      DTCIU_PACETHOE < DTMCIU[MASPRT(94)] --->
C                      CTAETC, TO "C" HA BEHT HE OABAOC;
C
C              K, M -  OK. BEHT, NPEL - EO OP. HOMEP.
C
C              "ECTECTBEHHOE" PABEHE "C":[ DU** = U**N1 - U**N ]:
C              P DUN < 0, A DUN1 >= 0, EHEPPETC EPE. POHT "C"
C              P TOM TBAETC KO CX  TX BPEM -> CX - KO
C              PAPEEH (=1)  (=0) APETA OA "C"( CM. /
C                                                          MCIU50 );
C                  B ABCMOCT OT HAEH AA ZAPROS [MASPRT(28)]:
C                  BOHET CEE HK:
C
C                  A) ZAPROS = 1
C                     ----------
C                 -  OPMPOBAHE BKAOB B YALL MATP POBOMOCTE
C                   HAEH "POBOMOCT" AKPTOO BEHT ( GVENT6 )
C                   [ B AHHO BEPC KOMEKCA ];
C                  - OPMPOBAHE BEKTOPA K.. OB "LOGYTR"
C                     HEHTHX OB --> COETC
C                     /  GETLOG --> OCECTBT "EMEHTAPH" BKA;
C
C                  1A) ZAPROS = 10
C                      ------------
C                      OPMPOBAHE "TEHEBO" CCTEM PABHEH
C                       ( OEMEHTH BKA )
C
C                  B) ZAPROS = 20
C                     ------------
C                  BCEHE HAEH TOKOB B BETBX B T(N+1) MOMEHT
C                  BPEMEH. P TOM TOK OTKPTX BEHTE:( K  M )
C                  <TOKXN1>:= <VALLN1[K]> - <VALLN1[M]>;
C                   TOK AKPTX BEHTE = 0.0;
C                  AC TX TOKOB B MACCB TOKXN1;
C                   !!! BOHT O MOKA PEEH VALLN1 !!!
C
C                  C) ZAPROS = 3
C                     -----------
C                     OBOTC AHA HA BOMOH CMEH COCTOH
C                     BEHT [ OTKPT <==> AKPT ]:
C                     P TOM: FKOM = 0 - COCTOHE HE MEHOC;
C                               FKOM = 1 - HA TEKEM AE COCTOHE
C                                         OHO "O" MEHTC B
C                                         B T = TX MOMEHT BPEMEH;
C                                         PEAHO B POPAMME OPEE-
C                                         ETC HX - A BOMOHO
C                                         KOMMTA, ATEM TX=TN+HX;
C                                         P HX < HXMIN [MASPRT(62)]
C                                         PHMAETC HX = HXMIN;
C                                         COCTOHE HX=0.0 BBAET
C                                         EAT COOEH;
C                                         POBEEH COTBETCTBE
C                                         MEHEH B MASPRT:
C                                          FKOM <== "1"
C                                         HXG = MIN( HX, HXG )
C                                         TXG = TN + HXG
C
C              ET: ICLOSE - MO TOKA "AKPT" BEHT;
C                    UOPEN  - MO HAPEH "OTKPT" BEHT;
C
C
C                  D) ZAPROS = 4
C                     **********
C                   - P TX_G  [MASPRT(35)] .EQ. TX_BEHT   -
C                      KCPETC CMEHA COCTOH BEHT APAMETPOM
C                      KD_BEHT;
C                     PABEHCTBO POBEPETC C TO. O "EPSKOM".
C
C   METO:         PAHOBHOCT BOHOBOO AOPTMA  OPMPOBAH
C   -----          MACCBA LOGYTR --> EPE / GETLOG;
C
C                  "TEHEBA" CCTEMA OPMPETC "MACTAPOBAHHA"
C                   TAK, TO: V[X] - V[Y] = <TOK    X-Y   BETB>;
C                   , OTMEEHHE B LOGYTR(*) = 0 - "AOBE"
C                    KAO HEHTHO P OTKPTX BEHTE;
C
C   APAMETP:     MSWX(RMSWX) - PABEE COBO COCTOH MAKPOMOE
C   ---------      ( MACCB CE. HAHAEH );
C                  YALL - MATPA P0BOMOCT AHAPEMO E;
C                  JALL - BEKTOP CTOHKOB TOKA AHAPEMO E;
C                  VALLN - BEKTOP OBX HAPEH AHAPEMO E:
C                          P  T  =  TN;
C                  VALLN1- BEKTOP OBX HAPEH AHAPEMO E:
C                          P  TN + H0;
C                  TOKXN   TOKXN1 - HAEHE EPEMEHHX "COCTOH"
C                                  MOE P TN    TN + H0;
C                  ( 1-COBO -> TOK, 2-COBO "C" );
C
C                KQ -  "AHO" - HOMEP A;
C                MQ - "KATO" - HOMEP A;
C
C                  LOGYTR - BEKTOP PHAKOB K.. OB:
C                  COETC B MAKPOMOEX C PHAKOM TA = 6;
C                  PAMEPHOC MACCBOB P "ALL" OPEETC:
C                   MAX_DIMENSION ---> NDALL = MASPRT(23)
C                   TEKA_PAMEPHOCT ---> NSYS = MASPRT(26)
C                  KOD - APAMETP OPATHO CB C MOHTOPOM DM....
C
C
C
C
C   OPOPAMM:  1. COMMON PROF1, PROF2, PROF3;
C   ------------   2. GETLOG,    MCIU50,       DEPOST;
C
C   PMEAHE:  1.CTPKTP MSW COBA MAKPOMOE AHHOO TA CM. HE
C   ----------   2. P ZAPROS ^=1, 10,20,3,4 - BAA COOEH  XO
C                3. P FTEST = 1 -> EAT HA WTRE AKTA CMEH COCTOH
C
C   **** BHMAHE *** B 06.01.87   OKPOBAHO BBO COOEH
C                                  O CPOCE B CTAPT. TOK P
C                                  MMCIU = 11 ***********
C
C
C
C   ****BHMAHE *****
C
C
CZZZ-------------------------------------------------------------------
         COMMON /PROF1/ MASPRT(200)
         COMMON /PROF2/ MACTAB(800)
         COMMON /PROF3/ FUNTAB(50)
         DIMENSION MSWX(*), RMSWX(*), YALL(*), JALL(*), LOGYTR(*)
         DIMENSION VALLN(*), RMASPT(1), VALLN1(*), TOKXN(*), TOKXN1(*)
         REAL JALL, JRL, L, IRLT, IRLN
       DIMENSION MSWALL(*), RMSWAL(*)
       INTEGER ADRMSW
         EQUIVALENCE ( MASPRT(1), RMASPT(1) )
         EQUIVALENCE ( MASPRT(94), DTMCIU )
         EQUIVALENCE ( MASPRT(62), HXMIN )
         EQUIVALENCE ( MASPRT(14), NWTRE )
         EQUIVALENCE ( MASPRT(59), GVENT6 )
         EQUIVALENCE ( MASPRT(60), FTEST )
         EQUIVALENCE ( MASPRT(57), OPEN6 )
         INTEGER FTEST, OPEN6
         EQUIVALENCE ( ZAPROS, MASPRT(28) )
         EQUIVALENCE ( NDALL,  MASPRT(23) )
         EQUIVALENCE ( TN,     MASPRT(29) )
         EQUIVALENCE ( H0,     MASPRT(30) )
         EQUIVALENCE ( H1,     MASPRT(32) )
         EQUIVALENCE ( H2,     MASPRT(33) )
         EQUIVALENCE ( FKOM,   MASPRT(34) )
         EQUIVALENCE ( TXG,    MASPRT(35) )
         EQUIVALENCE ( HXG,    MASPRT(61) )
         EQUIVALENCE ( NTXG,   MASPRT(36) )
         EQUIVALENCE ( EPSKOM, MASPRT(39) )
         EQUIVALENCE ( ZEROCP, MASPRT(50) )
         INTEGER FKOM, ZAPROS
         EQUIVALENCE ( ICLOSE, MASPRT(77) )
         EQUIVALENCE ( UOPEN,  MASPRT(78) )
         REAL ICLOSE
       K = KQ
       M = MQ
C---> BOP PEMA:
         IF ( ZAPROS .EQ. 1 ) GO TO 667
         IF ( ZAPROS .EQ. 10 ) GO TO 6670
         IF ( ZAPROS .EQ. 20 ) GO TO 6660
         IF ( ZAPROS .EQ. 3 ) GO TO 600
         IF ( ZAPROS .EQ. 4 ) GO TO 500
C===> HAE OKA
         NWTRE = MASPRT(14)
         WRITE(NWTRE,9997)         ZAPROS
9997     FORMAT( ' *** DM MOHTOP #00B9', ' APOC OCBAH OOEH
     = ***'/ ' *** ZAPROS = ', I5, ' - HOPPETC ***')
         RETURN
667      CONTINUE
C---------------Z A P R O S = 1----------------------------------------
         KOD = 0
C---> "CPOC" HAEH TX - BOMOHOO BPEMEH EPEKEH.....
         RMSWX(2) =      H0
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
         MSWX(9) = 0
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
         KD = MSWX(1)
C--->    EC "K"  "M" HEHTH --->  BBAT GETLOG.....
         IF ( KD .EQ. 0 ) GO TO 6607
C--->    ECT "KOHTAKT"  [ KD = 1 ]
         CALL GETLOG( K, M, LOGYTR )
         RETURN
6607     CONTINUE
C===> BEHT AKPT ==> KD=0 <====== "MAKET" OEH MAO POBOMOCT
C---> EC NVENT6 = 0.0, TO MAKET HE HEH...
         IF ( GVENT6 .EQ. 0.0 ) RETURN
C--->
         G = GVENT6
C--->
C--->   OEMEHTH BKA:
         CALL DEPOST( K, M, G, 0.0, YALL, JALL )
C---->
         RETURN
C======================================================================
C$$$$$$$ ZAPROS = 10 $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C--->  OPMPOBAHE "TEHEBO" CCTEM  P OTKPTX BEHTE
6670     CONTINUE
         KOD = 0
         KD = MSWX(1)
         IF ( KD .EQ. 0 ) RETURN
C----------------------------------------------------------------------
         G = 1.0
C----------------------------------------------------------------------
C--->  BPOCT "AOBE"     HEHTHX P...
         IF ( K .EQ. 0 ) GO TO 6671
         IF ( LOGYTR(K) .EQ. -1 ) K = 0
6671     CONTINUE
         IF ( M .EQ. 0 ) GO TO 6672
         IF ( LOGYTR(M) .EQ. -1 ) M = 0
6672     CONTINUE
C--->  BKABAEM....
C======================================================================
C--->
         CALL DEPOST( K, M, G, 0.0, YALL, JALL )
C--->
         RETURN
C======================================================================
C$$$$$$ZAPROS = 20 $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C===> PACTAT TOK BEHTE !!! BOHT O MOKA VALLN1 !!!!
6660     CONTINUE
         KOD = 0
         KD = MSWX(1)
         IF ( KD .EQ. 0 ) GO TO 6661
C--->  BEHT OTKPT, BPACT "AOBE"  O AHHM LOGYTR....
         IF ( K .EQ. 0 ) GO TO 6662
         IF ( LOGYTR(K) .EQ. -1 ) K = 0
6662     CONTINUE
         IF ( M .EQ. 0 ) GO TO 6663
         IF ( LOGYTR(M) .EQ. -1 ) M = 0
6663     CONTINUE
         TK = 0.0
         IF ( K .NE. 0 ) TK = VALLN1(K)
         TM = 0.0
         IF ( M .NE. 0 ) TM = VALLN1(M)
         TOKXN1( 1  ) = TK - TM
         RETURN
6661     CONTINUE
C--->  BEHT AKPT....
         TOKXN1( 1  )  =  0.0
         RETURN
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
600      CONTINUE
C---- Z A P R O S = 3 -----TOKXN, TOKXN1, VALLN, VALLN1 OPEEEH------
C-----------------------------------------!!! VALLN1 MOPOBAHO !!!
C----OPEEM TEK.  PE. COCTOH (?)------------------------------
C
C**** PAEPEMC C "C" **********************************************
       CALL MCIU50( TN, H0, UOPN, UOPN1, UYPN, UYPN1, DTCIU, DTMCIU,
     =              MSWX(3), RMSWX(3) )
C-->  O MCIU ( MSWX(7) )  HXCIU ( RMSWX(8) - OPEEEH
C
C-->  "C"  B  TOKXN1
C
       TOKXX = 0.0
       MMCIU = MSWX(7)
       IF ( MMCIU .EQ. 01  .OR. MMCIU .EQ. 11 ) TOKXX = 1.0
       TOKXN1(2) = TOKXX
C----------------------------------------------------------------------
C===>    HOBOE HAPEHE  TOK
         VK = 0.0
         IF ( K .NE. 0 ) VK = VALLN1(K)
         VM = 0.0
         IF ( M .NE. 0 ) VM = VALLN1(M)
         UT = VK - VM
         TVT  = TOKXN1(  1   )
C--> A PAHE O...
         VK = 0.0
         IF ( K .NE. 0 ) VK = VALLN(K)
         VM = 0.0
         IF ( M .NE. 0 ) VM = VALLN(M)
         UN = VK - VM
         TVN  = TOKXN(  1   )
C----AMEMC COCTOHM----------------------------------------------
C!!!-------------------------------------------------------------------
C      KD = MSWX(1)
C      CALL SEQSOS(NPEL,    TN, KD, TVN,  UN )
C      MSWX(1) = KD
C!!!-------------------------------------------------------------------
         KD = MSWX(1)
         IF ( KD .EQ. 0 ) GO TO 601
C---> BEHT OTKPT (KD=1), HE XOET  OH AKPTC?
C        IF (  UN .GT. 0.0  .AND. TVN  .GE. 0.0
C    =                     .AND.  TVT  .LT. 0.0  ) GO TO 602
CQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C  KOPPEKTPOBKA TVN ********
       IF ( TVN .LT. 0.0  .AND. TVN .LE. -ICLOSE ) TVN = 0.0
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@$$$@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
       IF (
     =                          TVT .LT. -ICLOSE ) GO TO 602
C                                   @@@@@
CQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ
C---> HAE COCTOHE BEHTA HE MEHOC....
         KOD = 0
         RETURN
602      CONTINUE
C--->  BEHT #AKPC#  B TEEH BPEMEH OT TN O TN+H0....
C      KOA TO MOO CTC?   ( HX - PEAHO BOHEHH A )....
C !!!! CPABEBO P TVN = (-ICLOSE) !!!
         HX =    + H0 * (  (-ICLOSE - TVN) /(TVT - TVN)  )
C$$$$$$$$TX = TN + HX
C!!!-------------------------------------------------------------------
         IF ( HX .LE. 0.0 ) WRITE (NWTRE, 604 ) NPEL,   KD, TN, H0, HX,
     =                                           TVN, TVT, ICLOSE
604   FORMAT(' *** EMEHT # ', I8, ' MOE "BEH. #_B9" ==> ???? !?'
     = , ' ***'/' *** KD = ', I2, ' TN = ', E12.5, ' H0 = ', E12.5,
     =  ' HX = ', E12.5, ' ***'/' *** TVN = ', E12.5, ' TVT = ',E12.5,
     =   ' ICLOSE = ', E12.5,  ' ***' )
C!!!-------------------------------------------------------------------
         IF ( HX .LT. HXMIN ) HX = HXMIN
         RMSWX(2) = HX
C--->  EC TX .LT. TX_G  ==> TO B TX_G  <=== TX...
         HXG  =  AMIN1( HX, HXG )
C                ****************
         TXG = TN + HXG
C====>  OTMETT TO B "FKOM"....
         FKOM = 1
C@@@@  A KD  KCPEM @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
       MSWX(9) = -1
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
         KOD = 0
         RETURN
C----------------------------------------------------------------------
601      CONTINUE
         KOD = 0
C===> BEHT AKPT (KD=0), HE EAET  OH OTKPTC?....
         IF ( UT .LE. UOPEN  ) GO TO 6030
CQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ
C--->  TO EAET "C" ???????????????
         MMCIU = MSWX(7)
         IF (                      MMCIU .EQ. 01 ) GO TO 603
C               @@@@@@
C-->  MOET T M ABHO "XOEM" ?
         IF (                      MMCIU .EQ. 11 ) GO TO 603
C                @@@@@@
CQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ
C@@@@@@-->> OT 06.01.87. <<-@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C-->  OPAOTKA KOHA....
       IF (                     MMCIU .EQ. 00 ) GO TO 6030
C-->  MMCIU = 10  -->  C "KOHAET"
       HX = 0.0
       IF ( UN .GT. UOPEN ) GO TO 606
       HX = +H0 * ( (UOPEN - UN) / (UT-UN) )
       HXCIU = RMSWX(8)
       IF ( HX .LE. HXCIU ) GO TO 606
6030   CONTINUE
C@@@@@@--> OT 06.01.87. <<-- KOHE-@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C===>  HET, HE BOEA,  HE A --> COCTOHE HE MEHETC...
         KOD = 0
         RETURN
603      CONTINUE
C===>   BEHT B TEEH TN  <-->  TN+H0 OEH OTKPTC ...
CQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ
C       KOA OBC "C" ???????????
         HXCIU = RMSWX(8)
         HX = HXCIU
         IF ( UN .GT. UOPEN ) GO TO 606
C                @@@@@
C--->  UN    UT  "PAHOO" HAKA...
C   HX  ->  "A" "ECTECTBEHHO" KOMTA
         HX  =    + H0 * (  ( UOPEN -  UN ) /(UT - UN)  )
C-->  KOA EM "C" PAPEO...
         IF ( HXCIU .GT. HX ) HX = HXCIU
606      CONTINUE
C--->
CQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ
C!!!--------**** BHMAHE ****-----------------------------------------
         IF ( MMCIU .NE. 11 .AND. HX .LE. 0.0 ) WRITE (NWTRE, 605 )
     =  NPEL, KD, TN, H0, HX,                    UN, UT, MMCIU
605   FORMAT(' *** EMEHT # ', I8, ' MOE "BEH. #_B9" ==> ???? !?'
     = , ' ***'/' *** KD = ', I2, ' TN = ', E12.5, ' H0 = ', E12.5,
     =  ' HX = ', E12.5,  ' ***'/ ' *** UN = ', E12.5, ' UT = ', E12.5,
     =  ' MCIU = ', I2,  ' ***'  )
C!!!-------------------------------------------------------------------
         IF ( HX  .LT. HXMIN ) HX  = HXMIN
         RMSWX(2) = HX
         HXG =  AMIN1( HX, HXG )
C               ****************
         TXG = TN + HXG
         FKOM = 1
C@@@@  A KD  KCPEM @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
       MSWX(9) = -1
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        KOD = 0
         RETURN
C----------------------------------------------------------------------
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
500      CONTINUE
         KOD = 0
C===> KCA CMEH COCTOH MOE.................ZAPROS = 4
C---->  HET  HEOXOMOCT POBECT CMEH COCTOH BEHT....?
C@@@@  A KD CTAHOBEH ?
       IF ( MSWX(9) .NE. -1 ) RETURN
C@@@ MOHO POBEPT @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C       EC TXG   "PMEPHO" PABHO TX=MOE, TO CMEHA HHA!
         HX   = RMSWX(2)
C        TX - TXG == HX - HXG
         EPST = ABS( HX   - HXG )
         IF ( EPST .GT. EPSKOM ) RETURN
C===> HAE CMEHM COCTOHE....
         KD = MSWX(1)
         KD = KD + 1
         IF ( KD. EQ. 2 ) KD = 0
         MSWX(1) = KD
C---->  EC BEHT AKPC, AKCPEM EO HOMEP.....
         IF ( KD .EQ. 0 ) NTXG = NPEL
C!!!-------------------------------------------------------------------
         IF ( FTEST .GE. 1 ) WRITE(NWTRE,501) NPEL,   KD, TN, TXG
501     FORMAT(' ***FTEST_1: B .#',I8, ' KD CTAO =',I2,
     =          ' TN = ', E12.5, ' TXG = ', E12.5, ' ***')
C!!!-------------------------------------------------------------------
         RETURN
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
         END
