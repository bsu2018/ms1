       SUBROUTINE FM0031( BA0T, KNOTT, PAR0T, RMSW, LM )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT  MAPTA  1988 .)------------
C   OPOPAMMA  FM0031( BA0T, KNOTT, PAR0T, RMSW, LM )
C   ------------
C   HAHAEHE:  1) HACTPOKA MAKPOMOEE BATEE OCTOHHOO TOKA
C   ----------        P  =CONST.( T # 520 )
C                     P  =CONST,C TAXOEHEPATOPOM.( T # 521 )
C
C----------------------------------------------------------------------
C                  EMEHT OCBAETC:
C
C            ?? T 520   K1  K2
C                        R  L  K  J
C                      MAS < NT T1 Y1 ....   > ;
C
C           E   R   -AKTBHOE COPOTBEHE OMOTK KOP(OM);
C                 L   -HKTBHOE COPOTBEHE OMOTK KOP(H);
C                 K  -KOHCTPKTBHA OCTOHHA BATE (B*C);
C                 J   -MOMEHT(B K*M)HEP BPA. ACT (K*M**2);    ,
C              T1 Y1..-TAHO AAHHA ABCMOCT MBH(T) ;          ,
C
C           *----------------------------------------------------------
C
C            ?? T 521   K1  K2
C                        R  L  K  J  KT  RT
C                      MAS < NT T1 Y1 ....   > ;
C
C           E   R   -AKTBHOE COPOTBEHE OMOTK KOP(OM);
C                 L   -HKTBHOE COPOTBEHE OMOTK KOP(H);
C                 K  -KOHCTPKTBHA OCTOHHA BATE (B*C);
C                 J   -MOMEHT(B K*M)HEP BPA. ACT (K*M**2);
C                 KT -KOEHT EPEA TAXOEHEPATOPA (B/C**-1)
C                 RT -BHTPEHHEE COPOTBEHE OMOTK TAXOEHEPATOPA;
C              T1 Y1..-TAHO AAHHA ABCMOCT MBH(T) ;
C
C
C----------------------------------------------------------------------
C            2) P  FGMSW = 1 -> TOHETC HAEHE LM -
C               OE H MSW AHHOO TA ( C ETOM MAS AP-OB );
C
C   METO:      OPMPOBAHE EPEMEHHO ACT MSW_ALL OCAH -TA,
C   -----       BCEHE BCOMOATEHX AHHX, HEOXOMX 
C               AHEE PAOT MAKPOMOE;
C
C   APAMETP:  BA0T, KNOT, PAR0T - "OTPEK" MACCBOB BA0, KNOT, PAR0
C   ---------   BBEEHHX EPE / INPUT0;
C               RMSW - EPEMEHHA ACT MSW_ALL OCAH EMEHTA;
C               LM - P FGMSW = 0 => HA EPEMEHHO ACT MSW_ALL;
C                    P FGMSW = 1 => HA BCEO MACCBA    MSW_ALL;
C   PMEAHE: 1. BCE O  AHTC
C   ----------
C
C              OPMAT RMSW T # 520:
C              ----------------------
C+-----------I--------------I------I-----------------------------------
C  # COBA   I    # COBA B I KTO  I
C OT HAAA  I    OTPEKE   IOPE.I
C BCEO MSW  I    RMSW B    I      I       OOHAEHE - HAEHE
C OCAH   I    FM0031    I      I
C------------I--------------I------I-----------------------------------
C     9      I    -1        I      I HOMEP A HAAA
C    10      I     0        I      I HOMEP A KOHA
C----------------------------------------------------------------------
C    11      I     1        I  FM  I  R  - COPOTBEHE KOP;
C    12      I     2        I  FM  I  L  - HKTBHOCT KOP;
C    13      I     3        I  FM  I  K - KOHCTPKTBH KOEHT;
C    14      I     4        I  FM  I  JM - MOMEHT HEP;
C    15      I     5        I  FM  I        PEEPB
C    16      I     6        I  FM  I  T - OCTOHHA KOPHO E;
C    17      I     7        I  FM  I  TM - OCTOHHA MEXAHECKA;
C    18      I     8        I  DM  I  MBH- HAEHE MBH  T=TN;
C    19      I     9        I  DM  I  MBH1-HAEHE MBH  T=TN1;
C    20      I    10        I  DM  I  G -  HAEHE POBOMOCT;
C    21      I    11        I  DM  I  J -  HAEHE CT. TOKA;
C    22      I    12        I  FM  I         PEEPB
C    23      I    13        I  FM  I         PEEPB
C    24      I    14        I  FM  I  NT - KOECTBO TOEK MBH(T);
C    25      I    15        I  FM  I  T1 - BPEM;                      ;
C    26      I    16        I  FM  I  MBH1-MOMEHT;
C ......     I ........     I  ..  I  .........................
C----------------------------------------------------------------------
C
C  OA HA MSW --> LM<BC> = 24 + 2*NT
C
C  HA EPEMEH. ACT --> LM<RMSW> = 14 + 2*NT
C
C----------------------------------------------------------------------
C
C
C
C              OPMAT RMSW T # 521:
C              ----------------------
C+-----------I--------------I------I-----------------------------------
C  # COBA   I    # COBA B I KTO  I
C OT HAAA  I    OTPEKE   IOPE.I
C BCEO MSW  I    RMSW B    I      I       OOHAEHE - HAEHE
C OCAH   I    FM0031    I      I
C------------I--------------I------I-----------------------------------
C     9      I    -3        I      I HOMEP A HAAA OMOTK KOP
C    10      I    -2        I      I HOMEP A KOHA  OMOTK KOP
C    11      I    -1        I      I HOMEP A HAAA OMOTK T.
C    12      I     0        I      I HOMEP A KOHA  OMOTK T.
C----------------------------------------------------------------------
C    13      I     1        I  FM  I  R  - COPOTBEHE KOP;
C    14      I     2        I  FM  I  L  - HKTBHOCT KOP;
C    15      I     3        I  FM  I  K - KOHCTPKTBH KOEHT;
C    16      I     4        I  FM  I  JM - MOMEHT HEP;
C    17      I     5        I  FM  I  KTG- KOEHT EPEA T.
C    18      I     6        I  FM  I  GTG- POBOMOCT OMOTK T.
C    19      I     7        I  FM  I  T - OCTOHHA KOPHO E;
C    20      I     8        I  FM  I  TM - OCTOHHA MEXAHECKA;
C    21      I     9        I  DM  I  MBH- HAEHE MBH  T=TN;
C    22      I    10        I  DM  I  MBH1-HAEHE MBH  T=TN1;
C    23      I    11        I  DM  I  GR-  POBOMOCT E KOP;
C    24      I    12        I  DM  I  JR-  CT. TOKA    E KOP;
C    25      I    13        I  DM  I  GRG- POBOMOCT E KOP - T
C    26      I    14        I  DM  I  JRG- CT. TOKA    E KOP - T
C    27      I    15        I  FM  I  NT - KOECTBO TOEK MBH(T);
C    28      I    16        I  FM  I  T1 - BPEM;                      ;
C    29      I    17        I  FM  I  MBH1-MOMEHT;
C ......     I ........     I  ..  I  .........................
C----------------------------------------------------------------------
C
C  OA HA MSW --> LM<BC> = 27 + 2*NT
C
C  HA EPEMEH. ACT --> LM<RMSW> = 15 + 2*NT
C
CZZZ-------------------------------------------------------------------
       COMMON/PROF1/ MASPRT(200)
       DIMENSION BA0T(*), KNOTT(*), PAR0T(*), RMSW(*)
       INTEGER BA0T, FGMSW, TIP
       EQUIVALENCE ( FGMSW,  MASPRT(87) )
       EQUIVALENCE ( N    ,  RN         )
       REAL  JM, L, KF, KTG
C--->TO A EMEHT?
       NEL = BA0T(1)
       TIP = BA0T(2)
       NTIP = TIP - 519
       GO TO (99999,99999),NTIP
         NWTRE = MASPRT(13)
         WRITE(NWTRE, 500) TIP, NEL
500      FORMAT(' *** O. CO B FM0031: HOMEP TA HE OCBAETC **
     =*'/' *** HOMEP TA ', I10, ' EMEHT HOMEP: ', I10, '***')
C!!!-------------------------------------------------------------------
         CALL SUBERR(1)
99999  CONTINUE
C--->  HAEM H MSW
       INT = 6
       IF( NTIP .EQ. 2 ) INT = 8
       NT = IFIX( PAR0T( INT ) )
       NT1= ( IFIX( PAR0T( INT-1 ) ) - 1 ) / 2
       IF ( NT .EQ. NT1  ) GO TO 750
         NWTRE = MASPRT(13)
         WRITE(NWTRE, 700) TIP, NEL
700      FORMAT(' *** OKA P AAH KO-BA EMEHTOB MACCBA ***'/
     =   ' *** HOMEP TA ', I10, ' EMEHT HOMEP: ', I10, '***')
C!!!-------------------------------------------------------------------
         CALL SUBERR(1)
         RETURN
750    CONTINUE
C-->  TO POCT?
       IF ( FGMSW .EQ. 0 ) GO TO 1000
C-->  TOHT MSW_ALL PAMEP
       LM = 24 + 2 * NT
       IF( NTIP .EQ. 2 ) LM = 27 + 2 * NT
       RETURN
C######################################################################
1000   CONTINUE
       IF( NTIP .EQ. 2 ) GO TO 3000
C######################################################################
C
C   BATE OCTOHHOO TOKA ( T # 520 )
C
C######################################################################
C-->  OPMPOBAT RMSW....
C-->  LM - HA "EPEMEHHO" ACT RMSW...
       LM = 14 + 2 * NT
C********************************************************************
C-> CTKA
       DO 1001 I=1,LM
       RMSW(I) = 0.0
1001   CONTINUE
C--------------------------------------------------------------------
C-->  PEM OCTOHHX APAMETPOB...
C--------------------------------------------------------------------
          R   = PAR0T(1)
          L   = PAR0T(2)
          KF  = PAR0T(3)
          JM  = PAR0T(4)
C----------------------------------------------------------------------
C--->  AOHEHE RMSW OCTOHHM APAMETPAM.
C----------------------------------------------------------------------
       RMSW (1) = R
       RMSW (2) = L
       RMSW (3) = KF
       RMSW (4) = JM
       RMSW (6) = L / R
       RMSW (7) = JM * R / KF**2
C----------------------------------------------------------------------
C--->  AOHEHE RMSW MACCBOM.
C      HK MBH(T).
C----------------------------------------------------------------------
C      IPAR0 - CETK MACCBA PAR0T.
C--------------------------------------------------------------------
C
       RMSW ( 14 ) = 2 * FLOAT(NT)
       I1 = 15
       I2 = 14 + 2 * NT
       IPAR0 = 6
          DO 1100 I = I1, I2
          IPAR0 = IPAR0 + 1
          RMSW (I) = PAR0T (IPAR0)
1100      CONTINUE
       RETURN
C######################################################################
C
C   BATE OCTOHHOO TOKA C TAXOEHEPATOPOM HA BA ( T # 521 )
C
C######################################################################
3000   CONTINUE
C-->  OPMPOBAT RMSW....
C-->  LM - HA "EPEMEHHO" ACT RMSW...
       LM = 15 + 2 * NT
C********************************************************************
C-> CTKA
       DO 3001 I=1,LM
       RMSW(I) = 0.0
3001   CONTINUE
C--------------------------------------------------------------------
C-->  PEM OCTOHHX APAMETPOB...
C--------------------------------------------------------------------
          R   = PAR0T(1)
          L   = PAR0T(2)
          KF  = PAR0T(3)
          JM  = PAR0T(4)
          KTG = PAR0T(5)
          RTG = PAR0T(6)
          IF( RTG .LT. 1.E-32 ) RTG = 1.E-32
C----------------------------------------------------------------------
C--->  AOHEHE RMSW OCTOHHM APAMETPAM.
C----------------------------------------------------------------------
       RMSW (1) = R
       RMSW (2) = L
       RMSW (3) = KF
       RMSW (4) = JM
       RMSW (5) = KTG
       RMSW (6) = 1./RTG
       RMSW (7) = L / R
       RMSW (8) = JM * R / KF**2
C----------------------------------------------------------------------
C--->  AOHEHE RMSW MACCBOM.
C      HK MBH(T).
C----------------------------------------------------------------------
C      IPAR0 - CETK MACCBA PAR0T.
C--------------------------------------------------------------------
C
       RMSW ( 15 ) = 2 * FLOAT(NT)
       I1 = 16
       I2 = 15 + 2 * NT
       IPAR0 = 8
          DO 3100 I = I1, I2
          IPAR0 = IPAR0 + 1
          RMSW (I) = PAR0T (IPAR0)
3100      CONTINUE
       RETURN
C----------------------------------------------------------------------
       END
