       SUBROUTINE LM0003( MSW, RMSW, ADR, MSWALL, RMSWAL, KOD )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C   OPOPAMMA: LM0003( MSW, RMSW, ADR, MSWALL, RMSWAL, KOD )
C   -------------
C   HAHAEHE:   OECKA HACTPOKA MSW MAKPOMOE TA # 64
C   ----------     ***  ..C. PETOPA BOEH 3X3X0 ******
C                  * * * * * * * * * * * * * * * * * * * * * * * *
C                  T     M MOE     OOHAEH B AHEEM
C
C                  64      3-X AHA ..C        E_PE
C                          PEPEMA OT "PB"
C
C
C              EMEHT KOPETC:
C              -------------------
C
C               # T 64  K0 KA KB KC  T_BK  R_BHT #_-TA  K_C;
C
C     K0 - O E, KA - AA A, KB - AA B, KC - AA C;
C
C---> BBOHE HAEH: TOK: K AM KA, KB, KC, OT A K0,
C                              *                   **
C                      HAEH ..C. E1, E2, E3;
C
C
C         TOKN EMEHTA #_-TA BPAETC 3- EPBX
C           HAEH, MHOATC HA K_C.  PHMATC
C           A HAEHE ..C. 3-X AHO CCTEM HAPEH;
C
C  ===  OCKAETC -->  MOE T # 40, # 13, # 63
C
C !!!!   AEPKA HA OH A HTEPPOBAH !!!
C        -----------------------------------
C
C  P TN , T_BK --> TBATC TOKO OH COPOTBEH R_BHT;
C
C
C   METO:        OCK B MSW_ALL OCAH EMEHTA *. MA.*
C   -----         ( O. T COACHO BCTPOEHHO TA. "LTIP" )
C                 B CAE HAXOEH -> OOPMPOBAHE MSW_OCAH;
C                 B TOM CAE KOD = 0, HAE = 1;
C   APAAMETP:   MSW(RMSW) - "OTPEOK" MSW_MOE T # 40;
C   ----------    ADR - APEC B MSW_ALL MSW_OCAH TO MOE;
C                 MSWALL(RMSWAL) - BEC CCOK MSW COB;
C                 KOD - = 0 - COPMPOBA MSW,
C                       = 1 - O. OK;
C                      ( HA NWTR COOEHE BBOTC );
C   OPOPAMM: 1. PROF1, PROF2
C   ------------  2. SEQMS0
C
C   PMEAHE:  OPMAT MSW_OCAH ---->
C   ----------
C
C
C                  RMSW TA # 64 [ CTOHK HAPEH OT "PE.BO" ]
C                  -----------------------------------------
C
C                    TOK(J) = K_C. * E(J) / R_BHT. + 1/R * U_N+1
C
C                             SPM                 SRAB
C             ++--------+------+--------+------++------+---+---+-----+
C             II HA.  I HA.I # -TAI AP. II      IJESIJESI K   I
C   :     II  1/R   I T_BKI "PB"   I  B   II JESA I   I   I CI
C  K0         II        I      I        I TOKN II      I B I C I EHI
C    K1       ++--------+------+--------+------++------+---+---+-----+
C      K2     II   1    I  2   I   3    I  4   II  5   I 6 I 7 I  8  I
C         K3  ++--------+------+--------+------++------+---+---+-----+
C  9 10 11 12 II  13    I  14  I  15    I  16  II  17  I18 I19 I 20  I
C             ++--------+------+--------+------++------+---+---+-----+
C
C
CZZZ-------------------------------------------------------------------
       COMMON /PROF1/ MASPRT(200)
       COMMON /PROF2/ MACTAB(800)
       DIMENSION MSW(*), RMSW(*), MSWALL(*), RMSWAL(*)
       INTEGER TIP, ADR, PTIP, AMOT, APOT, ATOKM, TIPX
       DIMENSION LTAB(10)
       DATA LTAB/ 40, 13, 63, 7*0/
       DATA K10 / 10 /
C----------------------------------------------------------------------
       KOD = 0
C-->  HOMEP -TA "PE. BOEH"
       NELMOT = MSW(15)
C-->
       NEL = MSW(1)
       TIP = MSW(2)
C-->
C-->  CKAT B MSWALL EMEHT C #-TA = NELMOT:
       CALL SEQMS0(MSWALL, NELMOT, AMOT, IRC, KVIV, ATOKM )
C-->
       IF   ( IRC .EQ. 1 ) GO TO 1
C-->  EMEHTA HET...
       KOD = 1
       NWTR = MASPRT(13)
       WRITE(NWTR, 100) NEL, TIP, NELMOT
100    FORMAT(//' *** APOC HA O. CB EMEHTA # ', I5,
     =  ' ( T # ', I3, ' ) ***'/
     =  ' *** C HE CECTBM B E EMEHTOM # ', I5,' ***'/
     =  ' *** OPAOTKA E PEKPAAETC *** '//)
       RETURN
C----------------------------------------------------------------------
1      CONTINUE
C-->  MSW - HA, TO A T TAM BET ?
       TIPX = MSWALL(AMOT + 1 )
       DO 2 I = 1, K10
       IF ( TIPX .EQ. LTAB(I) ) GO TO 3
2      CONTINUE
C-->  CB C HE HAM TOM.....
       KOD = 1
       NWTR = MASPRT(13)
       WRITE(NWTR,101) NEL, TIP, NELMOT, TIPX
101    FORMAT(//' *** APOC HA O. CB EMEHTA # ', I5,
     = ' ( T # ', I3, ' ) ***'//
     = ' *** C EMEHTOM # ', I5, ' ( T # ', I3, ' ) - OOEH',
     = '  HE PEAOBAH ***'/
     = ' *** OPAOTKA E PEKPAAETC ***'//)
       RETURN
3      CONTINUE
C-->  HAAO OCAH B MSW --->
C              = AMOT
C-->  HAAO CCKA OB  #_TA
C              = AMOT+8
C-->  APEC B TOKN/TOKN1  EPEMEHHX COCTOH PETOPA
       MSW(16) = ATOKM
       KOD = 0
       RETURN
       END
