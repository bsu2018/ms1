         SUBROUTINE SEQDIR(KD, KAR, DAT, IRC )
CXXX----KOMПЛEKC "MS1" --> BEPCИЯ 2.0
C   ПOДПPOГPAMMA:   SEQDIR(KD, KAR, DAT, IRC )
C   -------------
C   HAЗHAЧEHИE:    MOHИTOP BЫДEЛEHИЯ И AHAЛИЗA ДИPEKTИB
C   ----------     ************************************
C
C
C   METOД:         CИHT. PAЗБOP, CPABHEHИE C ШAБЛOHOM;
C   -----           $$$ OT 2.08.89 ===> ПEPEBOД ИMEHИ ДИP. B CTP. БУKBЫ.
C
C   ПAPAMETPЫ:     KD - KOД BЫДEЛEHHOЙ ДИPEKTИBЫ:
C   ---------
C
C----------------------------------------------------------------------
C    KD     ИMЯ         П/П OБPAБOTKИ  ДЛИHA  <ECT8 ЛИ ЧИCЛOBЫE ДAHHЫE>
C----------------------------------------------------------------------
C    0       %           SEQDIR          1          HET
C    1      #ИMЯ         SEQDIR          4          HET
C    2      #ПPИM        SEQDIR          5          HET
C    3      #PEЖИM       DRREG0          6          HET
C    4      #ЦEПЬ        DRCIRC          5          ECT8
C    5      #METOД       DRMET0          6          HET
C    6      #ПEЧ         DRPRNT          4          ECT8
C    7      #TAB         DRTAB0          4          ECT8
C    8      #ГPAФ        DRGRF0          5          ECT8
C    9      #ГPAФ1       DRGRF1          6          ECT8
C   10      #CЧET        DRDIG0          5          ECT8
C   11      #CTOП        MAIN_PGM        5          HET
C   12      #COXP        DRSAV0          5          ECT8
C   13      #BOCT        DRRES0          5          ECT8
C   14      #ДИAЛ        SEQDIR          5          HET
C   15      #CПPAB       DRDAT0          6          HET
C   16      HELP         DRHELP          4          HET
C   17      #XЦEПЬ       DRCIRX          6          ECT8
C   18      #ПCЧET       DRDIGP          6          ECT8
C   19      #ACOXP       DRSAVA          6          ECT8
C   20      #CПEKTP      DRFURE          7          ECT8
C   21      #MOЩHOCTЬ    DRPPPP          9          ECT8
C   22      #MPEЖИM      DRRMMM          7          HET
C   23      #ВНЕШ        DROUT0          5          ЕСТЬ
C   24      #SPOOL       DRSPOL          6          НЕТ
C   25      #РЕЖЗАП      DRREGS          7          ЕСТЬ
C   26      #РЕЖВОСТ     DRREGL          8          ЕСТЬ
C----------------------------------------------------------------------
C
C                  KAR - MACCИB ДИPEKTИBЫ;
C                  DAT - MACCИB ДAHHЫX  ДИPEKTИBЫ;
C
C                  IRC = 1 -  OЧEPEДHУЮ ДИPEKTИBУ ПPИHЯЛИ;
C                      = 2 -  KOHEЦ ДAHHЫX HA CИCTEMHOM NRDR;
C
C   ПOДПPOГPAMMЫ:  1. COMMON PROF1, SERVZ4,  SERVZ5
C   -------------  2. GETDAT, SEQ1, MOVE1;
C                  3. APFCAS - ПEPEBOД B БOЛ8ШИE БУKBЫ....
C                              ИMEH ДИPEKTИB...
C   ПPИMEЧAHИE:    1.  <# >  И  <#BCE>  -  CИHOHИMЫ;
C   ----------     2.  <%>  ДO KOHЦA CTPOKИ  -  KOMEHTAPИИ;
C  OT 4.04.89 --> "+"  ПEPBAЯ ДИPEKTИBA KOHTPOЛИPУETCЯ HA #ДИAЛ....
C  ОТ 13.06.90 --> SEQ1 эаменена на SEQ1M ---  печать имени директивы
C
CZZZ-------------------------------------------------------------------
CZZZ-------------------------------------------------------------------
         COMMON/PROF1/ MASPRT(200)
         COMMON/SERVZ4/ NAMECR(80)
         COMMON/SERVZ5/ KCOM, COMENT(100)
         DIMENSION KOMENT(100)
         EQUIVALENCE( COMENT, KOMENT )
         DIMENSION KAR(*), DAT(*)
         DIMENSION YES(2), NO(3)
         INTEGER YES, NO, DIEZ, BCE, ABCE
         DIMENSION D1(4), D2(5), D3(6), D4(5), D5(6), D6(4),
     = D20(7),     D7(4), D8(5), D9(6), D10(5), D11(5), D12(5),
     = D21(9),     D13(5), D14(5), D15(6), D16(4), D17(6),D18(6),D19(6)
         INTEGER D1, D2, D3, D4, D5, D6, D7, D8, D9, D10,
     = D20, D21, D11, D12, D13, D14, D15, D16, D17, D18, D19
         DIMENSION D22(7),d23(5),D24(6),D25(7),D26(8)
         INTEGER D22,d23, D24 ,D25,D26
         EQUIVALENCE( MASPRT(12), NRDR)
         EQUIVALENCE( MASPRT(13), NWTR)
         EQUIVALENCE( MASPRT(14), NWTRE)
         EQUIVALENCE( MASPRT(15), DIAL)
         EQUIVALENCE( MASPRT(127), NZRDR)
         INTEGER DIAL, BLANK, FDIAL
C++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         DATA YES/'Д','A'/, NO/'H', 'E', 'T' /
         DATA DIEZ/'#'/, BCE/'#BCE'/, ABCE/'#   '/
         DATA ICOM/'%'/, ICOM1/'%   '/ , K72/72/, K21/21/
C++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C----------------------------------------------------------------------
         DATA D1/ '#', 'И', 'M', 'Я'            /
         DATA D2/ '#', 'П', 'P', 'И', 'M'       /
         DATA D3/ '#', 'P', 'E', 'Ж', 'И', 'M'  /
         DATA D4/ '#', 'Ц', 'E', 'П', 'Ь'       /
         DATA D5/ '#', 'M', 'E', 'T', 'O', 'Д'  /
         DATA D6/ '#', 'П', 'E', 'Ч'            /
         DATA D7/ '#', 'T', 'A', 'Б'            /
         DATA D8/ '#', 'Г', 'P', 'A', 'Ф'       /
         DATA D9/ '#', 'Г', 'P', 'A', 'Ф', '1'  /
         DATA D10/ '#', 'C', 'Ч', 'E', 'T'      /
         DATA D11/ '#', 'C', 'T', 'O', 'П'      /
         DATA D12/ '#', 'C', 'O', 'X', 'Р'      /
         DATA D13/ '#', 'B', 'O', 'C', 'T'      /
         DATA D14/ '#', 'Д', 'И', 'A', 'Л'      /
         DATA D15/ '#', 'C', 'П', 'P', 'A', 'B' /
         DATA D16/ 'H', 'E', 'L', 'P'           /
         DATA D17/ '#', 'X', 'Ц', 'E', 'П', 'Ь' /
         DATA D18/ '#', 'П', 'C', 'Ч', 'E', 'T' /
         DATA D19/ '#', 'A', 'C', 'O', 'X', 'P' /
         DATA D20/ '#', 'C', 'П', 'E', 'K', 'T', 'P' /
         DATA D21/ '#', 'M', 'O', 'Щ', 'H', 'O', 'C', 'T', 'Ь' /
         DATA D22/ '#', 'M', 'P', 'E', 'Ж', 'И', 'M' /
         DATA D23/ '#', 'B', 'H', 'E', 'Ш'           /
         DATA D24/ '#', 'S', 'P', 'O', 'O', 'L'      /
         DATA D25/ '#', 'P', 'E', 'Ж', 'З', 'A', 'П' /
         DATA D26/ '#', 'P',  'E', 'Ж', 'B', 'O', 'C', 'T'     /
C----------------------------------------------------------------------
         DATA BLANK /' '/,FDIAL/0/
C######################################################################
         IRC = 1
666      CONTINUE
         DO 667 I = 1, K21
667      DAT(I) = 0.0
         READ(NRDR, 100, END = 9999 ) (KAR(I), I=1,80 )
         NZRDR = NZRDR + 1
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C --->   ПEPEBOД ИЗ MAЛEHьKИX БУKB B БOЛьШИE ......
         CALL APFCAS(1,80,KAR,KAR)
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
100      FORMAT(80A1)
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         CALL SEQ1M(KAR, D14, 5, I)
         GO TO (14),I
C+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         IF ( DIAL .EQ. 0 ) WRITE(NWTR,101) (KAR(I), I=1,80)
         IF ( DIAL .EQ. 1 ) WRITE(NWTR,1010) (KAR(I), I=1,80)
101      FORMAT(/20X, 80A1)
1010     FORMAT(/ 80A1)
         IK = 1
C--> CИTO ДЛЯ ДИPEKTИB.....
         IF ( KAR(1) .EQ. ICOM ) GO TO 666
C  ->  ЧTO    C  ЧEM   CKOЛЬKO  1-ДA, 2=HET:::::::
         CALL SEQ1M(KAR, D1, 4, I)
         GO TO (1),I
         CALL SEQ1M(KAR, D2, 5, I)
         GO TO (2),I
         CALL SEQ1M(KAR, D3, 6, I)
         GO TO (3),I
         CALL SEQ1M(KAR, D4, 5, I)
         GO TO (4),I
         CALL SEQ1M(KAR, D5, 6, I)
         GO TO (5),I
         CALL SEQ1M(KAR, D6, 4, I)
         GO TO (6),I
         CALL SEQ1M(KAR, D7, 4, I)
         GO TO (7),I
         CALL SEQ1M(KAR, D9, 6, I)
         GO TO (9),I
         CALL SEQ1M(KAR, D8, 5, I)
         GO TO (8),I
         CALL SEQ1M(KAR, D10, 5, I)
         GO TO (10),I
         CALL SEQ1M(KAR, D11, 5, I)
         GO TO (11),I
         CALL SEQ1M(KAR, D12, 5, I)
         GO TO (12),I
         CALL SEQ1M(KAR, D13, 5, I)
         GO TO (13),I
C+       CALL SEQ1M(KAR, D14, 5, I)
C+       GO TO (14),I
         CALL SEQ1M(KAR, D15, 6, I)
         GO TO (15),I
         CALL SEQ1M(KAR, D16, 4, I)
         GO TO (16),I
         CALL SEQ1M( KAR, D17, 6, I )
         GO TO (17),I
         CALL SEQ1M(KAR, D18, 6, I)
         GO TO (18),I
         CALL SEQ1M( KAR, D19, 6, I )
         GO TO (19),I
         CALL SEQ1M( KAR, D20, 7, I )
         GO TO (20),I
         CALL SEQ1M( KAR, D21, 9, I )
         GO TO (21),I
         CALL SEQ1M( KAR, D22, 7, I )
         GO TO (22),I
         CALL SEQ1M( KAR, D23, 5, I )
         GO TO (23),I
         CALL SEQ1M( KAR, D24, 6, I )
         GO TO (24),I
         CALL SEQ1M( KAR, D25, 7, I )
         GO TO (25),I
         CALL SEQ1M( KAR, D26, 8, I )
         GO TO (26),I
C--->  MOЖHO ЗДECЬ AKTИBИЗИPOBAT8 CИHOHИMЫ:::::::
C######################################################################
         WRITE(NWTR, 102)
 102     FORMAT(/' *** Директива не опознана - возможно: нет -->',
     =    ' "#BCE" или ";" ***' )
         WRITE(NWTR, 1022) (KAR(iiiii),iiiii=1,80)
 1022    FORMAT('*** Bведенная строка:'/80A1/)
         GO TO 666
C######################################################################
1        CONTINUE
C---> #ИMЯ
         KD = 1
         CALL MOVE1( NAMECR, KAR, 80 )
         GO TO 666
2        CONTINUE
C---> #ПPИM
         KD = 2
         KCOM = 0
2002     CONTINUE
         KCOM = KCOM + 1
         IF ( KCOM .GT. 6 ) GO TO 2003
         I1 = (KCOM-1)*20 + 1
2000     CONTINUE
         READ(NRDR, 203, END = 9999) (KAR(I), I=1, 20 )
         NZRDR = NZRDR + 1
         IF ( DIAL .EQ. 0 ) WRITE(NWTR, 201 ) ( KAR(I), I=1, 20 )
         IF ( DIAL .EQ. 1 ) WRITE(NWTR, 2010 ) ( KAR(I), I=1, 20 )
203      FORMAT(20A4)
201      FORMAT(20X, 20A4)
2010     FORMAT(     20A4)
         IF ( KAR(1) .EQ. ICOM ) GO TO 2000
         IF ( KAR(1) .EQ. ICOM1 ) GO TO 2000
         KCOM = KCOM - 1
         IF ( KAR(1) .EQ. BCE ) GO TO 666
         IF ( KAR(1) .EQ. ABCE ) GO TO 666
         KCOM = KCOM + 1
         CALL MOVE1( KOMENT(I1), KAR, 20 )
         GO TO 2002
2003     CONTINUE
         WRITE(NWTR, 104)
104     FORMAT(/' *** Уже приняли 6-ю строку #ПPИM, а где "# " или "#BCE
     ="? ***'/ ' *** Bозможно - часть информации "ушла" в #ПPИM ***'/
     =      ' *** Будте внимательны ***'/)
         GO TO 666
C######################################################################
14       CONTINUE
C   #ДИAЛ
         KD = 14
         DIAL = 0
C-- ГДE ПOБEЛЫ
         DO 14000 I = 1, K72
         IK = I
         IF ( KAR(I) .EQ. BLANK )  GO TO 14001
14000    CONTINUE
         WRITE(NWTR,14005) DIAL
14005    FORMAT(/5X,'*** #ДИAЛ  установлен: "HET" (DIAL=',I1,') ***')
         GO TO 666
14001    CONTINUE
C--> УБEPEM ПPOБEЛЫ
       I1= IK
       DO 14002 I=I1, K72
       IK = I
       IF( KAR(I) .NE. BLANK ) GO TO 14003
14002  CONTINUE
         WRITE(NWTR,14005)   DIAL
       GO TO 666
14003  CONTINUE
         IF (KAR(IK) .EQ. YES(1) .AND. KAR(IK+1) .EQ. YES(2) )
     =     DIAL = 1
         IF ( DIAL .EQ. 1 ) WRITE(NWTR,14006) DIAL
         IF ( DIAL .EQ. 0 ) WRITE(NWTR,14005) DIAL
14006    FORMAT(/5X,'*** #ДИAЛ  установлен: "ДA" (DIAL=',I1,') ***')
         GO TO 666
C######################################################################
3        CONTINUE
C   #PEЖИM
         KD = 3
         CALL GETDAD(KAR, DAT, III)
         RETURN
C######################################################################
4        CONTINUE
C   #ЦEПЬ
         KD = 4
         CALL GETDAD(KAR, DAT, III)
         RETURN
C######################################################################
5        CONTINUE
C   #METOД
         KD = 5
         RETURN
C######################################################################
6        CONTINUE
C  #ПEЧ
         KD = 6
         CALL GETDAD(KAR, DAT, III)
         RETURN
C######################################################################
7        CONTINUE
C  #TAБ
         KD = 7
         CALL GETDAD(KAR, DAT, III)
         RETURN
C######################################################################
8        CONTINUE
C   #ГPAФ
         KD = 8
         CALL GETDAD(KAR, DAT, III)
         RETURN
C######################################################################
9        CONTINUE
C  #ГPAФ1
         KD = 9
         CALL GETDAD(KAR, DAT, III)
         RETURN
C######################################################################
10       CONTINUE
C  #CЧET
         KD = 10
         CALL GETDAD(KAR, DAT, III)
         RETURN
C######################################################################
11       CONTINUE
C  #CTOП
         KD = 11
         RETURN
C######################################################################
12       CONTINUE
C   #COXP
         KD = 12
         CALL GETDAD(KAR, DAT, III)
         RETURN
C######################################################################
13       CONTINUE
C  #BOCT
         KD = 13
         CALL GETDAD(KAR, DAT, III)
         RETURN
C######################################################################
15       CONTINUE
C  #CПPAB
         KD = 15
         RETURN
C######################################################################
16       CONTINUE
C  #HELP
         KD = 16
         RETURN
C######################################################################
17     CONTINUE
C   #XЦEПЬ  <ИMЯ>   -->  ФAЙЛ XDATA....
       KD = 17
       CALL GETDAD( KAR, DAT, III )
       RETURN
C######################################################################
18       CONTINUE
C  #ПCЧET
         KD = 18
       CALL GETDAD( KAR, DAT, III )
         RETURN
C######################################################################
19     CONTINUE
C   #ACOXP
       KD = 19
       CALL GETDAD( KAR, DAT, III )
       RETURN
C######################################################################
20       CONTINUE
C  #CПEKTP
         KD = 20
       CALL GETDAD( KAR, DAT, III )
         RETURN
C######################################################################
21     CONTINUE
C   #MOЩHOCTЬ
       KD = 21
       CALL GETDAD( KAR, DAT, III )
       RETURN
C######################################################################
22     CONTINUE
C   #MPEЖИM
       KD = 22
       CALL GETDAD( KAR, DAT, III )
       RETURN
C######################################################################
C######################################################################
23       CONTINUE
C  #BHEШ
         KD = 23
         CALL GETDAD(KAR, DAT, III)
         RETURN
C######################################################################
24       CONTINUE
C  #SPOOL
         KD = 24
C*****   CALL GETDAD(KAR, DAT, III)
         RETURN
C######################################################################
C######################################################################
25       CONTINUE
C  #ЗАПРЕЖ
         KD = 25
         CALL GETDAD(KAR, DAT, III)
         RETURN
C######################################################################
C######################################################################
26       CONTINUE
C  #ВОСТРЕЖ
         KD = 26
         CALL GETDAD(KAR, DAT, III)
         RETURN
C######################################################################
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
9999     CONTINUE
C  - NRDR CKOHЧAЛCЯ
         WRITE(NWTR, 105 ) NRDR
105   FORMAT(///' *** KOHEЦ ИHФOPMAЦИИ HA KAHAЛE CИCTEMHOГO BBOДA ', I2,
     =  ' ***'/ ' *** PAБOTA ПPEPЫBAETCЯ  [#SEQ_DIR#]  ***'//)
         IRC = 2
         RETURN
         END
