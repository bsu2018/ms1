       SUBROUTINE PSUB9( NEL, URMAS, STMAS, DGMAS, INTMAS )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT HBAP  1988 .)------------
C   OPOPAMMA: PSUB9( NEL, URMAS, STMAS, DGMAS, INTMAS )
C   -------------
C   HAHAEHE:  / OOBATE  MOEPOBAH
C   ----------   AKOHOB PABEH OTEHM BEHTEM 
C                PO BEHTE.
C                  ( MOE #301 - C ).
C               O BEHAM, EPEABAEMM OOBATEEM 
C               HAEHM TOKOB  HAPEH EMEHTOB CXEM
C               OPEETC KO C KAOO BEHT  A O
C               MOMEHTA MEHEH HAEH C.
C
C######################################################################
C
C         OPOPAMMA OPMPET CHA PABEH TPCTOPAM
C     TPEXAHO-OHOAHOO PEOPAOBATE ACTOT C HEOCPECTBEH-
C     HO CB  ECTECTBEHHO KOMMTAE P PAEHOM PABE-
C     H PAOTO AHOHO  KOTOHO PAM.
C         BXOHM BEHAM BTC CHA PABEH ( UYPR )
C      TP OOPHX CHAA  KAO A TAE CET  UOPA, UOPB,
C     UOPC, KOTOPE OH OEPEAT "CBO" AHE HAPEH HA
C     OHAKOB O ( =< 60 . PA ).
C         CHA PABEH HA TPCTOP KATOHO P OPMPTC
C     P OOTEHOM HAPEH PABEH P COBAEH EO C
C     HCAAM ACTKOM COOTBETCTBEO OOPHOO HAPEH.
C      AHOHO P - TOE P OTPATEHOM HAPEH PABEH.
C         TEHOCT MCA PABEH AAETC OOBATEEM
C     EPE APAMETP / PSUB 9.
C         P EPEXOE TOKA HAPK EPE HO OEPBAETC
C     ETOKOBA AA, TEHOCT KOTOPO AAETC OOBATEEM
C     EPE APAMETP / PSUB 9.
C
C
C     OCAHE C, PABE TPEXAHO-OHOAHM PEOPAOBATEEM
C     CEEE :
C
C       #  T 301   0  
C           MAS < 5  #1  #CM1  #2  #CM2  #3  #CM3  #4  #CM4
C                    #5  #CM5  >
C           MAS < 0 >
C           PSUB  9  <  DIMP   TPAUSE  >  ;
C
C    E
C      #1,#CM1 - HOMEP EMEHTA, TOK KOTOPOO COETC B KAECTBE
C                  CHAA PABEH ;
C      #2,#CM2 - HOMEPA EMEHTOB, TOK KOTOPOO COETC B
C      #3,#CM3   KAECTBE OOPHX CHAOB COOTBETCTBEHHO 
C      #4,#CM4   A "A", "B", "C";
C      #5,#CM5 - HOMEP EMEHTA, TOK KOTOPOO BETC TOKOM
C                  HAPK ;
C      DIMP      - TEHOCT MCA PABEH ( CEK.);
C      TPAUSE    - TEHOCT ETOKOBO A    ( CEK.).
C
C
C######################################################################
C
C
C   METO:     OEBEH.
C   -----
C  APAMETP:   NEL - HOMEP EMEHTA,  KOTOPOO PSUB PAOTAET;
C  ---------    URMAS - MACCB AHHX OOBATE:
C                       1-E COBO - KOECTBO APAMETPOB B CCKE
C                       ( ACAHO EM COM B BEECTBEHH MACCB )
C                       2-E COBO  AEE - APAMETP PSUB,
C                           AAHHE OOBATEEM;
C
C----------------------------------------------------------------------
C              STMAS - MACCB AHHX, EPEABAEMX B PSUB:
C
C      COBO           OOHAEHE   -   HAEHE
C      1               TN - BPEM N - O AA PACETA;
C      2               H0 - A HTEPPOBAH;
C      3               I1 - HAEHE 1-O TOKA, ATPEOBAHHOO
C                           OOBATEEM,  MOMEHTA BPEMEH TN;
C      4               I11- TOE,  MOMEHTA TN+H0;
C         AEE AHAOHO HAEH OCTAHX TOKOB;
C   N=3+2*NTOKOB       U1 - HAEHE 1-O HAPEH, ATPEOBAHHOO
C                           OOBATEEM,  MOMEHTA BPEMEH TN;
C    N+1               U11- TOE,  MOMEHTA TN+H0;
C         AEE AHAOHO HAEH OCTAHX HAPEH;
C
C----------------------------------------------------------------------
C              DGMAS  -  MACCB BECEHHX APAMETPOB C.
C
C   COBO        OOHAEHE - HAEHE:
C  OT 1 O 6     - HAEH MCIU ( KO C )
C                  MCIU = 00  --> "C" HET B [TN, TN+H0];
C                                  HX = 0.0;
C                  MCIU = 01  --> B [TN, TN+H0] -> EPEH POHT
C                                 MCA "C", HX = HTEPBA OT
C                                 TN O EPEHEO POHTA "C";
C                  MCIU = 10 -->  B [TN, TN+H0] -> AH POHT
C                                 MCA "C", HX = HTEPBA
C                                 OT TN O AHEO POHTA MCA  ;
C                  MCIU = 11 -->  B [TN, TN+H0] "C" BKEH,
C                                 COCTOHE HE MEH, HX=0.0;
C
C  OT 7 O 12    - HAEH COOTBETCTBX HX ( AA O BPEMEH
C                    O MOMEHTA MEHEH KOA C )
C----------------------------------------------------------------------
C              INTMAS - MACCB  OHOO COBA.
C                       ( B OPOPAMME HE COETC )
C----------------------------------------------------------------------
C
C   OPOPAMM: HET
C   -------------
C
C   PMEAHE: CMMA KOECTBA TPEEMX TOKOB  HAPEH
C   ----------  HE OHA PEBAT 49-T.
C               ( KOHTPO HE POBOTC )
CZZZ-------------------------------------------------------------------
       DIMENSION URMAS(*), STMAS(*), DGMAS(*), INTMAS(*)
       REAL INTMAS
C----------------------------------------------------------------------
       TN = STMAS(1)
       H0 = STMAS(2)
C----------------------------------------------------------------------
C BBOM AHHE
C----------------------------------------------------------------------
       UYPR = STMAS(3)
       UYPR1= STMAS(4)
       UOPA = STMAS(5)
       UOPA1= STMAS(6)
       UOPB = STMAS(7)
       UOPB1= STMAS(8)
       UOPC = STMAS(9)
       UOPC1= STMAS(10)
       TOKNG= STMAS(11)
       TOKNG1=STMAS(12)
       IF( ABS(TOKNG) .LT. 1.E-4 ) TOKNG = 0.0
       IF( ABS(TOKNG1).LT. 1.E-4 ) TOKNG1= 0.0
       DIMP = URMAS(2)
       TIMEP = URMAS(3)
       TIME1 = URMAS(4)
       TIME2 = URMAS(5)
       TIME3 = URMAS(6)
       TIME4 = URMAS(7)
       TIME5 = URMAS(8)
       TIME6 = URMAS(9)
       TIME0 = URMAS(10)
       IF( (TIME1 + DIMP) .LT. TN ) TIME1 = 0.0
       IF( (TIME2 + DIMP) .LT. TN ) TIME2 = 0.0
       IF( (TIME3 + DIMP) .LT. TN ) TIME3 = 0.0
       IF( (TIME4 + DIMP) .LT. TN ) TIME4 = 0.0
       IF( (TIME5 + DIMP) .LT. TN ) TIME5 = 0.0
       IF( (TIME6 + DIMP) .LT. TN ) TIME6 = 0.0
       IF( (TIME0 + TIMEP).LT. TN ) TIME0 = 0.0
C----------------------------------------------------------------------
C-->  OHEM BXOHE AHHE
C----------------------------------------------------------------------
       DO 10 I= 1,12
       DGMAS(I) = 0.0
10     CONTINUE
C----------------------------------------------------------------------
C->   EM EPEH POHT
C----------------------------------------------------------------------
C--->  KAKO BEHT PAOTAET?
C--->  MOET PAOTAET BEHT B AE A?
       HXA = -1.
       A = UOPA1 - UOPA
       C = UYPR1 - UYPR
       IF( A .EQ. C ) GO TO 100
       HXA = H0 * (UYPR - UOPA)/(A-C)
       IF( HXA .LT. 0.0  .OR.  HXA .GT. H0 ) HXA = -1.
100    CONTINUE
C--->  MOET PAOTAET BEHT B AE B?
       HXB = -1.
       A = UOPB1 - UOPB
       C = UYPR1 - UYPR
       IF( A .EQ. C ) GO TO 200
       HXB = H0 * (UYPR - UOPB)/(A-C)
       IF( HXB .LT. 0.0  .OR.  HXB .GT. H0 ) HXB = -1.
200    CONTINUE
C--->  MOET PAOTAET BEHT B AE C?
       HXC = -1.
       A = UOPC1 - UOPC
       C = UYPR1 - UYPR
       IF( A .EQ. C ) GO TO 300
       HXC = H0 * (UYPR - UOPC)/(A-C)
       IF( HXC .LT. 0.0  .OR.  HXC .GT. H0 ) HXC = -1.
300    CONTINUE
C----------------------------------------------------------------------
C-->  BEHT KAKO P PAOTAET?
C----------------------------------------------------------------------
       PRZV = TOKNG * TOKNG1
       IA =1
       IK =1
       IF( PRZV .LE. 0.0 ) GO TO 500
       IF( TOKNG .GT. 0.0 ) IA = 0
       IF( TOKNG .LT. 0.0 ) IK = 0
       GO TO 1000
C----------------------------------------------------------------------
500    CONTINUE
       HXTOK = 0.0
       IF( TOKNG .NE. TOKNG1 ) GO TO 600
       IF( UYPR1 .GE. 0.0    ) IA = 0
       IF( UYPR1 .LT. 0.0    ) IK = 0
       GO TO 1000
C----------------------------------------------------------------------
600    CONTINUE
       HXTOK = H0 * TOKNG / (TOKNG - TOKNG1)
       IF( UYPR1 .GE. 0.0    ) IA = 0
       IF( UYPR1 .LT. 0.0    ) IK = 0
       IF( TIME0 .GT. 0.0    ) GO TO 1000
       TIME0 = TN + HXTOK
1000   CONTINUE
C----------------------------------------------------------------------
C-->  OPMPEM BXOHO CHA!
C----------------------------------------------------------------------
C
C           BEHT A  "A"
C
C----------------------------------------------------------------------
C--->  BEHT KATOHO P.
C----------------------------------------------------------------------
       IF( IK .EQ. 1  .AND.  HXA .GE.0.0  .AND.  UOPA .GE. UOPA1 )
     * GO TO 2004
C->  HA AE EPEHEO POHTA HA AHHOM BEHTE HET.
       IF( TIME1 .GT. 0.0 ) GO TO 2001
C->  CHAA HE O  HET
       DGMAS(1) = 0.0
       GO TO 2005
2001   CONTINUE
C->  CHA   ET
       IF( (TIME1 + DIMP) .LE. (TN+H0) ) GO TO 2002
       DGMAS(1) = 11.
       GO TO 2005
2002   CONTINUE
C->  CHA , TEEP HE ET
       DGMAS(1) = 10.
       DGMAS(7) = TIME1 + DIMP - TN
       GO TO 2005
2004   CONTINUE
C->  CHAA HE O, TEEP ET
       DGMAS(1) = 1.
       DGMAS(7) = HXA
       TIME1 = TN + HXA
2005   CONTINUE
C----------------------------------------------------------------------
C--->  BEHT AHOHO P.
C----------------------------------------------------------------------
       IF( IA .EQ. 1  .AND.  HXA .GE.0.0  .AND.  UOPA .LE. UOPA1 )
     * GO TO 2009
C->  HA AE EPEHEO POHTA HA AHHOM BEHTE HET.
       IF( TIME4 .GT. 0.0 ) GO TO 2006
C->  CHAA HE O  HET
       DGMAS(4) = 0.0
       GO TO 2010
2006   CONTINUE
C->  CHA   ET
       IF( (TIME4 + DIMP) .LE. (TN+H0) ) GO TO 2007
       DGMAS(4) = 11.
       GO TO 2010
2007   CONTINUE
C->  CHA , TEEP HE ET
       DGMAS(4) = 10.
       DGMAS(10) = TIME4 + DIMP - TN
       GO TO 2010
2009   CONTINUE
C->  CHAA HE O, TEEP ET
       DGMAS(4) = 1.
       DGMAS(10) = HXA
       TIME4 = TN + HXA
2010   CONTINUE
C----------------------------------------------------------------------
C
C           BEHT A  "B"
C
C----------------------------------------------------------------------
C--->  BEHT KATOHO P.
C----------------------------------------------------------------------
       IF( IK .EQ. 1  .AND.  HXB .GE. 0.0  .AND.  UOPB .GE. UOPB1 )
     * GO TO 2014
C->  HA AE EPEHEO POHTA HA AHHOM BEHTE HET.
       IF( TIME2 .GT. 0.0 ) GO TO 2011
C->  CHAA HE O  HET
       DGMAS(2) = 0.0
       GO TO 2015
2011   CONTINUE
C->  CHA   ET
       IF( (TIME2 + DIMP) .LE. (TN+H0) ) GO TO 2012
       DGMAS(2) = 11.
       GO TO 2015
2012   CONTINUE
C->  CHA , TEEP HE ET
       DGMAS(2) = 10.
       DGMAS(8) = TIME2 + DIMP - TN
       GO TO 2015
2014   CONTINUE
C->  CHAA HE O, TEEP ET
       DGMAS(2) = 1.
       DGMAS(8) = HXB
       TIME2 = TN + HXB
2015   CONTINUE
C----------------------------------------------------------------------
C--->  BEHT AHOHO P.
C----------------------------------------------------------------------
       IF( IA .EQ. 1  .AND.  HXB .GE. 0.0  .AND.  UOPB .LE. UOPB1 )
     * GO TO 2019
C->  HA AE EPEHEO POHTA HA AHHOM BEHTE HET.
       IF( TIME5 .GT. 0.0 ) GO TO 2016
C->  CHAA HE O  HET
       DGMAS(5) = 0.0
       GO TO 2020
2016   CONTINUE
C->  CHA   ET
       IF( (TIME5 + DIMP) .LE. (TN+H0) ) GO TO 2017
       DGMAS(5) = 11.
       GO TO 2020
2017   CONTINUE
C->  CHA , TEEP HE ET
       DGMAS(5) = 10.
       DGMAS(11) = TIME5 + DIMP - TN
       GO TO 2020
2019   CONTINUE
C->  CHAA HE O, TEEP ET
       DGMAS(5) = 1.
       DGMAS(11) = HXB
       TIME5 = TN + HXB
2020   CONTINUE
C----------------------------------------------------------------------
C
C           BEHT A  "C"
C
C----------------------------------------------------------------------
C--->  BEHT KATOHO P.
C----------------------------------------------------------------------
       IF( IK .EQ. 1  .AND.  HXC .GE. 0.0  .AND.  UOPC .GE. UOPC1 )
     * GO TO 2024
C->  HA AE EPEHEO POHTA HA AHHOM BEHTE HET.
       IF( TIME3 .GT. 0.0 ) GO TO 2021
C->  CHAA HE O  HET
       DGMAS(3) = 0.0
       GO TO 2025
2021   CONTINUE
C->  CHA   ET
       IF( (TIME3 + DIMP) .LE. (TN+H0) ) GO TO 2022
       DGMAS(3) = 11.
       GO TO 2025
2022   CONTINUE
C->  CHA , TEEP HE ET
       DGMAS(3) = 10.
       DGMAS(9) = TIME3 + DIMP - TN
       GO TO 2025
2024   CONTINUE
C->  CHAA HE O, TEEP ET
       DGMAS(3) = 1.
       DGMAS(9) = HXC
       TIME3 = TN + HXC
2025   CONTINUE
C----------------------------------------------------------------------
C--->  BEHT AHOHO P.
C----------------------------------------------------------------------
       IF( IA .EQ. 1  .AND.  HXC .GE. 0.0  .AND.  UOPC .LE. UOPC1 )
     * GO TO 2029
C->  HA AE EPEHEO POHTA HA AHHOM BEHTE HET.
       IF( TIME6 .GT. 0.0 ) GO TO 2026
C->  CHAA HE O  HET
       DGMAS(6) = 0.0
       GO TO 2030
2026   CONTINUE
C->  CHA   ET
       IF( (TIME6 + DIMP) .LE. (TN+H0) ) GO TO 2027
       DGMAS(6) = 11.
       GO TO 2030
2027   CONTINUE
C->  CHA , TEEP HE ET
       DGMAS(6) = 10.
       DGMAS(12) = TIME6 + DIMP - TN
       GO TO 2030
2029   CONTINUE
C->  CHAA HE O, TEEP ET
       DGMAS(6) = 1.
       DGMAS(12) = HXC
       TIME6 = TN + HXC
2030   CONTINUE
C----------------------------------------------------------------------
C-->  A KAK HA CET "ETOKOBO A"?
C----------------------------------------------------------------------
       IF( TN .GE. (TIME0+TIMEP) ) GO TO 9999
       DO 2050 I=1,12
       DGMAS(I) = 0.0
2050   CONTINUE
9999   CONTINUE
       URMAS(4) = TIME1
       URMAS(5) = TIME2
       URMAS(6) = TIME3
       URMAS(7) = TIME4
       URMAS(8) = TIME5
       URMAS(9) = TIME6
       URMAS(10)= TIME0
       RETURN
C----------------------------------------------------------------------
       END
