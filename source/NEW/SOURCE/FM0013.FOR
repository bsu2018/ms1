         SUBROUTINE FM0013( BA0T, KNOTT, PAR0T, RMSW, LM )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C   OPOPAMMA:  FM0013( BA0T, KNOTT, PAR0T, RMSW, LM )
C   ------------
C
C   HAHAEHE:    HACTPOKA MAKPOMOE:
C  ------------
C                  T     M MOE     OOHAEH B AHEEM
C
C                  667      . K ( PEE )         KL
C
C
C      MOE KOPETC:
C
C       # T 667  "K" "M"  MAS < T(1) T(2) T(3) ... T(KT) >;
C
C   P TOM K BKEH -->
C
C      T(J)  <=  TN  <=  T(J+1)    P J HE ETHOE
C                                  ****************
C
C
C      !!! P KT=0 ( T.E. P " MAS <  >;" ) K BCEA AKPT !!!
C
C
C                  POBOT OPMPOBAHE "EPEMEHHO" ACT MSW
C                  MAKPOMOE.
C
C   METO:         PAMETKA OE RMSW O MOE "K",
C   -----
C
C   APAMETP:     BA0T, KNOTT, PAR0T - "OTPEK" HOPMAOHHX
C  ----------      MACCOBOB BA0, KNOT, PAR0 ( CM. INPUT0  GETMSW );
C                  RMSW - "EPEMEHHA" ACT MSW ( "OTPEOK" MSWALL );
C                  LM - HA "EPEMEHHO" ACT RMSW( P FGMSW = 0 )
C                  LM - HA BCEO MSW OCAH     ( P FGMSW = 1 )
C
C
C   OPOPAMM:  1.COMMON PROF1
C   ------------
C
C   PMEAHE:    1. KOHTPO B MHMAHOM O"EME;
C   -----------    2. BCE HE OPEEEME O RMSW AHTC;
C                  3.  BCE BPEMEHA KOPTC B CEKHAX.
C
C
C
C
C                           K
C                           BK.
C                            I
C       *********       **********               *********
C       *********       **********               *********
C       *********       **********               *********
C  T0*--*********-------**********---------------*********---------*--->
C       T(1)    T(2)    T(3)     T(4)            T(J)    T(J+1)    T(KT)
C
C
C            K AKPT ( BK. ) -->
C            -----------
C            TN < T(1)
C            TN > T(KT)  --> KT ETHOE;
C
C            K OTKPT ( BK. ) -->
C            -----------
C            TN >=T(KT) --> KT HE ETHOE;
C            T(J) <= TN <= T(J+1) --> J HE ETHOE;
C
C
C
C                  4. HE PBOTC OPMAT RMSW:
C
C                  RMSW TA # 667 [ . K     ]
C                  --------------------------------
C                                                      LM<O>=15+KT
C
C                                                      LM<OK>= 5+KT
C                    SPM                      SRAB
C +--+--+----+----+----+------+------+---+----------+
C IKDIHXI MM I HX I KT I T(1) I T(2) I...I T(KT)    I
C I  I  I CIUI CIUI    I      I      I   I          I
C I  I  I    I    I    I      I      I   I          I
C +--+--+----+----+----+------+------+---+----------+
C I1 I2 I 3  I 4  I 5  I  6   I  7   I...I 5 + KT   I
C +--+--+----+----+----+------+------+---+----------+
C I11I12I 13 I 14 I 15 I  16  I 17   I...I 15 + KT  I
C +--+--+----+----+----+------+------+---+----------+
C
C      KT -  KOECTBO TOEK OPEEEH "KAPT" BKEH KOA;
C
C      K OTKPT -> KD=1;    K AKPT ->  KD=0;
C      HX - A O BPEMEH, BPEM BOMOHOO EPEKEH;
C
C        MCIU  HXCIU - APAMETP "BOCTAHOBEHHOO" MCA BKEH;
C                            ( CM. MCIU01 );
C
CZZZ-------------------------------------------------------------------
         COMMON /PROF1/ MASPRT(200)
         EQUIVALENCE ( RKT, KT )
         EQUIVALENCE ( FGMSW, MASPRT(87) )
C
         INTEGER FGMSW
         DIMENSION BA0T(*), KNOTT(*), PAR0T(*), RMSW(*)
         INTEGER BA0T, TIP
         TIP = BA0T(2)
         NEL = BA0T(1)
         NWTR = MASPRT(13)
         IF ( TIP .EQ. 667 ) GO TO 1
C!!!-------------------------------------------------------------------
         NWTRE = MASPRT(14)
         WRITE(NWTRE, 500) TIP, NEL
500      FORMAT(' *** O. CO B FM0013: HOMEP TA HE OCBAETC **
     =*'/' *** HOMEP TA ', I10, ' EMEHT HOMEP: ', I10, '***')
C!!!-------------------------------------------------------------------
         CALL SUBERR(1)
C######################################################################
C######################################################################
1      CONTINUE
       IF ( FGMSW .EQ. 0 ) GO TO 1000
C-->  OA HA
       KT = IFIX( PAR0T(1) )
       LM = 15 + KT
       RETURN
C----------------------------------------------------------------------
1000   CONTINUE
       KT = IFIX( PAR0T(1) )
       LM = 5 + KT
       DO 2 I=1,LM
2      RMSW(I) = 0.0
C-->  AC KT-->
       RMSW(5) = RKT
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
        IF ( KT .LE. 0 ) RETURN
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C-->  AC T(J) -->
       DO 3 I=1,KT
       RMSW(5+I) = PAR0T(1+I)
3      CONTINUE
       RETURN
       END
