       SUBROUTINE FM0025(BA0T, KNOTT, PAR0T, RMSW, LM )
CXXX----KOMEKC "MS1" --> BEPC 1.1  (OT  EKAP  1987 .)-----------
C   OPOPAMMA: FM0025(BA0T, KNOTT, PAR0T, RMSW, LM )
C   -------------
C   HAHAEHE:  HACTPOKA MAKPOMOEE POBX OECKX EMEHTOB:
C   ----------
C               +-----+--------------------------------------+
C               I     I                                      I
C               I T I    HAMEHOBAHE EMEHTA             I
C               I     I                                      I
C               +-----+--------------------------------------+
C               I 330 I POBO OECK EMEHT   ""    I
C               +-----+--------------------------------------+
C               I 331 I POBO OECK EMEHT   ""  I
C               +-----+--------------------------------------+
C               I 332 I POBO OECK EMEHT"CK."I
C               +-----+--------------------------------------+
C
C                PHAK TIP # 4 -> O. MAKPOMOE.
C                ( DM0029, LM0007 )
C                      OPMPET "EPEMEHH" ACT RMSW OCAH
C
C                      HA:   BCEX TOB :==>+1<VAR>
C----------------------------------------------------------------------
C              EMEHT OCBATC:
C
C          # T 33X  0 
C              MAS < NBXOD  #1 #CM1  #2 #CM2   ... >;
C
C         E
C          NBXOD  -   KOECTBO TOKOB EMEHTOB CXEM , KOTOPE
C                     COTC B KAECTBE BXOHX CHAOB;
C          #I,#CMI- HOMEP EMEHTA  HOMEP TOKA EMEHTA ,
C                     COEMOO B KAECTBE BXOHOO CHAA;
C----------------------------------------------------------------------
C
C   METO:         PAMETKA OE RMSW O MOE
C   -----
C
C   APAMETP:     BA0T, KNOTT, PAR0T - "OTPEK" HOPMAOHHX
C  ----------      MACCOBOB BA0, KNOT, PAR0 ( CM. INPUT0  GETMSW );
C                  RMSW - "EPEMEHHA" ACT MSW ( "OTPEOK" MSWALL );
C                  LM - HA "EPEMEHHO" ACT RMSW P FGMSW = 0;
C                  LM - HA BCEO MSW OCAH      P FGMSW = 1;
C
C   OPOPAMM:  1.COMMON PROF1
C   ------------
C
C   PMEAHE:    1. KOHTPO B MHMAHOM O"EME;
C   -----------    2. BCE HE OPEEEME O RMSW AHTC;
C                  3. HE PBOTC OPMAT RMSW:
C
C
C              OPMAT RMSW T # 33X:
C              ----------------------
C+-----------I--------------I------I-----------------------------------
C  # COBA   I    # COBA B I KTO  I
C OT HAAA  I    OTPEKE   IOPE.I
C BCEO MSW  I    RMSW B    I      I       OOHAEHE - HAEHE
C OCAH   I    FM0025    I      I
C------------I--------------I------I-----------------------------------
C     9      I     0        I      I HOMEP A ( BCEA 0 )
C----------------------------------------------------------------------
C    10      I     1        I  DM  I         PEEPB
C            I              I      I
C    11      I     2        I  FM  I  NBXOD-KOECTBO TOKOB, CO-
C            I              I      I        EMX KAK BXOHE CHA;
C    12      I     3        I  FM  I  #1 - HOMEP EMEHTA;
C    13      I     4        I  FM  I  #CM1 - HOMEP TOKA EMEHTA #1;
C    14      I     5        I  LM  I  ATOKM1 - AP B TOKN/N1 HAEH
C            I              I      I           TOKA HOMEP #CM1
C            I              I      I           EMEHTA #1;
C .......    I   .......    I  ... I  ..........................
C  9+I*3     I     I*3      I  FM  I  #I -      -"-
C 10+I*3     I   1+I*3      I  FM  I  #CMI -      -"-
C 11+I*3     I   2+I*3      I  LM  I  ATOKMI -    -"-
C .......    I   .......    I  ... I  ..........................
C----------------------------------------------------------------------
C  OA HA MSW --> LM<BC> = 11 + 3*NBXOD
C
C  HA EPEMEH. ACT --> LM<RMSW> = 2 + 3*NBXOD
CZZZ-------------------------------------------------------------------
       COMMON /PROF1/ MASPRT(200)
       DIMENSION BA0T(*), KNOTT(*), PAR0T(*), RMSW(*)
       EQUIVALENCE( NWTR, MASPRT(13) )
       EQUIVALENCE( NWTRE, MASPRT(14) )
       EQUIVALENCE( FGMSW, MASPRT(87) )
       EQUIVALENCE( H0   , MASPRT(30) )
       EQUIVALENCE ( RN  ,   N  )
       INTEGER  TIP, BA0T, FGMSW
       NEL = BA0T(1)
       TIP = BA0T(2)
       NTIP= TIP - 329
       IF ( NTIP .GE. 1 .AND. NTIP .LE. 3 ) GO TO 1
C!!!-------------------------------------------------------------------
       WRITE(NWTRE, 501 ) NEL, TIP
501    FORMAT(/' *** O. CO B FM0025 --> HOMEP TA HE HA ***'/
     =  ' *** HOMEP EMEHTA ', I5, ' HOMEP TA ', I5, ' ***'/)
C!!!-------------------------------------------------------------------
       CALL SUBERR(TIP)
C######################################################################
1      CONTINUE
C----------------------------------------------------------------------
C --->           POBO OECK EMEHT   ""
C --->           POBO OECK EMEHT   ""
C --->           POBO OECK EMEHT"CK."
C----------------------------------------------------------------------
C--> OPEEEHE KOHCTAHT
       NBXOD = IFIX ( PAR0T(2) )
       IF ( FGMSW .EQ. 0 ) GO TO 1000
C----------------------------------------------------------------------
C-->  TOHT LM <O >
       LM = 11 + 3*NBXOD
       RETURN
C######################################################################
1000   CONTINUE
C-->  PHT  TO MOHO COPMPOBAT..
       LM = 2 + 3*NBXOD
       DO 20 I=1,LM
20     RMSW(I) = 0.0
C---> POBEPM  PABHO  BBEEH AHHE?
       NBXOD1 = ( IFIX( PAR0T(1)) - 1 ) / 2
       IF ( NBXOD .EQ. NBXOD1 ) GO TO 22
C!!!-------------------------------------------------------------------
       WRITE(NWTRE, 502 ) NEL, TIP
502    FORMAT(/' *** OKA B FM0025 -->HEPABHO AAHO KOECTBO TO
     =EK ***'/' *** HOMEP EMEHTA ', I5, ' HOMEP TA ', I5, ' ***'/)
       CALL SUBERR(TIP)
C!!!-------------------------------------------------------------------
22     CONTINUE
C---> AOMHM HOMEPA BXOHX TOKOB.
       N = NBXOD
       RMSW(2) = RN
       IPAR0T = 2
       IRMSW = 2
          DO 25 I = 1 , NBXOD
          IPAR0T = IPAR0T + 1
          IRMSW = IRMSW + 1
          N = IFIX ( PAR0T(IPAR0T) )
          IF( N .GE. NEL ) GO TO 9999
          RMSW(IRMSW) = RN
          IPAR0T = IPAR0T + 1
          IRMSW = IRMSW + 1
          N = IFIX ( PAR0T(IPAR0T) )
          RMSW(IRMSW) = RN
          IRMSW = IRMSW + 1
25     CONTINUE
       RETURN
C######################################################################
9999   CONTINUE
C!!!-------------------------------------------------------------------
       WRITE(NWTRE, 555 ) NEL, TIP,N
555    FORMAT(/' *** OKA B FM0025 -->HEPABHO AAH BXOHE AHH
     =E   ***'/' *** HA BXO EMEHTA ', I5, ' HOMEP TA ', I5,' ***',
     =         ' *** OAETC TOK EMEHTA, MEEO O OPKOB
     =HOMEP ( # ' ,I3,' )  *** ')
C!!!-------------------------------------------------------------------
       CALL SUBERR(TIP)
C######################################################################
       RETURN
       END
