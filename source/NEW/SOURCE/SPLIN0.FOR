       SUBROUTINE SPLIN0( W   )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C   OPOPAMMA: SPLIN0 ( W     )
C   ------------
C   HAHAEHE:   BCEHE KOEHTOB K. CAHA Y=F(X),
C   -----------   AAHHO TAHO; HACTPOKA  / SEVAL0;
C
C                 B HTEPBAE  X(I) <=  X  <=  X(I+1) OPEEETC:
C
C    F(X) = Y(I) + B(I)*[X-X(I)] + C(I)*[X-X(I)]**2 + D(I)*[X-X(I)]**3;
C
C   METO:        CM. HAPMEP, OPCAT .  P. MA. METO
C   -----         MAT. BCEH, M.: MP, 1980, 279 C.
C                 ==  MOKA  KOMEKCA "MS1"  ====
C   APAMETP:    MACCB W ( XYMAS ) COEPT:
C   ---------     1 COBO --------------> N - KO-BO TOEK ( INTEGER*4 )
C                OT 2-O O (2*N+1)-O ---------> X1,Y1,...  TOK F(X);
C                OT (2*N+2) O (5*N+1)  MACCB "B", "C", "D";
C   OPOPAMM:  SUBERR
C   ------------
C    PMEAHE:  1.P N < 2 - ABEND 6660
C    ----------   2.P N = 2 - HEHA HTEPO;
CZZZ-------------------------------------------------------------------
       DIMENSION     W(*)
       EQUIVALENCE( RN, N )
C
C   X,Y,B,C,D  -  BCTPOEHHE HK. "BXO" HA HH MACCB
C                 (SB,SC,SD  - CMEEH)
C      X(I)=XYMAS(2*I)
C      Y(I)=XYMAS(2*I+1)
C      B(I)=XYMAS(SB+I)
C      C(I)=XYMAS(SC+I)
C      D(I)=XYMAS(SD+I)
       INTEGER SB,SC,SD
C**********************************************************************
       RN =       W(1)
       SB=2*N+1
       SC=3*N+1
       SD=4*N+1
C**********************************************************************
       NM1=N-1
       NM2 = N - 2
       NM3 = N - 3
       IF(N.LT.2) CALL SUBERR(6660)
       IF(N.LT.3) GO TO 50
C**********************************************************************
C      B - AOHA, D - HAAOHA, C - PABE ACT
       W(SD+1)=W(2*2)-W(2*1)
C
       W(SC+2)=(W(1+2*2)-W(1+2*1))/W(SD+1)
C
       DO 10 I=2,NM1
           IP1 = I+1
           IM1 = I-1
           W(SD+I)=W(2*IP1)-W(2*I)
           W(SB+I)=2*(W(SD+IM1)+W(SD+I))
           W(SC+IP1)=(W(1+2*IP1)-W(1+2*I))/W(SD+I)
           W(SC+I)=W(SC+IP1)-W(SC+I)
  10   CONTINUE
C***********************************************************************
C                       PAHHE  COB
           W(SB+1) = -W(SD+1)
           W(SB+N) = -W(SD+NM1)
           W(SC+1) = 0.0
           W(SC+N) = 0.0
       IF(N.EQ.3) GO TO 15
           W(SC+1) = W(SC+3)/(W(2*4)-W(2*2))
     =             -  W(SC+2)/(W(2*3)-W(2*1))
           W(SC+N) = W(SC+NM1)/(W(2*N)-W(2*NM2))
     =          - W(SC+NM2)/(W(2*NM1)-W(2*NM3))
           W(SC+1) = W(SC+1)*W(SD+1)**2
     =           /(W(2*4)-W(2*1))
           W(SC+N) = -W(SC+N)*W(SD+NM1)**2
     =          /(W(2*N)-W(2*NM3))
   15  CONTINUE
       DO 20 I=2,N
          T = W(SD+I-1)/W(SB+I-1)
          W(SB+I) = W(SB+I)-T*W(SD+I-1)
          W(SC+I) = W(SC+I)-T*W(SC+I-1)
   20  CONTINUE
C**********************************************************************
C                          OCTAHOBK
          W(SC+N) = W(SC+N)/W(SB+N)
       DO 30 IB=1,NM1
          I = N-IB
          IP1 = I + 1
          W(SC+I) = (W(SC+I)-W(SD+I)*W(SC+IP1))/W(SB+I)
   30  CONTINUE
C**********************************************************************
C                    KOEHT OHOMOB
       W(SB+N) = (W(1+2*N)-W(1+2*NM1))/W(SD+NM1)
     =      + W(SD+NM1)*(W(SC+NM1)+2*W(SC+N))
       DO 40 I=1,NM1
       IP1 = I + 1
       W(SB+I) = (W(1+2*IP1)-W(1+2*I))/W(SD+I)
     =      - W(SD+I)*(W(SC+IP1)+2*W(SC+I))
       W(SD+I) = (W(SC+IP1)-W(SC+I))/W(SD+I)
       W(SC+I) = 3*W(SC+I)
  40   CONTINUE
       W(SC+N) = 3*W(SC+N)
       W(SD+N) = W(SD+NM1)
       RETURN
C**********************************************************************
  50   CONTINUE
       W(SB+1) = (W(1+2*2)-W(1+2*1))/(W(2*2)-W(2*1))
       W(SC+1) = 0.0
       W(SD+1) = 0.0
       W(SB+2) = W(SB+1)
       W(SC+2) = 0.0
       W(SD+2) = 0.0
       RETURN
C**********************************************************************
C**********************************************************************
        END
