       SUBROUTINE FM0010(BA0T, KNOTT, PAR0T, RMSW, LM )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C   OPOPAMMA: FM0010(BA0T, KNOTT, PAR-T, RMSW, LM )
C   -------------
C   HAHAEHE:   HACTPOKA MAKPOMOE TA # 40
C   ----------   PETOP BOEH 3X3X0 . MAH;
C                ***************************************
C                .TIP # 4 -> O. MAKPOMOE.
C                ( DM0014, LM0001 )
C                      OPMPET "EPEMEHH" ACT RMSW OCAH
C                      ( HA :==> +1(VAR) )
C
C
C              EMEHT OCBAETC:
C
C       # T 40  KA KB KC
C           T_BK U_OTO. #-TA_._MAH_3X3X0
C              PSUB #P < .........>;
C
C              EPE AAPAT PSUB AATC AKOH PAEH "HE";
C
C      E
C              KA, KB, KC -  E, PHTE A OOPH CCTEM
C                           HAPEH ( CET ECKOHEHO MOHOCT );
C              T_BK - BPEM, HAHA C KOTOPOO BK. PE. BO.
C              U_OT. - OTOOHOE HAPEHE HA BXOE PETOPA
C                      ( OPAHBATC "CHCO" BX. HAPEH );
C              #. MA. - HOMEP EMEHTA, OCBA . MAH,
C                          KOTOP PEPEM;
C
C      BBOHE BEH B MACCBE TOKN/TOKN1:
C
C      U_R__A, U_R__B, U_R__C,  -->  HAPEH PABEH
C                                          B CCTEME OCE POTOPA;
C     OMEA_OPOHA, S_CKOEHE,
C
C    U_Q_P.  U_D_P;
C
C   I_S_D_A,   S_CKOEHE_A,  INT(ISD-ISD_ZAD),  INT(S-S_ZAD),
C    (#16)       (#17)               (#18)               (#19)
C    PEEPB;
C    (#20)                                 -->   BCEO 20 HAEH;
C
C*****  AHHA MOE OCBAET MAKPOMOE C T.# 11, 110, 12, 120;
C
C
C   METO:         PAMETKA OE RMSW O MOE
C   -----
C                       PSUB2 --> "BABAET" BBEEHHE OOBATEEM
C                                     HAEH  KTI  KTS;
C
C
C   APAMETP:     BA0T, KNOTT, PAR0T - "OTPEK" HOPMAOHHX
C  ----------      MACCOBOB BA0, KNOT, PAR0 ( CM. INPUT0  GETMSW );
C                  RMSW - "EPEMEHHA" ACT MSW ( "OTPEOK" MSWALL );
C                  LM - HA "EPEMEHHO" ACT RMSW P FGMSW = 0;
C                  LM - HA BCEO MSW OCAH      P FGMSW = 1;
C
C   OPOPAMM:  1.COMMON PROF1
C   ------------
C
C   PMEAHE:    1. KOHTPO B MHMAHOM O"EME;
C   -----------    2. BCE HE OPEEEME O RMSW AHTC;
C                  3. KO-BO APAMETPOB B / PSUB HE KOHTPOP.
C                     HET HA TO BPEMEH ( MOEO !!!)
C
C                4. OCAH AKOHOB PABEH PEAOBAHA PSUB1-->
C
C
C      1) ......... OCAH AKOHOB PABEH PEAOBAHA PSUB1-->
C
C      PSUB 1 < KE URD00 KI ISDZAD URQ00 KS BETA SZAD XAF  >;
C              ( 8-M APAMETPOB )
C
C
C      2) ......... OCAH AKOHOB PABEH PEAOBAHA PSUB2-->
C
C      PSUB 2 < KE URD00 KI ISDZAD URQ00 KS BETA SZAD   XAF
C
C      KTI  TI1 ISZAD_1  TI2 ISZAD_2 .....
C                        I         I
C                        I<---*--->I
C
C      KTS  TS1 S_1      TS2    S_2  ...... >;
C                        I         I
C                        I         I
C                        I<---*--->I
C
C
C    E:
C          -*-  BA HAEH, OCBAE OH TOK OPEEEH
C               COOTBETCTBE HKOHAHO ABCMOCT -->
C               OHA AAETC KAK KCOHO-HEHA HK;
C
C       KTI  - KO-BO TOEK  OPEEEH ABCMOCT ISZAD OT "TN";
C
C       KTS  - KO-BO TOEK  OPEEEH ABCMOCT SZAD  OT "TN";
C
C
C  PSUB1 --->  BCET:
C  *****
C     UYD0 = [ URD00 - KI*INT(ISD0-ISDZAD) ]* ( KE+1 ) - KE* XAF* IRD0;
C
C
C  UYQ0 = [URQ00 - KS *S - BETA*INT(S-SZAD) ]* ( KE+1 ) - KE* XAF*IRQ0;
C
C  E:  INT - HTEPA;
C
C
C  PSUB2 --->  BCET:
C  *****
C     UYD0 = [ URD00 - KI*INT(ISD0-ISDZAD) ]* ( KE+1 ) - KE* XAF* IRD0;
C
C
C  UYQ0 = [URQ00 - KS *S - BETA*INT(S-SZAD) ]* ( KE+1 ) - KE* XAF*IRQ0;
C
C  E:  INT - HTEPA, A ISDZAD  SZAD - KCOHO-HEHA HK
C                                                     B P E M E H 
C                                                     *************
C
C                  5. HE PBOTC OPMAT RMSW:
C
C              OPMAT RMSW T # 40:
C              ---------------------
C+-----------I--------------I------I-----------------------------------
C  # COBA   I    # COBA B I KTO  I       OOHAEHE - HAEHE
C OT HAAA  I    OTPEKE   IOPE.I
C BCEO MSW  I    RMSW B    I      I
C OCAH   I    FM0010    I      I
C            I              I      I
C------------I--------------I------I-----------------------------------
C     9      I    -2        I      I HOMEP A KA ( AA A )
C    10      I    -1        I      I HOMEP A KB ( AA B )
C    11      I     0        I      I HOMEP A KC ( AA C )
C----------------------------------------------------------------------
C    12      I     1        I  DM  I  FQ - A HOBE HA. BCEH
C            I              I      I   (  CHXPO. MAKPO. P.TIP # 4
C    13      I     2        I  FM  I  NELT - HOMEP . PEP. . MA.
C    14      I     3        I  LM  I  AMOT - AP. B MSWALL OCAH
C            I              I      I         PE. . MAH
C    15      I     4        I  LM  I  APOT - APEC B MSWALL OB MAH
C    16      I     5        I  LM  I  ATOKM - AP B TOKN/N1 BEH,
C            I              I      I          PACT.  . MA.
C    17      I     6        I  FM  I  TBKL - BPEM, HAHA C KOTOPOO
C            I              I      I         BKAETC PETOP;
C    18,19   I     7,8      I      I  PEEPB.
C    20      I     9        I  FM  I  UPOT - OTOOHOE HAPEHE
C    21      I     10       I  FM  I  NSUB - HOMEP / OOBATE
C22,23,24,25 I11,12,13,14,15I      I  PA. MECTO  HT. 1  2 B TOKN;
C  27        I    16        I  FM  I  NPAR - KO-BO APAMETPOB,
C            I              I      I         BBEEHHX B PSUB<..>
C OT 28 O   I OT 17 O     I FM   I  APAMETP PSUB, AAHHE
C 28 + NPAR  I 17 + NPAR    I      I  OOBATEEM
C            I 26 -->       I FM   I  KTI  PSUB2 ....
C            I 27+2*KTI --> I FM   I  KTS  PSUB2 ....
C            I              I      I
C            I              I      I
C            I              I      I
C----------------------------------------------------------------------
C
C  OA HA MSW --> LM<BC> = 28+NPAR
C
C  HA EPEMEH. ACT --> LM<RMSW> = 17+NPAR
C
CZZZ-------------------------------------------------------------------
       COMMON /PROF1/ MASPRT(200)
       DIMENSION BA0T(*), KNOTT(*), PAR0T(*), RMSW(*)
       EQUIVALENCE( NWTR, MASPRT(13) )
       EQUIVALENCE( NWTRE, MASPRT(14) )
       EQUIVALENCE( FGMSW, MASPRT(87) )
       EQUIVALENCE ( RNELT, NELT )
       EQUIVALENCE ( RNPSUB,  NPSUB )
       EQUIVALENCE ( RNPAR,   NPAR  )
       INTEGER NETL, NPSUB, NPAR, TIP, BA0T, FGMSW, AKTI, AKTS
       TIP = BA0T(2)
       NEL = BA0T(1)
       IF ( TIP .EQ. 40 ) GO TO 1
C!!!-------------------------------------------------------------------
       WRITE(NWTRE, 501 ) NEL, TIP
501    FORMAT(/' *** O. CO B FM0010 --> HOMEP TA HE HA ***'/
     =  ' *** HOMEP EMEHTA ', I5, ' HOMEP TA ', I5, ' ***'/)
C!!!-------------------------------------------------------------------
       CALL SUBERR(TIP)
C######################################################################
1      CONTINUE
       IF ( FGMSW .EQ. 0 ) GO TO 1000
C-->  TOHT LM <O >
C  PAR0T -> TBKL, UPOT, #. -NSUB, NPAR, ..APAMETP..... KTI     KTS
C            1     2     3     4     5     6....           15 .....
       LM = 28 + IFIX( PAR0T(5) )
       RETURN
C######################################################################
1000   CONTINUE
C-->  PHT  TO MOHO COPMPOBAT..
       NPAR = IFIX( PAR0T(5) )
       LM = 17 + NPAR
       DO 2 I=1,LM
2      RMSW(I) = 0.0
C--->
       RMSW(16) = FLOAT( NPAR )
C-->   !!!!!!!  = RNPAR
       NELT = IFIX( PAR0T(3) )
       RMSW(2) = RNELT
C-->
       UPOT = PAR0T(2)
       RMSW(9) = UPOT
C-->
       TBKL = PAR0T(1)
       RMSW(6) = TBKL
C-->
       NPSUB =  - IFIX( PAR0T(4) )
       RMSW(10) = RNPSUB
C-->  APAMETP PSUB--->
       DO 3 I=1, NPAR
3      RMSW(17-1 +I) = PAR0T( 6-1 + I)
C
C
C######################################################################
       IF ( NPSUB .EQ. 1 ) GO TO 20
       IF ( NPSUB .EQ. 2 ) GO TO 10
C!!!-------------------------------------------------------------------
       WRITE(NWTR,  502 ) NEL, TIP, NPSUB
       WRITE(NWTRE, 502 ) NEL, TIP, NPSUB
502    FORMAT(/' ***  EMEHTA ', I5, ' ( T ', I3, ' ) PSUB ', I2,
     =   ' HE PEAOBAHA ***'/ )
       STOP 667
C!!!-------------------------------------------------------------------
10     CONTINUE
C-->  BOM KTI   KTS -->
       IF( NPAR .LE. 9 ) GO TO 20
       KTI = IFIX( PAR0T(15) )
       KTI2 = 2*KTI
       RMSW(26) = FLOAT( KTI2 )
C-->  E BET KTS....
       KTS = IFIX( PAR0T( 16 + 2*KTI ) )
       KTS2 = KTS * 2
       RMSW(27 + 2*KTI ) = FLOAT( KTS2 )
C######################################################################
20     CONTINUE
       NPAR17 = NPAR + 17 - 1
       WRITE(NWTR,300) NEL, TIP, NPSUB, NPAR, (RMSW(I), I=17, NPAR17)
300    FORMAT(/' *** EMEHT ', I5, '   T ', I3, '   PSUB ', I2,
     =  22X,   '     ***'/
     = ' *** AAH APAMETP B KOECTBE ', I3, ' T. :', 21X,'***'/
     = ' ***      KE=', G12.5, ' URD00=', G12.5, ' KI=', G12.5,
     = '     ***'/
     = ' *** ISD_ZAD=', G12.5, ' URQ00=', G12.5, ' KS=', G12.5,
     = '     ***'/
     =' *** BETA=',G12.5,'  S_ZAD=',G12.5,' XAF=',G12.5, 6X,'***'/
     = ' ***', 20X,'OOHTEHO AAHO:', 20X, '***'/
     =     5(1X, G12.5, 1X) )
       WRITE(NWTR, 301 )
301    FORMAT(/)
C----------------------------------------------------------------------
       RETURN
       END
