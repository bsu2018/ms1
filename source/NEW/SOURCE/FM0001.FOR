         SUBROUTINE FM0001( BA0T, KNOTT, PAR0T, RMSW, LM )
CXXX----KOMèãEKC "MS1" --> BEPCàü 1.0  (OT ÑEKAÅPü 1986 É.)------------
C
C
C   èOÑèPOÉPAMMA:  FM0001( BA0T, KNOTT, PAR0T, RMSW, LM )
C   ------------
C
C
C   HAáHAóEHàE:    HACTPOâKA MAKPOMOÑEãEâ CãEÑìûôàX TàèOB:
C  ------------
C                  Tàè     àMü MOÑEãà     OÅOáHAóEHàü B ÑAãúHEâòEM
C
C                   1      COèPOTàBãEHàE           R
C
C                   2      àHÑìKTàBHOCTú           L
C
C                   3      EMKOCTú                 C
C
C                          àCTOóHàK
C                   4      èOCTOüHHOÉO             J
C                          TOKA
C
C                          àCTOóHàK
C                   5      èOCTOüHHOÉO             E
C                          HAèPüÜEHàü
C
C                          àCTOóHàK
C                   6      SIN                     ES
C                          HAèPüÜEHàü(1)
C
C                          àCTOóHàK
C                   7      SIN                     ES
C                          HAèPüÜEHàü(2)
C
C                  èPOàáBOÑàT îOPMàPOBAHàE "èEPEMEHHOâ" óACTà MSW
C                  MAKPOMOÑEãEâ ìKAáAHHõX TàèOB.
C
C   METOÑ:         BõóàCãüETCü à áAèàCõBAETCü B MSW BCü HEOÅXOÑàMAü
C   -----          àHîOPMAñàü, HEOÅXOÑàMAü Ñãü èOCãEÑìûôEÉO
C                  PACóETA MAKPOMOÑEãà. AÑAèTàPOBAHO K METOÑì
C                  ãàHàÑÜEPA - BàOãìÉÅà.
C
C   èAPAMETPõ:     BA0T, KNOTT, PAR0T - "OTPEáKà" àHîOPMAñàOHHõX
C  ----------      MACCOBOB BA0, KNOT, PAR0 ( CM. INPUT0 à GETMSW );
C                  RMSW - "èEPEMEHHAü" óACTú MSW ( "OTPEáOK" MSWALL );
C                  LM - ÑãàHA "èEPEMEHHOâ" óACTà RMSW - èOãü SPM à SRAB;
C
C   èOÑèPOÉPAMMõ:  1.COMMON PROF1
C   ------------
C
C
C   èPàMEóAHàE:    1. KOHTPOãú HE èPOàáBOÑàTCü;
C   -----------    2. BCE HE OèPEÑEãüEMõE èOãü RMSW áAHìãüûTCü;
C                  3. HàÜE èPàBOÑüTCü îOPMATõ RMSW:
C
C
C                  RMSW Tàè # 1 [ COèPOTàBãEHàE ]
C                  ------------------------------
C
C                 SPM
C             ++--------++
C             II áHAó.  II
C             II  1/R   II
C             II        II            LM = 1
C             ++--------++            ******
C             II   1    II
C             ++--------++
C             II  11    II
C             ++--------++
C
C
C                  RMSW TàèA # 2 [ àHÑìKTàBHOCTú ]
C                  -------------------------------
C
C                 SPM            SRAB
C              +--------++-----+-----+
C              I áHAó.  II     I     I
C              I   L    II  GL I  JL I
C              I        II     I     I
C              +--------++-----+-----+         LM = 3
C              I   1    II 2   I  3  I         ******
C              +--------++-----+-----+
C              I   11   II 12  I 13  I
C              +--------++-----+-----+
C
C
C
C
C                  RMSW TàèA # 3 [ EMKOCTú ]
C                  -------------------------
C
C                 SPM            SRAB
C             ++--------++-----+-----+
C             II áHAó.  II     I     I
C             II   C    II  GC I  JC I
C             II        II     I     I           LM = 3
C             ++--------++-----+-----+           ******
C             II   1    II  2  I  3  I
C             ++--------++-----+-----+
C             II   11   II 12  I 13  I
C             ++--------++-----+-----+
C
C
C
C
C
C                  RMSW TàèA # 4 [ àCTOóHàK èOCTOüHHOÉO TOKA ]
C                  -------------------------------------------
C
C                 SPM
C             ++--------+
C             II áHAó.  I
C             II   J    I
C             II        I
C             ++--------+           LM = 1
C             II   1    I           ******
C             ++--------+
C             II   11   I
C             ++--------+
C
C
C             RMSW TàèA # 5 [ èOCTOüHHõâ àCTOóHàK HAèPüÜEHàü ]
C             ------------------------------------------------
C
C                   SPM
C             ++--------+------++
C             II áHAó.  I áHAó.II
C             II  1/R   I  E/R II
C             II        I      II
C             ++--------+------++
C             II   1    I  2   II        LM = 2
C             ++--------+------++        *******
C             II  11    I  12  II
C             ++--------+------++
C
C
C
C                  RMSW TàèA # 6 [ àCTOóHàK SIN HAèPüÜEHàü(1) ]
C                  --------------------------------------------
C                    ( U = EM * SIN( OMEGA * T  +  FAZA )     LM = 5
C                                                             ******
C
C                             SPM                 SRAB
C             ++--------+------+--------+------++------+
C             II áHAó.  I áHAó.I        I FAZA II      I
C             II  1/R   I EM/R I OMEGA  I  P   II JES  I
C             II        I      I        I PAÑ. II      I
C             ++--------+------+--------+------++------+
C             II   1    I  2   I   3    I  4   II  5   I
C             ++--------+------+--------+------++------+
C             II  11    I  12  I  13    I  14  II  15  I
C             ++--------+------+--------+------++------+
C
C
C                  RMSW TàèA # 7 [ àCTOóHàK SIN HAèPüÜEHàü(2) ]
C                  --------------------------------------------
C                                                             LM = 7
C                                                             ******
C
C                      SPM                        SRAB
C     ++------+------+------+--------+------++------+------+
C     II      I      I áHAó.I        I FAZA II      I      I
C     II  R   I  L   I  EM  I OMEGA  I  P   II GES  I JES  I
C     II      I      I      I        I PAÑ. II      I      I
C     ++------+------+------+--------+------++------+------+
C     II  1   I  2   I  3   I   4    I  5   II  6   I   7  I
C     ++------+------+------+--------+------++------+------+
C     II  11  I  12  I  13  I  14    I  15  II  16  I  17  I
C     ++------+------+------+--------+------++------+------+
C
C
C
CZZZ-------------------------------------------------------------------
         COMMON /PROF1/ MASPRT(200)
         DIMENSION BA0T(*), KNOTT(*), PAR0T(*), RMSW(*)
         INTEGER BA0T, TIP
         REAL L
         TIP = BA0T(2)
         NEL = BA0T(1)
         NWTR = MASPRT(14)
         GO TO (1, 2, 3, 4, 5, 6 , 7 ), TIP
C!!!-------------------------------------------------------------------
         NWTRE = MASPRT(13)
         WRITE(NWTRE, 500) TIP, NEL
500      FORMAT(' *** ãOÉ. CÅOâ B FM0001: HOMEP TàèA HE OÅCãìÜàBAETCü **
     =*'/' *** HOMEP TàèA ', I10, ' ùãEMEHT HOMEP: ', I10, '***')
C!!!-------------------------------------------------------------------
         CALL SUBERR(1)
C######################################################################
C######################################################################
1        CONTINUE
C---> COèPOTàBãEHàE
         R = PAR0T(1)
         IF ( R .EQ. 0.0 ) GO TO 10
C---> áAèOMHàM èAPAMETPõ.
11       RMSW(1) = 1.0 / R
C---> ÑãàHA RMSW MOÑEãà
         LM = 1
         RETURN
10       WRITE(NWTR,501) NEL
501      FORMAT(' *** COèPOTàBãEHàE ùãEMEHTA ', I5, ' PABHO Hìãû ***'/
     =          ' *** èPàHàMAETCü PABHõM 1.0E-32 [OM]            ***')
         R = 1.0E-32
         GO TO 11
C######################################################################
2        CONTINUE
C----> àHÑìKTàBHOCTú
         L = PAR0T(1)
         IF ( L .EQ. 0.0 ) GO TO 20
C---> áAèOMHàM èAPAMETPõ.
21       RMSW(1) = L
         RMSW(2) = 0.0
         RMSW(3) = 0.0
C---> ÑãàHA RMSW MOÑEãà
         LM = 3
         RETURN
20       WRITE(NWTR, 521) NEL
521    FORMAT(' *** àHÑìKTàBHOCT ùãEMEHTA HOMEP ', I5, ' PABHA Hìãû ***'
     =   /    ' *** èPàHàMAETCü PABHOâ 1.0E-32 [ÉH]                 ***'
     =  )
         L = 1.0E-32
         GO TO 21
C######################################################################
3        CONTINUE
C--->  EMKOCTú
         C = PAR0T(1)
C---> áAèOMHàM èAPAMETPõ.
         RMSW(1) = C
         RMSW(2) = 0.0
         RMSW(3) = 0.0
C---> ÑãàHA RMSW MOÑEãà
         LM = 3
         RETURN
C######################################################################
4        CONTINUE
C----> àCTOóHàK èOCTOüHHOÉO TOKA.
         AJ = PAR0T(1)
C---> áAèOMHàM èAPAMETPõ.
         RMSW(1) = AJ
C---> ÑãàHA RMSW MOÑEãà
         LM = 1
         RETURN
C######################################################################
5        CONTINUE
C---->  àCTOóHàK èOCT. HAèP.
         R = PAR0T(1)
         E = PAR0T(2)
         IF ( R .EQ. 0.0 ) GO TO 50
C---> áAèOMHàM èAPAMETPõ.
51       RMSW(1) = 1.0 / R
         RMSW(2) =   E / R
C---> ÑãàHA RMSW MOÑEãà
         LM = 2
         RETURN
50       WRITE(NWTR,505) NEL
505      FORMAT(' *** BHìTPEHHE COèPOTàBãEHàE àCTOóHàKA HAèPüÜEHàü ***'/
     =          ' *** ùãEMEHTA HOMEP ', I10,  ' PABHO Hìãû         ***'/
     =          ' *** èPàHàMAETCü PABHõM 1.0E-32  [OM]             ***')
         R = 1.0E-32
         GO TO 51
C######################################################################
6        CONTINUE
C---> SIN àCT. HAèP.
         R = PAR0T(1)
         EM = PAR0T(2)
         OMEGA = PAR0T(3)
         FAZA = PAR0T(4) * 3.141592654 / 180.0
         IF ( R .EQ. 0.0 ) GO TO 60
C---> áAèOMHàM èAPAMETPõ.
61       RMSW(1) = 1.0 / R
         RMSW(2) = EM / R
         RMSW(3) = OMEGA
         RMSW(4) = FAZA
         RMSW(5) = 0.0
C---> ÑãàHA RMSW MOÑEãà
         LM = 5
         RETURN
60       WRITE (NWTR,505) NEL
         R = 1.0E-32
         GO TO 61
C######################################################################
7        CONTINUE
C---> SIN àCT. HAèPüÜEHàü (2)
         ER = PAR0T(1)
         EL = PAR0T(2)
         AEM = PAR0T(3)
         OMEGA = PAR0T(4)
         FAZA = PAR0T(5) * 3.141592654 / 180.0
         IF( ER .NE. 0.0  .OR.  EL .NE. 0.0 ) GO TO 70
         ER = 1.0E-32
         WRITE(NWTR,505) NEL
70       CONTINUE
C---> áAèOMHàM èAPAMETPõ.
         RMSW(1) = ER
         RMSW(2) = EL
         RMSW(3) = AEM
         RMSW(4) = OMEGA
         RMSW(5) = FAZA
         RMSW(6) = 0.0
         RMSW(7) = 0.0
C---> ÑãàHA RMSW MOÑEãà
         LM = 7
         RETURN
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
         END
