       SUBROUTINE FM0030(BA0T, KNOTT, PAR0T, RMSW, LM )
CXXX----KOMèãEKC "MS1" --> BEPCàü 1.1  (OT  MAPTA  1988 É.)------------
C   èOÑèPOÉPAMMA: FM0030(BA0T, KNOTT, PAR0T, RMSW, LM )
C   -------------
C   HAáHAóEHàE:  HACTPOâKA MAKPOMOÑEãEâ ãàHEâHõX ÑàHAMàóECKàX áBEHúEB:
C   ----------
C              +-----+-----------------------------------------------+
C              I     I                                   I  èEPEÑA-  I
C              I Tàè I       HAàMEHOBAHàE áBEHA          I  TOóHAü   I
C              I     I                                   I  îìHKñàü  I
C              I-----I-----------------------------------I-----------I
C              I     I  èPOèOPñàOHAãúHO-CìMMàPìûôEE      I           I
C              I 318 I       ( è - PEÉìãüTOP )           I     K     I
C              I     I                                   I           I
C              I-----I-----------------------------------I-----------I
C              I     I  èPOèOPñàOHAãúHõâ CìMMATOP        I           I
C              I 324 I       KBAÑPATOB                   I           I
C              I     I                                   I           I
C              I-----I-----------------------------------I-----------I
C              *******************************************************
C                èPàáHAK TIP # 4 -> ãOÉ. MAKPOMOÑEãú.
C                ( DM0035)
C                      îOPMàPìET "èEPEMEHHìû" óACTú RMSW OèàCAHàü
C                      ÑãàHA:  Tàè 318:==> +1(VAR)
C
C----------------------------------------------------------------------
C              ùãEMEHT OèàCõBAETCü:
C
C      ù # T 3XX ì 0 è
C              MAS < NNAPR  ìáH1 ìáK1 K1  ìáH2 ìáK2 K2  ... >
C              MAS < NGARM  W  A0  A1  FI1  A2  FI2... >
C
C      ÉÑE
C          NNAPR  -   KOãàóECTBO HAèPüÜEHàâ CXEMõ , KOTOPõE
C                     àCèOãúáìûTCü B KAóECTBE BXOÑHõX CàÉHAãOB;
C          ìáHI,ìáKI- HOMEPA ìáãOB, HAèPüÜEHàE MEÜÑì KOTOPõMà
C                     àCèOãúáìETCü B KAóECTBE BXOÑHOÉO CàÉHAãA;
C          KI       - KOùîîàñàEHT èPOèOPñàOHAãúHOCTà I-TOÉO
C                     HAèPüÜEHàü;
C          NGARM  -   KOãàóECTBO ùãEMEHTOB ÉAPMOHàóECKOÉO PüÑA
C                     OèàCõBAûôEÉO áAÑAHHõâ CàÉHAã, èOÑABAEMõâ
C                     HA BXOÑ PEÉìãüTOPA (C ìóETOM èOCT. COCTABã.);
C          W    -     óACTOTA OCHOBHOâ ÉAPMOHàKà ( Éñ );
C          A0,A1,...- AMèãàTìÑõ COOTBETBìûôàX ÉAPMOHàK CàÉHAãA;
C          FI1,FI2...-HAó. îAáõ COOTBETBìûôàX ÉAPMOHàK CàÉHAãA;
C----------------------------------------------------------------------
C
C   METOÑ:         PAáMETKA èOãEâ RMSW èOÑ MOÑEãú
C   -----
C
C   èAPAMETPõ:     BA0T, KNOTT, PAR0T - "OTPEáKà" àHîOPMAñàOHHõX
C  ----------      MACCOBOB BA0, KNOT, PAR0 ( CM. INPUT0 à GETMSW );
C                  RMSW - "èEPEMEHHAü" óACTú MSW ( "OTPEáOK" MSWALL );
C                  LM - ÑãàHA "èEPEMEHHOâ" óACTà RMSW èPà FGMSW = 0;
C                  LM - ÑãàHA BCEÉO MSW OèàCAHàü      èPà FGMSW = 1;
C
C   èOÑèPOÉPAMMõ:  1.COMMON PROF1
C   ------------
C
C   èPàMEóAHàE:    1. KOHTPOãú B MàHàMAãúHOM OÅ"EME;
C   -----------    2. BCE HE OèPEÑEãüEMõE èOãü RMSW áAHìãüûTCü;
C                  3. HàÜE èPàBOÑüTCü îOPMATõ RMSW:
C
C
C              îOPMAT RMSW Tàè # 318, #324:
C              ----------------------------
C+-----------I--------------I------I-----------------------------------
C  # CãOBA   I    # CãOBA B I KTO  I
C OT HAóAãA  I    OTPEáKE   IOèPEÑ.I
C BCEÉO MSW  I    RMSW B    I      I       OÅOáHAóEHàE - áHAóEHàE
C OèàCAHàü   I    FM0030    I      I
C------------I--------------I------I-----------------------------------
C     9      I     0        I      I HOMEP ìáãA ( BCEÉÑA 0 )
C----------------------------------------------------------------------
C    10      I     1        I  DM  I  FQ - îãAÉ HOBõE áHAó. BõóàCãEHõ
C            I              I      I   ( Ñãü CàHXPO. MAKPO. P.TIP # 4 )
C    11      I     2        I  FM  I  NNAPR-KOãàóECTBO HAèP., àCèOãú-
C            I              I      I        áìEMõX KAK BXOÑHõE CàÉHAãõ;
C    12      I     3        I  FM  I  ìáH1 - ìáEã HAóAãA;
C    13      I     4        I  FM  I  ìáK1 - ìáEã KOHñA;
C    14      I     5        I  FM  I  K1   - KOùîîàñàEHT èPOèOPñàOHAãú-
C            I              I      I         HOCTà HAèPüÜEHàü;
C  9+I*3     I     I*3      I  FM  I  ìáHI -      -"-
C 10+I*3     I   1+I*3      I  FM  I  ìáKI -      -"-
C 11+I*3     I   2+I*3      I  FM  I  KI   -      -"-
C .......    I   .......    I  ... I  ..........................
C12+NNAPR*3  I  3+NBXOD*3   I  FM  I  NGARM -KOãàóECTBO ÉAPMOHàK, àCè.
C            I              I      I         Ñãü OèàCAHàü áAÑ. CàÉHAãA
C            I              I      I         (C ìóETOM èOCT. COCTABã.);
C 13+NNAPR*3 I  4+NNAPR*3   I  FM  I  W  -   óACTOTA OCH. ÉAPMOHàKà(Éñ);
C 14+NNAPR*3 I  5+NNAPR*3   I  FM  I  A0  -  AMèãàTìÑA èOCT. COCTABãü-
C            I              I      I         ûôEâ áAÑ. CàÉHAãA;
C 15+NNAPR*3 I  6+NNAPR*3   I  FM  I  A1  -  AMèãàTìÑA 1-Oâ ÉAPMOHàKà
C            I              I      I         áAÑAHHOÉO CàÉHAãA;
C 16+NNAPR*3 I  7+NNAPR*3   I  FM  I  FI1 -  HAó. îAáA 1-Oâ ÉAPMOHàKà;
C 17+NNAPR*3 I  8+NNAPR*3   I  FM  I  A2  -  AMèãàTìÑA 2-Oâ ÉAPMOHàKà;
C 18+NNAPR*3 I  9+NNAPR*3   I  FM  I  FI2 -  HAó. îAáA 2-Oâ ÉAPMOHàKà;
C .......    I   .......    I  ... I  ..........................
C----------------------------------------------------------------------
C
C  OÅôAü ÑãàHA MSW --> LM<BCü> = 12 + 3*NNAPR + 2*NGARM
C
C  ÑãàHA èEPEMEH. óACTà --> LM<RMSW> = 3 + 3*NNAPR + 2*NGARM
C
CZZZ-------------------------------------------------------------------
       COMMON /PROF1/ MASPRT(200)
       DIMENSION BA0T(*), KNOTT(*), PAR0T(*), RMSW(*)
       EQUIVALENCE( NWTR, MASPRT(13) )
       EQUIVALENCE( NWTRE, MASPRT(14) )
       EQUIVALENCE( FGMSW, MASPRT(87) )
       EQUIVALENCE( NMKNOT,MASPRT(7) )
       EQUIVALENCE ( RN  ,   N  )
       INTEGER  TIP, BA0T, FGMSW
       NEL = BA0T(1)
       TIP = BA0T(2)
       NTIP= TIP - 317
       IF ( NTIP .EQ. 1 ) GO TO 1
       IF ( NTIP .EQ. 7 ) GO TO 1
C!!!-------------------------------------------------------------------
       WRITE(NWTRE, 501 ) NEL, TIP
501    FORMAT(/' *** ãOÉ. CÅOâ B FM0030 --> HOMEP TàèA HE HAò ***'/
     =  ' *** HOMEP ùãEMEHTA ', I5, ' HOMEP TàèA ', I5, ' ***'/)
C!!!-------------------------------------------------------------------
       CALL SUBERR(TIP)
C######################################################################
1      CONTINUE
       GO TO (100),NTIP
C----------------------------------------------------------------------
C---> èPOèOPñàOHAãúHO CìMMàPìûôEE áBEHO   ( Tàè  # 318 )
C---> èPOèOPñàOHAãúHõâ CìMMATOP KBAÑPATOB ( Tàè  # 324 )
C----------------------------------------------------------------------
100   CONTINUE
C--> OèPEÑEãEHàE KOHCTAHT
       NNAPR = 0
       IF( PAR0T(2) .GT. 0.0 ) NNAPR = IFIX ( PAR0T(2) )
       INGARM = 4 + 3*NNAPR
       NGARM  = 0
       IF( PAR0T(INGARM) .GT. 0.0 ) NGARM = IFIX ( PAR0T(INGARM) )
       IF ( FGMSW .EQ. 0 ) GO TO 1000
C----------------------------------------------------------------------
C-->  ìTOóHàTú LM <OÅôìû >
       LM = 12 + 3*NNAPR + 2*NGARM
       RETURN
C######################################################################
1000   CONTINUE
C-->  èPàHüTú à óTO MOÜHO CîOPMàPOBATú..
       LM = 3 + 3*NNAPR + 2*NGARM
       DO 2 I=1,LM
2      RMSW(I) = 0.0
C---> èPOBEPàM  èPABàãúHO ãà BBEÑEHõ ÑAHHõE?
       NNAPR1 = (IFIX ( PAR0T(1) ) - 1 ) / 3
       IF ( NNAPR .EQ. NNAPR1 ) GO TO 3
C!!!-------------------------------------------------------------------
       WRITE(NWTRE, 502 ) NEL, TIP
502    FORMAT(/' *** OòàÅKA B FM0030 -->HEèPABàãúHO áAÑAHO KOãàóECTBO BX
     =OÑOB***'/' *** HOMEP ùãEMEHTA ', I5, ' HOMEP TàèA ', I5, ' ***'/)
C!!!-------------------------------------------------------------------
       CALL SUBERR(TIP)
3      CONTINUE
       NGARM1 = (IFIX( PAR0T(INGARM-1) ) - 1) / 2
       IF ( NGARM .EQ. NGARM1 ) GO TO 4
C!!!-------------------------------------------------------------------
       WRITE(NWTRE, 503 ) NEL, TIP
503    FORMAT(/' *** OòàÅKA B FM0030 -->HEèPABàãúHO áAÑAHO KOã-BO ÉAPMOH
     =àK  ***'/' *** HOMEP ùãEMEHTA ', I5, ' HOMEP TàèA ', I5, ' ***'/)
C!!!-------------------------------------------------------------------
       CALL SUBERR(TIP)
4      CONTINUE
C----------------------------------------------------------------------
C---->  áAèOMHàM HOMEPA ìáãOB.
       N = NNAPR
       RMSW(2) = RN
       IPAR0T = 2
       IRMSW = 2
       IF( NNAPR .EQ. 0 ) GO TO 50000
          DO 5 I = 1 , NNAPR
          IPAR0T = IPAR0T + 1
          IRMSW = IRMSW + 1
          NYZN  = IFIX ( PAR0T(IPAR0T) )
          IF( NYZN .LT. 0 .OR. NYZN .GT. NMKNOT ) GO TO 9999
          N = NYZN
          RMSW(IRMSW) = RN
          IPAR0T = IPAR0T + 1
          IRMSW = IRMSW + 1
          NYZK = IFIX ( PAR0T(IPAR0T) )
          IF( NYZK .LT. 0 .OR. NYZK .GT. NMKNOT ) GO TO 9999
          N = NYZK
          RMSW(IRMSW) = RN
          IPAR0T = IPAR0T + 1
          IRMSW = IRMSW + 1
          RMSW(IRMSW) =  PAR0T(IPAR0T)
5      CONTINUE
50000  CONTINUE
C----------------------------------------------------------------------
C---->  áAèOMHàM AMèãàTìÑõ à îAáõ ÉAPMOHàK ----------------------------
       IPAR0T = IPAR0T + 2
       IRMSW = IRMSW + 1
       N = NGARM
       RMSW(IRMSW) = RN
       IF( NGARM .EQ. 0 ) GO TO 60000
       IPAR0T = IPAR0T + 1
       IRMSW = IRMSW + 1
       RMSW(IRMSW) = PAR0T(IPAR0T)
       IPAR0T = IPAR0T + 1
       IRMSW = IRMSW + 1
       RMSW(IRMSW) = PAR0T(IPAR0T)
       I1 = NGARM-1
       IF( I1 .LT. 1 ) GO TO 7
          DO 6 I = 1 , I1
          IPAR0T = IPAR0T + 1
          IRMSW = IRMSW + 1
          RMSW(IRMSW) = PAR0T(IPAR0T)
          IPAR0T = IPAR0T + 1
          IRMSW = IRMSW + 1
          RMSW(IRMSW) = PAR0T(IPAR0T) * 3.1416 / 180.
6      CONTINUE
60000  CONTINUE
7      CONTINUE
       RETURN
C######################################################################
9999   CONTINUE
C!!!-------------------------------------------------------------------
       WRITE(NWTRE, 504 ) NEL, TIP
504    FORMAT(/' *** OòàÅKA B FM0030 -->HEèPABàãúHO áAÑAHõ BXOÑHõE ÑAHHõ
     =E   ***'/' *** HA BXOÑ ùãEMEHTA ', I5, ' HOMEP TàèA ', I5,' ***'/
     =         ' *** èOÑAETCü HAèPüÜEHàE C HECìôECTBìûôàX ìáãOB
     =    *** ')
C!!!-------------------------------------------------------------------
       CALL SUBERR(TIP)
C######################################################################
       RETURN
       END
