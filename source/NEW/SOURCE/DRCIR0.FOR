         SUBROUTINE DRCIR0( KAR, DAT, BA0, KNOT, PAR0, IRC )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C   OPOPAMMA:   DRCIR0( KAR, DAT, BA0, KNOT, PAR0, IRC )
C   ------------
C   HAHAEHE:    *** OPAOTK #E:
C  ------------       #E  N
C
C                  N - HOMEP KAHAA BBOA HOPMA;
C
C                  P N "OEHO"  "OOHO" CTAHABBAETC
C                  PABHM NRDR KAHA;
C
C                  OPMAPET MACCB BA0, KNOT, PAR0
C                  ( 1- ACT EPKTB #E )
C   METO:         CM. / INPUT0,INPUT2
C   -----
C   APAMETP:     KAR - CMBOHA CTPOKA EPKTB,
C   ---------      DAT - MACCB CE EPKTB;
C                  IRC = 1  MACCB BA0, KNOT, PAR0 OPEEEH;
C                      = 2  HOPMA HE PHTA;
C                  P. AP. CM. INPUT0,INPUT2
C
C   OPOPAMM:  1. COMMON PROF1
C   -------------  2. INPUT0  INPUT2   PPNCOM  READST
C   PMEAHE:    1. B CAE "ATAHX" OOK - STOP 666
C   ----------        ( KOHE CCTEMHOO KAHKA NRDR )
C                  2. OPOHEE CM. INPUT0,INPUT2
C                  3. MACCBA BA0, KNOT, PAR0 - HPOBAHH;
C
CZZZ-------------------------------------------------------------------
         COMMON/PROF1/ MASPRT(200)
         DIMENSION BA0(*), PAR0(*), KNOT(*), KAR(*), DAT(*), DSNAME(11)
         EXTERNAL READST
         INTEGER BA0, FMSWAL, DIAL
         EQUIVALENCE ( MASPRT(13),  NWTR )
         EQUIVALENCE ( MASPRT(14),  NWTRE )
         EQUIVALENCE ( MASPRT(74),  FMSWAL )
         EQUIVALENCE ( MASPRT(12),  NRDR   )
         EQUIVALENCE ( MASPRT(15),  DIAL   )
         DATA DSNAME/ 11*'    '/
C-->  KCA KAATEE
         IBA01 = BA0(3)
         IKNOT1 = KNOT(3)
         IPAR01 = IFIX (PAR0(3))
C-->  C KAKOO KAHAA APOC BBOA  #E:
         NRDR1 = NRDR
         IF ( DAT(1) .EQ. 0.0 ) GO TO 1
C--> TO-TO ECT
         NRDR1 = IFIX( DAT(2) )
C--> KOHTPO
         IF ( NRDR1 .LE. 0  .OR. NRDR1. GT. 100 .OR.
     =  NRDR1 .EQ. NWTR  .OR. NRDR1 .EQ. NWTRE ) NRDR1 = NRDR
C--> COOM..
1        WRITE(NWTR, 50 ) NRDR1
50     FORMAT(/' *** #E ਭ:==> ᠭ 楯  १ ',
     = ' # ',I2, ' ***'/)
         IRC = 1
C---> HAEATAEM.
       CALL PPNCOM(3,NWTR)
C######################################################################
C--->  HAHAEM BBOT AHHE
         ii_rr = 0
         IF ( NRDR1 .NE. NRDR ) CALL KSOPEN(NRDR1,0,ii_rr)
         IF ( ii_rr .NE. 0 )  STOP 666
C----------------------------------------------------------------------
         CALL INPUT0( BA0, KNOT, PAR0, NRDR1, DSNAME, READST,  III )
         IF ( NRDR1 .NE. NRDR ) CLOSE (NRDR1)
C--->EC #CPOC  TO-TO HOPPOBA, TO BMO "PEXA"...
         IF ( III .EQ. 1  .OR. III .EQ. 2 ) IRC = 2
         IF ( IRC .EQ. 2 ) RETURN
C--> A MOET TO "CE"
         IF ( III .EQ. 3 ) GO TO 9999
C--> A MOET OEHA EPKTBA #MEX
         IF ( III .EQ. 4 ) GO TO 2
         RETURN
C######################################################################
C  OPAOTK
C  OEPKTB        METKA 2
C  #MEX
C----------------------------------------------------------------------
2       CONTINUE
        IF( BA0(3) .NE. IBA01 .OR. KNOT(3) .NE. IKNOT1 .OR.
     *      IFIX(PAR0(3)) .NE. IPAR01  ) GO TO 5
        IF( DIAL .EQ. 0 ) WRITE(NWTR,9995)
9995   FORMAT(/20X,
     *         ' *** MOEPEMA CCTEMA HE COEPT EKTPECKO',
     *         ' E ***'/)
        IF( DIAL .EQ. 1 ) WRITE(NWTR,9996)
9996   FORMAT(/10X,
     *         ' *** MOEPEMA CCTEMA HE COEPT EKTPECKO',
     *         ' E ***'/)
5      CONTINUE
C----------------------------------------------------------------------
C-->  BBOM AE
C!!!     IF ( NRDR1 .NE. NRDR ) CALL KSOPEN(NRDR1,0,ii_rr)
C!!!     CALL INPUT2( BA0, KNOT, PAR0, NRDR1,  READST,  III )
C!!!     IF ( NRDR1 .NE. NRDR ) CLOSE (NRDR1)
C--->EC #CPOC  TO-TO HOPPOBA, TO BMO "PEXA"...
         IF ( III .EQ. 1  .OR. III .EQ. 2 ) IRC = 2
         IF ( IRC .EQ. 2 ) RETURN
C--> A MOET TO "CE"
         IF ( III .EQ. 3 ) GO TO 9999
         RETURN
C######################################################################
C     KOHE BXOHOO HAOPA
C---> KOHAEM....
9999    CONTINUE
        WRITE(NWTR,51)
51     FORMAT(//' *** PAOTA PEPBAETC - KAHA CCTEMHOO BBOA HEOCT
     =EH ***'//)
         STOP 666
         END
