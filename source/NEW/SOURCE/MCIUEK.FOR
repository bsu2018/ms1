       INTEGER FUNCTION MCIUEK( TN, H0, HX, F1, F2, TS, DTAU )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C   OPOPAMMA_HK:  MCIUEK( TN, H0, HX, F1, F2, TS, DTAU )
C   --------------------
C   HAHAEHE:  "EHEPATOP" - "BEPKATOP" MCOB PABEH C:
C   ----------
C               BAPAHT "ECTECTBEHHA KOMMTA" ( EK ):
C               -----------------------------------------
C
C  PABEHE AAETC:
C  -------------------
C
C  F1(T) - OOPHOE HAPEHE ( MOPEMOE ) -> BHEH HK;
C  F2(T) - HAPEHE PABEH ( MOPEE ) -> BHE. H-;
C               OOHAEH:
C               ------------
C   DF12(T) :=: F1(T) - F2(T)
C   MCIUEK := (HAEHE HK) --> "AH MCA PABEH:
C
C            = 00 -->  HA [TN, TN+H0] MCA HET;
C            = 01 -->  HA [TN, TN+H0] MC OBC;
C            = 11 -->  HA [TN, TN+H0] MC HE CEA;
C            = 10 -->  HA [TN, TN+H0] MC CE;
C
C   ( M1,M2 ) -->  B AOPTME COOTBETCTBT TM AHHM;
C
C   DTAU - TEHOCT MCA;
C   TN -  BPEM HAAA N- TOK;
C   H0 - A, OPEE CE. BPEMEHH TOK;
C   TN1 = TN + H0;
C   HX - A OT TN  O  TX MOMEHTA BPEMEH, E
C   TX - BPEM CMEH COCTOH MCA;
C   TS - MOMEHT BPEMEH OEPEHOO "ACKA" MCA C;
C
C !!!!! P EPBOM OPAEH K MCIUEK --> AAT TS = -2*DTAU !!!!!!!!!!
C
C   METO:  KOHTPO ACK/CHTE MCA C O CE. AOPTM:
C   -----   A) P DF12(TN) <= 0.0  DF12(TN+H0) >= 0.0
C              C ACKAETC, TS KCPETC, HX OPEEETC;
C           B) P (TN+H0) > (TS+DTAU) --> MC CHMAETC,
C              HX OPEEETC;
C   APAMETP: TN - BPEM OPEEEH CHAA;
C   ---------  H0 - OKPECHOCT OPEEEH CHAA;
C              HX - A OT TN O TX - BPEMEH POXOEH OEPEHOO
C                   POHTA MCA;
C              F1, F2 - BHEHE HK OOPHOO  PABEO
C                       CHAOB;
C              TS - PAHEEE OPEEEHH MOMEHT BPEMEH CTAPTA MCA;
C              DTAU - AAHHA TEHOCT MCA;
C
C
C  HAEHE HK:  MCIUEK = 00  --> "C" HET B [TN, TN+H0];
C  ****************                     HX = 0.0;
C                     MCIUEK = 01  --> B [TN, TN+H0] -> EPEH POHT
C                                      MCA "C", HX = HTEPBA OT
C                                      TN O EPEHEO POHTA "C";
C                     MCIUEK = 10 -->  B [TN, TN+H0] -> AH POHT
C                                      MCA "C", HX = HTEPBA
C                                      OT TN O AHEO POHTA MCA;
C                     MCIUEK = 11 -->  B [TN, TN+H0] "C" BKEH,
C                                      COCTOHE HE MEH, HX=0.0;
C
C                !!!!!  P H0 > TIMP --->  BOMOHA OPEP "C" !!!!!
C                      PEOOAETC, TO H0 < TIMP
C
C
C
C   OPOPAMM:  F1     F2  -  BHEHE, AAHHE P BOBE;
C   ------------
C   PMEAHE:
C   ----------
CZZZ-------------------------------------------------------------------
       EXTERNAL F1, F2
C-->  BPEM KOHA...
       TK = TS + DTAU
C-->  BPEM C. TOK
       TN1 = TN + H0
C-->  HX -->  CTAHAPTHO = 0.0
       HX = 0.0
C   A) ----------------------------------------------------------------
C-->  OCTPOEHE [M1, M2]-->
       M1 = 0
       IF ( TS .LE. TN  .AND.  TN .LE. TK ) GO TO 1
C   B) ----------------------------------------------------------------
C-->  AHA MEHEH ( M1=0 ), OCK M2 = ?
C--->  ACK CIU BOMOEH ?
       DF12N = F1(TN) - F2(TN)
       DF12N1 = F1(TN1) - F2(TN1)
       IF ( DF12N .LE. 0.0  .AND. DF12N1 .GE. 0.0 ) GO TO 2
C---> COCTOHE HE MEHOC, M2 = 0, ACKA C HET...
       MCIUEK = 00
       RETURN
C======================================================================
2      CONTINUE
C-->  ACK C ECT(M1=0, M2=1), KOA ?
       HX = -H0 * ( DF12N / (DF12N1 - DF12N) )
C-->  TS HOBOE...
       TS = TN + HX
       MCIUEK = 01
       RETURN
C======================================================================
1      CONTINUE
C--> M1=1, HAT M2 = ?
       IF ( TN1 .LE. TK ) GO TO 3
C-->  MC CHMAETC...  HA [TN, TN+H0], KOA  ?
       HX = TK - TN
       MCIUEK = 10
       RETURN
C======================================================================
3      CONTINUE
C-->  M1     M2  = 1, MEHEH HET, MC OAH...
       MCIUEK = 11
       RETURN
       END
