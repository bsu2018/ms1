         SUBROUTINE GETDAD(KAR, DAT, IRC )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C   OPOPAMMA:   GETDAD(KAR, DAT, IRC )
C   -------------
C
C   HAHAEHE:    EPEBO AHHX CMBOHO CTPOK PEKTB KAR BO
C   ----------     BHTPEHHEE PECTABEHE (REAL*4) --> MACCB DAT;
C                  ** ABTOMATECK BXO HA HAAO PAOPA AC
C                     O CAX PEKTB: HAAO PAOPA - OT EPBOO
C                     POEA OCE TEKCTA PEKTB ***
C
C   METO:         CKAHPOBAHE KAR  PEM CE.
C   -----
C
C   APAMETP:     KAR - MACCB CTPOK PEKTB;
C   ---------      DAT - MACCB HTX CE (REAL*4):
C                   PAMEPHOCT = 21 COBO, B DAT(1) - KOECTBO,
C                   ATEM  -  PHTE CA;
C                  IRC = 1  -  AHHE PHT,
C                      = 2  -   OK P PEME CE;
C
C   OPOPAMM:  1. COMMON PROF1
C   -------------  2. MSGOUT, APFTRT, APFSQE, SUBEROR
C
C   PMEAHE:    1. CTPOKA POEOB - OCTMA;
C   ----------     2. MACCOB DAT - CTTC HM;
C                  3. P OKAX - EAT COOEH;
C                  4. PAETE "," BETC OCTMM;
C                  5. P OKE - B DAT AC 0.0;
C                  6. AC: <NNN,,NNN> <NNN,0,NNN> KBBAEHTH;
C                  7. KOHE MOHO OTMEAT CMBOOM ";" ;
CZZZ-------------------------------------------------------------------
         COMMON/PROF1/ MASPRT(200)
         EQUIVALENCE ( NWTR, MASPRT(13) )
         EQUIVALENCE ( NWTRE, MASPRT(14) )
         EQUIVALENCE ( DIAL,  MASPRT(15) )
         EQUIVALENCE ( NRDR,  MASPRT(12) )
         DIMENSION DAT(1), KAR(1), ER(80), FKAR(80), MSG(20)
         INTEGER DIAL, PRT90, ER, BLANK, COMA, FKAR, DIEZ, TERM
         DATA K72/72/, K21/21/
         DATA BLANK/' '/, COMA/','/, LGOPA/'$'/, DIEZ/'#'/, TERM/';'/
C--> BXO HA HAAO PAOPA
         DO 67 I = 1, K72
         IK = I
         IF ( KAR(I) .EQ. BLANK ) GO TO 68
67       CONTINUE
C--> POEOB B CTPOKE HET.....
         IK = K72 + 1
68       CONTINUE
C!!!-------------------------------------------------------------------
C      WRITE(6,6660) IK, (KAR(IZ),IZ=1,K72)
C660   FORMAT(' *** IK =', I5, ' ***'/1X, 80A1 )
C!!--------------------------------------------------------------------
66       CONTINUE
C--->  OCTKA...
         DO 1 I = 1, 80
1        ER(I) = BLANK
         MSG(1) = 0
         IER = 0
         PRT90 = 0
         DO 2 I=1,K21
2        DAT(I) = 0.0
C--->  APAEH MACCB...
C!!!-------------------------------------------------------------------
C      WRITE(6,6660) IK , (KAR(IZ), IZ=1,K72)
C!!!-------------------------------------------------------------------
         CALL APF TRT( 1, K72, KAR, FKAR )
C!!!-------------------------------------------------------------------
C      WRITE(6,6660) IK , (KAR(IZ), IZ=1,K72)
C!!!-------------------------------------------------------------------
C--->  OCK...
         IRC = 1
3        CONTINUE
         IF ( IK .GT. K72 ) GO TO 666
         IF ( KAR(IK) .NE. BLANK ) GO TO 10
30       CONTINUE
C--> HE KOHT  HAM..
         IF ( KAR(IK) .EQ. TERM ) GO TO 666
         IK = IK + 1
         GO TO 3
C---
10       CONTINUE
C!!!-------------------------------------------------------------------
C      WRITE(6,6660) IK , (KAR(IZ), IZ=1,K72)
C!!!-------------------------------------------------------------------
C--> TO-TO  HA:
         N2 = K72 - IK + 1
         CALL APF SQE( FKAR, E0, IK, N2,  IFE )
         GO TO ( 11, 12, 13, 4, 4, 3 ), IFE
4        CALL SUBERR(IFE)
11       CONTINUE
C--> OCEHEE CO
         ID = DAT(1) + 1
         IF ( (ID+1) .GT. K21 ) CALL SUBERR( ID   )
         DAT(ID+1) = E0
         DAT(1) = ID
         GO TO 666
C######################################################################
12       CONTINUE
C!!!-------------------------------------------------------------------
C      WRITE(6,6660) IK , (KAR(IZ), IZ=1,K72)
C!!!-------------------------------------------------------------------
C-->  HE PA
         IF ( KAR(IK) .EQ. BLANK .OR. KAR(IK) .EQ. COMA ) GO TO 120
         IF ( KAR(IK) .EQ. TERM ) GO TO 120
C--> KOHE OXO
         IRC = 2
         DAT(1) = DAT(1) + 1.0
         ER(IK) = LGOPA
         IER = IER + 1
         I = MSG(1)
         MSG(I+2) = 3
         MSG(1) = I+1
121      CONTINUE
C--- K HOPPOBAH::::
         IK = IK + 1
         IF ( KAR(IK) .EQ. BLANK .OR. KAR(IK) .EQ. COMA ) GO TO 30
         IF ( KAR(IK) .EQ. TERM ) GO TO 666
         IF ( IK .GT. K72 ) GO TO 666
         GO TO 121
120      CONTINUE
C--> PHT CO...
         ID = DAT(1) + 1
         IF ( (ID+1) .GT. K21 ) CALL SUBERR( ID )
         DAT(ID+1) = E0
         DAT(1) = ID
C-->  HA HOBOE
         GO TO 30
C######################################################################
13       CONTINUE
C--> EPEOHEHE
         IRC = 2
         DAT(1) = DAT(1) + 1.0
         ER(IK) = LGOPA
         IER = IER + 1
         I = MSG(1)
         MSG(I+2) = 2
         MSG(1) = I+1
         GO TO 121
C######################################################################
C  BCE
C######################################################################
666      CONTINUE
C!!!-------------------------------------------------------------------
C        WRITE(NWTRE, 50 ) ( I, DAT(I), I=1,K21)
C0       FORMAT( 5(2X,'DAT(', I2,')=', G12.5 ) )
C!!!-------------------------------------------------------------------
         IF ( IER .EQ. 0 ) RETURN
C--->EAT OOK
         IF ( DIAL .EQ. 1 ) WRITE(NWTR, 1003) ( ER(I), I=1,80)
1003     FORMAT(80A1/' *** AHHE HOPPTC - PEOOAETC',
     = ' OTCTCTBE CA ***')
         IF ( DIAL .EQ. 0 ) WRITE(NWTR,1004) IER,(ER(I), I=1,80 )
1004     FORMAT(1X,'*** OOK ',I2,' ***=>',80A1/' *** AHHE HOPP
     =TC - PEOOAETC OTCTCTBE CA ***')
         CALL MSGOUT(MSG)
         IF ( DIAL .EQ. 0 ) RETURN
         WRITE(NWTR, 51)
51       FORMAT(' *** BBOTE TOKO AHHE PEKTB  # ***')
         READ(NRDR,52, END=53  )  ( KAR(I), I=1,80)
52       FORMAT(80A1)
         IRC = 1
         IK = 1
         IF ( KAR(1) .EQ. DIEZ ) RETURN
C--->  OPOEM C HAAA....
         GO TO 66
C----------------------------------------------------------------------
53       CONTINUE
         WRITE( NWTR, 54 ) NRDR
54       FORMAT(/' *** KOHE AA HA KAHAE NRDR = ', I2,
     = ' ***'/ ' *** PAOTA PEPBAETC [ SEQDAT ] ***'/)
         CALL SUBERR(0)
         RETURN
         END
