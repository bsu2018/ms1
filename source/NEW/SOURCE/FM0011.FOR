       SUBROUTINE FM0011( BA0T, KNOTT, PAR0T, RMSW, LM )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C   OPOPAMMA: FM0011( BA0T, KNOTT, PAR0T, RMSW, LM )
C   ------------
C   HAHAEHE:        HACTPOKA MAKPOMOE # TA 50:
C  ------------  BOTE HE-3_0 (  . MA. 3X3X0 )
C                ********************************************
C                POHAK TA #6, BEHTH PEOPA. ACTOT;
C
C              EMEHT OCBAETC:
C
C    3 T 50  KA KB KC KRA KRB KRC
C    T_BK  DTCIU #_TA_PETOPA_BOEH<EHEPATOP
C                                                PABEO
C                                                HAPEH>
C            KXA  KXB  KXC  EYYV  EYYI;
C     E:
C
C              KA, KB, KC  -  TAEO 3-X AHOO HAPEH;
C              KRA, KRB, KRC -  POTOPHO OMOTK . MAH ->
C                              BXOHOE HAPEHE PEOPAOBATE
C                              ACTOT;
C              DTCIU - TEHOCT MCA "C" -> [ B . PACAX ]
C                      MC EHEPPTC COACHO CPABHEH
C                      HAP. OOPHOO -> BPAEMOO  MACCBA
C                      TOKN/TOKN1 EMEHTA #_._PE._BO.
C                      ( TP EPBE COBA )  HAPEH TAH
C                      PEOPAOBATE, T.E. HA AX KA, KB, KC;
C                      ( CM. DM0015 )
C              #_.BO. - MOE OPEEEH HAPEH PABEH:
C                         ( T #40, T # 63, T # 13 );
C                         ###############################
C                      KXA, KXB, KXC -  "OOPHO" CCTEM
C                                      HAPEH AA: "A", "B", "C";
C         EYYV - OPAHEHE P. CHAA P BPMTEHOM PEME,
C         EYYI - OPAHEHE P. CHAA P HBEPCHOM      PEME;
C
C === BBOHE HAEH: I1, I2, I3, I4, I5, I6, - TOK BHE. BBOOB,
C                        IV1, IV2, ..., IV18,    - TOK BEHTE,
C                        CIU1, CIU2, ..., CIU18 - "C" HA BEHTE;
C
C
C   METO:       PAMETKA OE, AAHE CX_BEHT = 0( APET    );
C   -----
C   APAMETP:    BA0T, KNOTT, PAR0T - "OTPEKA" MACCBOB CX. H.
C   ---------
C                RMSW - "EPEMEHA" ACT MSW_EMEHTA,
C                LM - EE HA B COBAX;
C   OPOPAMM:   HET
C   ------------
C   PMEAHE:  1. KOHTPO HE PEAOBAH;
C  -----------      !!!  KOHTPOPETC TOKO "OAAHE" HOMEPOB
C                        OB KXA, KXB, KXC B AAOH OT 0 O
C                        MAKCMAHO AAHHOO ( NMKNOT )
C                   !!!                H A  E  --->  STOP 20
C                                                      -------
C                2.  OKOHATEHO HACTPOK ->
C                    CT LM_MOHTOP "LM0002";
C              OPMAT MSW # TA 50 [ BOTE, HE ]:
C              -------------------------------------------
C               "OCTOHHA" ACT
C               ******************
C
C  +-------+--------+--------+--------+------+------+--------+----+
C  I HOMEP I HOMEP  I HOMEP  I  P. I KO I KO. I AP.   I PE I
C  I EME I TA   I /    I TA   I ECT I BB. I HA.  I E I
C  I HTA   I MOE I PACETAI (PE.) I BO   I HA I "TOKN" I PB I
C  I       I        I DM.....I       .I OBI EH.I "TOKN1"I    I
C  +-------+--------+--------+--------+------+------+--------+----+
C  I  1    I   2    I   3    I    4   I   5  I  6   I   7    I 8  I
C  +-------+--------+--------+--------+------+------+--------+----+
C
C
C              EPEMEHHA ACT MSW:
C              *********************
C
C  COBO     COBO     OOHAEH  OECKOE HAEHE
C  OT        OT
C  HAAA    EPEMEH.
C  MSW       ACT
C
C  9,10,11    -        KA, KB, KC, - HOMEPA OB A "TAH"
C  12,13,14   -        KRA< KRB, KRC - HOMEPA OB BXOHOO
C                                      HAPEH HE-3_0
C-- -- - - - - --- - - - - - - - -
C   15         1       [F] NPB - HOMEP EMEHTA, OCTABEO
C                                HAPEHE PABEH;
C  16          2       [L] ANPB - APEC B MSW_ALL NPB EMEHTA;
C  17          3       [L] AUYP - APEC B TOKN/N1 NPB EMEHTA;
C  18          4       [F] TBKL - BPEM BK. HE;
C  19          5       [F] DTCIU - T. MCA "C"
C 20, 21     6, 7      [F] EYYV,  EYYI;
C  22         8             "HX"  KE K.. OB;
C 23<->25    9<->11  [F]     HOMEPA "OOPHX" OB;
C 26<->29    12<->15          PEEPB;
C
C 30<->39    16<->25      MSWV1  -  COBO PABEH 1-M BEHTEM
C 40<->49    26<->35      MSWV2  -  COBO PABEH 2-M BEHTEM
C .....................................................................
C 200<->209   186<->195   MSWV18 -  COBO PABEH 18-M BEHTEM
C**********************************************************************
C
C   LM OA = 209 COB, LM_OK. = 195
C
C       OPMAT MSWV_EHT  DM00B9:
C       -------------------------------
C
C      COBO                   HAEHE
C
C      1       KD - KO COCTOH: =0 - AKPT, =1 - OTKPT;
C      2       HX - A OT TN, BOMOHOE BPEM EPEKEH;
C
C ( B [*] HOMEPA MSW_VEHT  / "MCIU50" )
C
C  [1] 3       TS - BPEM CTAPTA MCA( "E" KOMMTA );
C  [2] 4       TK - BPEM HA MCA( "E" KOMMTA );
C  [3] 5       CX - KO PAPEEH/APETA "C":
C                   =0 - C APEEHO OABAT HA BEHT,
C                   =1 - C PAPEEHO OABAT HA BEHT;
C [4] 6        TX - BPEM, C KOTOPOO ECTBET KO "CX";
C
C
C [5] 7        MCIU - KO MCA --->
C                     MCIU   = 00  --> "C" HET B [TN, TN+H0];
C                                       HXCIU = 0.0;
C                     MCIU   = 01  --> B [TN, TN+H0] -> EPEH POHT
C                                   MCA "C", HXCIU = HTEPBA OT
C                                      TN O EPEHEO POHTA "C";
C                     MCIU   = 10 -->  B [TN, TN+H0] -> AH POHT
C                                   MCA "C", HXCIU = HTEPBA
C                                      OT TN O AHEO POHTA MCA;
C                     MCIU   = 11 -->  B [TN, TN+H0] "C" BKEH,
C                                      COCTOHE HE MEH, HXCIU=0.0;
C
C
C [6] 8        HXCIU - A OT TN, O OEPEHOO POHTA "C";
C (---)
C     9              - A KD COCTOH;
C    10              - PEEPB
C********************************************************************
C
C
CZZZ-------------------------------------------------------------------
       COMMON /PROF1/ MASPRT(200)
       DIMENSION BA0T(*), KNOTT(*), PAR0T(*), RMSW(*)
       EQUIVALENCE( NWTR, MASPRT(13) )
       EQUIVALENCE( NWTRE, MASPRT(14) )
       EQUIVALENCE( FGMSW, MASPRT(87) )
       EQUIVALENCE( NMKNOT, MASPRT(7) )
       EQUIVALENCE( RK,  K )
       EQUIVALENCE ( NPB, RNPB   )
       EQUIVALENCE ( ID1, D1        )
       INTEGER NPB, TIP, BA0T
C
       DATA ID1 / 1 /
C
       TIP = BA0T(2)
       NEL = BA0T(1)
       IF ( TIP .EQ. 50 ) GO TO 1
C!!!-------------------------------------------------------------------
       WRITE(NWTRE, 501 ) NEL, TIP
501    FORMAT(/' *** O. CO B FM0011 --> HOMEP TA HE HA ***'/
     =  ' *** HOMEP EMEHTA ', I5, ' HOMEP TA ', I5, ' ***'/)
C!!!-------------------------------------------------------------------
       CALL SUBERR(TIP)
C######################################################################
C-->
C  PAR0T -> TBKL, TCIU, NPB, KXA, KXB, KXC, EYYV, EYYI
C            1     2     3    4    5    6    7     8
C######################################################################
1      CONTINUE
C-->  PHT  TO MOHO COPMPOBAT..
       LM = 195
C      *********
       DO 2 I=1,LM
2      RMSW(I) = 0.0
C
       TBKL = PAR0T(1)
       RMSW(4) = TBKL
C
       NPB = IFIX( PAR0T(3) )
       RMSW(1) = RNPB
C
       DTCIU = PAR0T(2) / 1.8E+4
       RMSW(5) = DTCIU
C
       RMSW(6) = PAR0T(7)
       RMSW(7) = PAR0T(8)
C
C-->  PACTABT B MSW_BEHTE CX=1 - PAPEEHE  !! OKPOBAHO !!
C
C      DO 3 NV = 1,18
C      ICX = (NV-1)*10 + 16 + 4
C      RMSW(ICX) = D1
C3      CONTINUE
C----------------------------------------------------------------------
C-->  "OOPHE" 
       K = IFIX( PAR0T(4) )
       IF ( K .LT. 0  .OR.  K  .GT. NMKNOT ) GO TO 5
       RMSW(9) = RK
       K = IFIX( PAR0T(5) )
       IF ( K .LT. 0  .OR.  K  .GT. NMKNOT ) GO TO 5
       RMSW(10) = RK
       K = IFIX( PAR0T(6) )
       IF ( K .LT. 0  .OR.  K  .GT. NMKNOT ) GO TO 5
       RMSW(11) = RK
C-
       RETURN
C-
5      CONTINUE
       WRITE(NWTR,  502 ) NEL, K
       WRITE(NWTRE, 502 ) NEL, K
502    FORMAT(/' *** B EMEHTE # ', I6, ' HE OCTM ',
     = 'E # ', I5, ' ***'/
     = ' ***  PACET PEKPAEH   [ FM0011 ] ***'//)
       STOP 20
       END
