C====== MS1D_PAR ======================================================
CXXX----KOMEKC "MS1" --> BEPC 2.0  (OT    1990 .)------------
C   KOPHEBA_POPAMMA: MS1D_PAR
C  -------------------
C   HAHAEHE:         
C  ------------
C   OPOPAMM:       1. MS1D_P1
C   ------------
C   PMEAHE:
C  -----------
C
CZZZ-------------------------------------------------------------------
       DIMENSION KAR(80), CH(16)
C**********************************************************************
       CHARACTER KAR*1, AM*1, CH*1
       CHARACTER NFI1*6, NFI2*2, NFI*12
       CHARACTER NFI_JOB*4, NFI_PAR*4, NFI_ZAG*4
       DATA NFI1/'MS1D_F'/
       DATA NFI_ZAG/'.ZAG'/
       DATA NFI_JOB/'.JOB'/
       DATA NFI_PAR/'.PAR'/
       DATA AM  /'&'/
C----------------------------------------------------------------------
C        :
C----------------------------------------------------------------------
C-->   
         OPEN (UNIT=30,FILE='MS1D_NCX.TEK')
         READ (30,1122) NFI2
1122     FORMAT(A2)
         OPEN (UNIT=99,FILE='CON')
         NFI = NFI1//NFI2//NFI_PAR
CC         write(99,*) NFI
CC         pause '!!!!!'
         OPEN (UNIT=40,FILE=NFI)
         NFI = NFI1//NFI2//NFI_JOB
         OPEN (UNIT=05,FILE=NFI)
         NFI = NFI1//NFI2//NFI_ZAG
         OPEN (UNIT=50,FILE=NFI)
C**********************************************************************
C--> 
       REWIND 40
       REWIND 50
       REWIND 05
C---------------------------------------------------------------------
100    CONTINUE
C-->   
       READ(50,110,END=500,ERR=700) (KAR(I), I=1,80)
110    FORMAT(80A1)
C-->   
       J = 0
200    J = J + 1
       IF( J      .GT. 65 ) GO TO 300
       IF( KAR(J) .NE. AM ) GO TO 200
C--> .  ?
          DO 250 J1=1,16
          IF( KAR(J+J1-1) .NE. AM ) GO TO 800
250    CONTINUE
       READ(40,110,END=900,ERR=705) (CH(I), I=1,16)
          DO 270 J1=1,16
          KAR( J+J1-1 ) = CH(J1)
270    CONTINUE
       J = J + 15
       GO TO 200
C######################################################################
300    CONTINUE
C-->  
       WRITE(5,110) (KAR(I), I=1,80)
C---------------------------------------------------------------------
C-->   
       GO TO 100
C---------------------------------------------------------------------
500    CONTINUE
C-->  ... !!!
       CLOSE(UNIT=50)
       CLOSE(UNIT=40)
       CLOSE(UNIT=30)
       CLOSE(UNIT=05)
       STOP 0
C---------------------------------------------------------------------
700    CONTINUE
C-->   
       WRITE(99,710)
710    FORMAT('  ***      ZAG *** ' )
       STOP 1
C---------------------------------------------------------------------
C---------------------------------------------------------------------
705    CONTINUE
C-->   
       WRITE(99,715)
715    FORMAT('  ***       PAR *** ' )
       STOP 1
C---------------------------------------------------------------------
800    CONTINUE
C-->    
       WRITE(99,810)
810    FORMAT('  ***      *** ' )
       STOP 2
C---------------------------------------------------------------------
900    CONTINUE
C-->     
       WRITE(99,910)
910    FORMAT('  ***       *** ' )
       STOP 3
C---------------------------------------------------------------------
       END
