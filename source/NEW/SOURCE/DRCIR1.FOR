         SUBROUTINE DRCIR1(BA0, KNOT, PAR0, IRC)
CXXX----KOMEKC "MS1" --> BEPC 1.1  (OT ABCTA 1987 .)------------
C   OPOPAMMA:   DRCIR1(BA0, KNOT, PAR0, IRC)
C   ------------
C   HAHAEHE:    COPTPOBKA BA0  OPEEEHE PAMEPA MSW_ALL
C   ----------
C   METO:         COPTPOBKA - CM. / TRIARB, O PHAK TA MOE;
C   -----          PAMEP MSWALL OPEEETC O OM MACTAB(8)
C                  P TOM:   +5 COB HA CKPTOP,
C                              +1*NXBA0 - HA KAATE CE. MSW OCAH
C                               (NXBA0 - KOECTBO EMEHTOB E)
C                               +1 COBO HA KAATE KOHA CCKA;
C                              OPOHEE CM. CTPKTP BA0 B / INPUT0;
C                 + LM = MACTAB(...+7) COB HA KA EMEHT  BA0;
C                   ***  P  MACTAB(...+7) = +1(VAR) - APOC
C                        EPE CALLFM P BOEHHOM AE FGMSW
C                        HA TOHEHE BCE H MSW_ALL AHHOO
C                        EMEHTA.    ****
C
C
C   APAMETP:     BA0, KNOT, PAR0 - MACCB OCAH EMEHTOB;
C   ---------      IRC = 1 - AAHE BOH;
C                      = 2 - BOMOHO TOKO P FRCPU = 0
C                            "AAPAT" REGION OTKEH (CM. PMEAHE);
C
C   OPOPAMM:  1. COMMON PROF1, PROF2
C   ------------   2. *** SORTBA ******  ( OT ABCTA 1987 . )
C                  3.  CALLFM.
C   PMEAHE:    1. P FRCPU = 1 [MASPRT(73)] OPEEEHH
C  -----------        PAMEP MSWALL ACBAETC B DMSWAL [MASPRT(20)]
C                     P FRCPU = 0 (CTATECKOE BEEHE O..) -
C                     POBOTC CPABHEHE HEOXOMOO  AHEE
C                     PAOT PAMEPA MSWALL  HAEH DMSWAL  MASPRT:
C                     B CAE HE XBATK O.. CTAHABBAEC IRC=2 
C                     EHEPPETC COOEHE;
C                   2.  !! CTPAXOBKA !! -->  O NSYS PCBABAETC
C                                            HAEHE NMKNOT
C
C
C
CZZZ-------------------------------------------------------------------
         COMMON/PROF1/ MASPRT(200)
         COMMON/PROF2/ MACTAB(800)
         INTEGER BA0, BA0CPL, AKKK, DMSWAL, FRCPU, FGMSW, TIP
         DIMENSION BA0(*), MSWT(50), KNOT(*), PAR0(*)
         EXTERNAL BA0CPL, BA0CNG
         EQUIVALENCE ( DMSWAL, MASPRT(20) )
         EQUIVALENCE ( FGMSW,  MASPRT(87) )
         EQUIVALENCE ( NMKNOT, MASPRT(7) )
         EQUIVALENCE ( NWTRE,  MASPRT(14) )
         EQUIVALENCE ( NWTR,   MASPRT(13) )
         EQUIVALENCE ( NXBA0,   MASPRT(3)  )
         EQUIVALENCE ( N1BA0,    MASPRT(4)  )
         EQUIVALENCE ( FRCPU,    MASPRT(73)  )
         EQUIVALENCE ( N1MACT,   MASPRT(17)  )
         EQUIVALENCE ( NSYS,     MASPRT(26)  )
         NSYS = NMKNOT
         IRC = 1
C--> SORT....
C!!!-------------------------------------------------------------------
C      CALL PRINT0( BA0, KNOT, PAR0)
C!!!-------------------------------------------------------------------
         CALL SORTBA(  BA0  )
C!!!-------------------------------------------------------------------
C      CALL PRINT0( BA0, KNOT, PAR0)
C!!!-------------------------------------------------------------------
C--->  OPEEEM PAMEP MSW_ALL
         MMSW = 5 + 1 * NXBA0 + 1
C-->  OCK O MACTAB  BCEX EMEHTOB:
         I0 = 6
         IMAX=BA0(3)
         DO 1 KKK = 1, NXBA0
C->  APEC EMEHTA KKK B BA0:
         AKKK = (KKK-1)*N1BA0 + I0
C-->  KOHTPO
         IF( AKKK+N1BA0  .GT.  IMAX ) CALL SUBERR(AKKK)
C-->  CMOTPM MACTAB
         TIP = BA0(AKKK+1)
         IX = 1
4        CONTINUE
         IF(MACTAB(IX) .EQ. 0 ) GO TO 2
         IF(MACTAB(IX) .EQ. TIP ) GO TO 3
         IX = IX + N1MACT
         GO TO 4
2        CONTINUE
C-->  O. OKA, TA HET...
         CALL SUBERR(TIP)
3        CONTINUE
C--> IX HAA CTPOKA
C-->  KOHTPO
         IF ( MACTAB(IX+7) .LT. 0 ) CALL SUBERR(IX)
         IF ( MACTAB(IX+7) .EQ. +1 ) GO TO 60
C--->    EMEHT HE C LM  -->  +1(VAR)
C ==> CTAEM
         MMSW = MMSW + MACTAB(IX+7)
       GO TO 1
C######################################################################
60     CONTINUE
C-->  TOHM LM.....
       FGMSW = 1
C      *********
C  AKKK - APEC OCAH EMEHTA B BA0, IKNOT  IPAR0 -> B KNOT  PAR0:
       IKNOT = BA0( AKKK+2 )
       IPAR0 = BA0( AKKK+3 )
C--->  HOMEP FM MOHTOPA:
       NFM = MACTAB( IX+6 ) / 1000
C-->  TOHM
       LM = 10
       CALL CALLFM( NFM, BA0(AKKK), KNOT(IKNOT), PAR0(IPAR0), MSWT, LM )
C--> CPOCM AEK...
       FGMSW = 0
C-->  CTAEM
       MMSW = MMSW + LM
C######################################################################
1        CONTINUE
C######################################################################
C!!!-------------------------------------------------------------------
         WRITE(NWTRE, 51) MMSW
51       FORMAT(' ***  CCKA MSW_ALL HEOXOMO ', I5, ' COB O.. *
     =**')
C!!!-------------------------------------------------------------------
C--->  TO  HAC ?
         IF ( FRCPU .EQ. 0 ) GO TO 5
C--> "APPARAT" REGION BKEH....
         DMSWAL = MMSW
         IRC = 1
         RETURN
C**********************************************************************
5        CONTINUE
         IRC = 1
C-->  CTATECK BE OCTATOHO ??
         IF ( DMSWAL.GE. MMSW ) RETURN
         IRC = 2
C-->  HET O..
C!!!-------------------------------------------------------------------
         IZZ = MMSW - DMSWAL
         WRITE(NWTRE, 50) IZZ, DMSWAL
50      FORMAT(/' ***  MSW_ALL HEXBATAET ', I5, ' COB O.. ***'/
     =  ' *** HAAHO O MSW_ALL BEEHO ', I5, ' COB O.. ***'/
     = ' *** PAOTA BMO ET PEPBAHA ***'///)
C!!!-------------------------------------------------------------------
         RETURN
         END
