         SUBROUTINE DM0013 ( MSW, RMSW, YALL, JALL, LOGYTR,
     *                       TOKN, TOKN1, VALLN, VALLN1, KOD,
     *                         MSWALL, RMSWAL, ADRMSW )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EBPA 1989 .)------------
C   OPOPAMMA:  DM0013 ( MSW, RMSW, YALL, JALL, LOGYTR,
C   -------------            TOKN, TOKN1, VALLN, VALLN1, KOD,
C                              MSWALL, RMSWAL, ADRMSW )
C
C   HAHAEHE:  MOHTOP         MAKPOMOE # TA 10:
C  ------------  MOCT APOHOBA
C                ************************************************
C                POHAK TA #6
C          CB C BHEHE CPEO:
C
C            AA "A"       AA "B"     AA  "C"
C              ! I             ! I          ! I
C              ! V             ! V          ! V
C   +--< V1 ]--*---------------!------------!----< V4 ]----+
C   !           <-- IV1        !            !   <-- IV4    !
C   !                          !            !              !
C   *--< V2 ]------------------*------------!----< V5 ]----*
C   !           <-- IV2                     !   <-- IV5    !
C   !                                       !              !
C   +--< V3 ]-------------------------------*----< V6 ]----*
C   !           <-- IV3                                    !
C   !                                            <-- IV6   !
C   !    ---> TOK_A                         ----> TOK_K    !
C   +---------*                                 *----------+
C     "AHO"  +                                 - "KATO"
C
C
C
C     KO-BO OB --- 5
C
C     BBOHE HAEH- 17 T. :
C      TOK A-A, TOK A-B, TOK A-C, TOK AHOA, TOK KATOA,
C      TOK V1, V2, V3, V4, V5, V6,
C      C V1, V2, V3, V4, V5, V6;
C
C   KOPOBKA:
C
C    # T 10   1 2 3 4 5
C                MAS < KOD [#] >;
C
C E:  KOD = 0 EC MOCT HE PABEM, TOA # MOHO HE KOPOBAT;
C
C       KOD = 1 EC MOCT PABEM, TOA --->
C                # - HOMEP EMEHTA E, BMC C  MOCTA
C                      B TOKN/N1 COEPATC: MMCIU - 6 TK.
C                                            HXCIU - 6 TK.
C                B COOTBETCTB CO CXEMO  HMEPAE BEHTE
C
C          MOHTOP BBAET DM00A9 (CM.)
C          BOH AOHEHE MSWX
C
C   APAMETP:     MSW, RMSW - PABEE COBO COCTOH MAKPOMOE
C   ---------      ( "OTPEOK" MACCB MSWALL -> C.M. / GETMSW );
C                  YALL - MATPA P0BOMOCT AHAPEMO E;
C                  JALL - BEKTOP CTOHKOB TOKA AHAPEMO E;
C                  VALLN - BEKTOP OBX HAPEH AHAPEMO E:
C                          P  T  =  TN;
C                  VALLN1- BEKTOP OBX HAPEH AHAPEMO E:
C                          P  TN + H0;
C                  TOKN   TOKN1 - HAEHE EPEMEHHX "COCTOH"
C                                  MOE P TN    TN + H0;
C                          ( PAMEPHOCT -> CM. MASPRT(46) = NNTOK )
C                  LOGYTR - BEKTOP PHAKOB K.. OB:
C                  COETC B MAKPOMOEX C PHAKOM TA = 6;
C                  PAMEPHOC MACCBOB P "ALL" OPEETC:
C                   MAX_DIMENSION ---> NDALL = MASPRT(23)
C                   TEKA_PAMEPHOCT ---> NSYS = MASPRT(26)
C                  KOD - APAMETP OPATHO CB C MOHTOPOM DM....
C
C   OPOPAMM:  1. COMMON PROF1, PROF2, PROF3;
C   ------------   2. DM00A9
C
C   PMEAHE:  1.CTPKTP MSW COBA MAKPOMOE AHHOO TA CM. HE
C   ----------   2. P ZAPROS ^=1, 10,20,3,4 - BAA COOEH  XO
C                3. P FTEST = 1 -> EAT HA WTRE AKTA CMEH COCTOH
C              OPMAT MSW # TA 10 [ MOCT APOHOBA  ]:
C              -------------------------------------------
C               "OCTOHHA" ACT
C               ******************
C
C  +-------+--------+--------+--------+------+------+--------+----+
C  I HOMEP I HOMEP  I HOMEP  I  P. I KO I KO. I AP.   I PE I
C  I EME I TA   I /    I TA   I ECT I BB. I HA.  I E I
C  I HTA   I MOE I PACETAI (PE.) I BO   I HA I "TOKN" I PB I
C  I       I        I DM.....I       .I OBI EH.I "TOKN1"I    I
C  +-------+--------+--------+--------+------+------+--------+----+
C  I  1    I   2    I   3    I    4   I   5  I  6   I   7    I 8  I
C  +-------+--------+--------+--------+------+------+--------+----+
C
C
C              EPEMEHHA ACT MSW:
C              *********************
C
C  COBO     COBO     OOHAEH  OECKOE HAEHE
C  OT        OT
C  HAAA    EPEMEH.
C  MSW       ACT         BEHTE:
C                       :
C  9 - AA "A"           V1 --> <09> - <12>
C 10 - AA "B"           V2 --> <10> - <12>
C 11 - AA "C"           V3 --> <11> - <12>
C 12 - "A"- AHO          V4 --> <13> - <09>
C 13 - "K" - KATO        V5 --> <13> - <10>
C                         V6 --> <13> - <11>
C
C    14       1   [FM]  1 PHAK PABEH --> 0 HET,
C                                                1 - PABEHE O C
C    15       2   [FM]  NPB - #., AEO C
C    16       3   [LM]  ANPB - APEC #. B MSWALL
C    17       4   [LM]  AUYP - APEC B TOKN/N1 HAEH C
C    18       5   [ ]    PEEPB
C    19       6   [ ]    PEEPB
C    20-25    7-12    MSWX[1] V1-> #O.; KD  HX  MMCIU  HXCIU  . KD
C    26-31   13-18    MSWX[2] V2-> #O.; KD  HX  MMCIU  HXCIU  --
C    32-37   19-24    MSWX[3] V3-> #O.; KD  HX  MMCIU  HXCIU  --
C    38-43   25-30    MSWX[4] V4-> #O.; KD  HX  MMCIU  HXCIU  --
C    44-49   31-36    MSWX[5] V5-> #O.; KD  HX  MMCIU  HXCIU  --
C    50-55   37-42    MSWX[6] V6-> #O.; KD  HX  MMCIU  HXCIU  --
C
C  LM<O> = 55;      LM<OKAH>=42
C
C
C
C               PAO MACCB TA  MSWX TA # A9 (  T. #10)
C             -------------------------------------
C
C
C  +-------+--------+--------+--------+------+-------+
C  I HOMEP I  "KD"  I "HX"   I MMCIU  I  HX  I A  I
C  I O - I P-  I BPEM  I KO PI CIU  I       I
C  I EME I HAK CO-I PE-OI M I M-CAI "KD"  I
C  I HTA   I CTOHI KOM-I  CA    I      I       I
C  +-------+--------+--------+--------+------+-------+
C  I  1    I   2    I   3    I    4   I   5  I       I
C  +-------+--------+--------+--------+------+-------+
C   MMCIU    HXCIU OPEEET MOHTOP MAKPOMOE BEHT......
C
C
C    BEHT OTKPT ==>  KD=1;;;;BEHT AKPT ==>  KD=0;
C
C********************************************************************
C
CZZZ-------------------------------------------------------------------
         COMMON /PROF1/ MASPRT(200)
         DIMENSION MSW(*), RMSW(*), YALL(*), JALL(*), LOGYTR(*)
         DIMENSION VALLN(*), RMASPT(1), VALLN1(*), TOKN(*), TOKN1(*)
         REAL JALL
       DIMENSION MSWALL(*), RMSWAL(*)
         EQUIVALENCE ( MASPRT(1), RMASPT(1) )
         EQUIVALENCE ( MASPRT(62), HXMIN )
         EQUIVALENCE ( MASPRT(14), NWTRE )
         EQUIVALENCE ( MASPRT(59), GVENT6 )
         EQUIVALENCE ( MASPRT(94), DTMCIU )
         EQUIVALENCE ( MASPRT(60), FTEST )
         EQUIVALENCE ( MASPRT(57), OPEN6 )
         EQUIVALENCE ( ZAPROS, MASPRT(28) )
         EQUIVALENCE ( NDALL,  MASPRT(23) )
         EQUIVALENCE ( TN,     MASPRT(29) )
         EQUIVALENCE ( H0,     MASPRT(30) )
         EQUIVALENCE ( H1,     MASPRT(32) )
         EQUIVALENCE ( H2,     MASPRT(33) )
         EQUIVALENCE ( FKOM,   MASPRT(34) )
         EQUIVALENCE ( TXG,    MASPRT(35) )
         EQUIVALENCE ( HXG,    MASPRT(61) )
         EQUIVALENCE ( NTXG,   MASPRT(36) )
         EQUIVALENCE ( EPSKOM, MASPRT(39) )
         EQUIVALENCE ( ZEROCP, MASPRT(50) )
         INTEGER FKOM, ZAPROS
         EQUIVALENCE ( ICLOSE, MASPRT(77) )
         EQUIVALENCE ( UOPEN,  MASPRT(78) )
C----------------------------------------------------------------------
       DIMENSION TOKNX(2), TOKN1X(2)
       INTEGER VK, VM
       REAL CVN,CVN1
       DIMENSION VK(6), VM(6), TVN(6), TVN1(6), CVN(6), CVN1(6)
       DATA VK / 9, 10, 11, 13, 13, 13/
       DATA VM / 12,12,12,9,10,11/
C----------------------------------------------------------------------
       KOD = 0
C--->  KOHTPO TA
         IF ( MSW(2) .NE. 10 ) GO TO 9999
C
       TN1 = TN + H0
C---> BOP PEMA:
         IF ( ZAPROS .EQ. 1 )   GO TO 100
         IF ( ZAPROS .EQ. 10 )  GO TO 200
         IF ( ZAPROS .EQ. 20 )  GO TO 300
         IF ( ZAPROS .EQ. 3 )   GO TO 400
         IF ( ZAPROS .EQ. 4 )   GO TO 500
C===> HAE OKA
         NWTRE = MASPRT(14)
         WRITE(NWTRE,9997) MSW(3), ZAPROS
9997     FORMAT( ' *** DM MOHTOP #', I4, ' APOC OCBAH OOEH
     = ***'/ ' *** ZAPROS = ', I5, ' - HOPPETC ***')
         RETURN
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
9999     CONTINUE
         NWTRE = MASPRT(14)
         WRITE(NWTRE,9998) MSW(1), MSW(2)
9998     FORMAT( ' *** O. CO B DM0013 - APOC HA OCBAHE O
     =O TA ***'/
     =    ' *** EMEHT # ', I10, ' T MOE # ', I10, ' ***'//)
         CALL SUBERR(0)
667      CONTINUE
C---------------Z A P R O S = 1----------------------------------------
C---------------Z A P R O S = 10---------------------------------------
C---------------Z A P R O S = 20---------------------------------------
C---------------Z A P R O S = 3----------------------------------------
C---------------Z A P R O S = 4----------------------------------------
C
100    CONTINUE
200    CONTINUE
300    CONTINUE
400    CONTINUE
500    CONTINUE
C--> EPE MOHTOP, OCTABEM TOKO HAEH.....
        ITOK=MSW(7)
C--> E C  HXCIU B OM EMEHTE
        ITOKZ=MSW(17)
C-- O  BCEX------
         DO 101 IV=1,6
C--> HOMEPA OB
        K1 = VK(IV)
        M1 = VM(IV)
         K = MSW(K1)
         M = MSW(M1)
C-->AP. B HAEM MSW HAAA MSVX[IV]...
        IIMSW = (IV-1)*6 + 20
C- P ZAPROS=3, TO BCTABT MMCIU  HXCIU
C*******IF ( ZAPROS .NE. 3 ) GO TO  1010
C--> PAB. BEHT ????? EC A, TO H XEPA HEEAT.....
         IF ( MSW(14) .EQ. 0 ) GO TO 1010
C--> KA BCTABT CIU  HXCIU
         KKII = 23 + (IV-1)*6
C--> OTKA BT...
         KKJJ = ITOKZ + (IV-1)
C--> EPECBAEM B MSWX......
         MSW(KKII) = IFIX( TOKN1(KKJJ) )
         RMSW(KKII+1) = TOKN1(KKJJ+6)
C--> EPECAT B MSWX HAEH TOKOB
1010     TOKNX(1)  = TOKN (ITOK + 5 + IV - 1 )
         TOKN1X(1) = TOKN1(ITOK + 5 + IV - 1 )
C        CONTINUE
         CALL DM00A9(K,M,MSW(IIMSW),RMSW(IIMSW),YALL,JALL,LOGYTR,
     *               TOKNX,TOKN1X,VALLN,VALLN1,KOD)
C
C        IF ( ZAPROS .EQ. 3 ) CVN1(IV) = TOKN1X(2)
         CVN1(IV) = TOKN1X(2)
C        IF ( ZAPROS .EQ. 20 ) TVN1(IV) = TOKN1X(1)
         TVN1(IV) = TOKN1X(1)
101      CONTINUE
C**********************
C-->  ZAPROS = 1, 10, 4 --> TO BCE......
C@@@@ @ IF ( ZAPROS .EQ. 1 ) RETURN
C@@@@ @@IF ( ZAPROS .EQ. 10 ) RETURN
C@@@@ @@IF ( ZAPROS .EQ. 4 ) RETURN
C-- PAEPEMC C ZAPROS=20  3....
C@@@@ @@ IF ( ZAPROS .NE. 3 ) GO TO 1011
C--> BCTABM CIU...
         DO 103 IV=1,6
         IICIU = ITOK + 11 + (IV-1)
103      TOKN1(IICIU) =CVN1(IV)
C-->  ZAPROS=20 TO BCE...
C@@@@@@  RETURN
1011     CONTINUE
C  ZAPROS=3
C---->PACTAT  PACCTABT BB. HAEH.....
         DO 102 IV=1,6
C-->   APEC HAX TOKN/TOKN1
         IITOK = ITOK + 5 + (IV-1)
         TOKN1(IITOK) = TVN1(IV)
102      CONTINUE
C---> BCM BHEHE TOK......
C    BPEMEH TN1...
C
C.....AA "A"
        TOKN1(ITOK)=TVN1(1) - TVN1(4)
C.....AA "B"
        TOKN1(ITOK+1) = TVN1(2) - TVN1(5)
C.....AA "C"
        TOKN1(ITOK+2) = TVN1(3) - TVN1(6)
C...."AHO"
        TOKN1(ITOK+3) = TVN1(1) + TVN1(2) + TVN1(3)
C...."KATO"
        TOKN1(ITOK+4) = TVN1(4) + TVN1(5) + TVN1(6)
555       RETURN
          END
