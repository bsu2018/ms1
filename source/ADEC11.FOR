       SUBROUTINE ADEC11( KD, REG, FLAG, ADPRTO,ADPRTI, ADPROG, IPORT,
     *                    IPORT1,T,IER )
CXXX----KOMEKC "MS1" --> BEPC 1.1  (AT OCTOBER  1989  .)-----------
C   OPOPAMMA: ADEC11( KD, REG, FLAG, ADPRTO,ADPRTI, ADPROG, IPORT,
C   -------------         IPORT1,T,IER )

C   HAHAEHE:  OPAOTK BXAPECHX KOMAH
C   ----------   MKPOPOECCOPA  K1801BM1(2,3)  ( PAOTA C ATAM )
C              *------------------------------------------------------*
C              * KOMAHA  "MOVB"( 11SSDD Q ):                          *
C              * OEPAH CTOHK   <SS> EPECAETC O APEC       *
C              * OEPAHA PEMHKA <DD> .                            *
C              *------------------------------------------------------*
C              * KOMAHA  "CMPB"( 12SSDD Q ):                          *
C              * CPABHBAETC OEPAH CTOHKA <SS>  OEPAH  P-  *
C              * EMHKA <DD>  MEHTC PHAK. OA OEPAHA HE   *
C              * MEHTC.                                          *
C              *------------------------------------------------------*
C              * KOMAHA  "BITB"( 13SSDD Q ):                          *
C              * BOHET OECK HK  "" HA OEPAHOM      *
C              * CTOHKA <SS>  OEPAHOM  PEMHKA <DD>, MEH  *
C              * COOTBETCTBM OPAOM PHAK. OA OEPAHA HE    *
C              * MEHTC.                                          *
C              *------------------------------------------------------*
C              * KOMAHA  "BICB"( 14SSDD Q ):                          *
C              * OAET KA PAP OEPAHA PEMHKA  <DD>,      *
C              * COOTBETCTB CTAHOBEHHOM PAP OEPAHA      *
C              * CTOHKA <SS>. COEPMOE  <SS>  HE MEHETC.     *
C              *------------------------------------------------------*
C              * KOMAHA  "BISB"( 15SSDD Q ):                          *
C              * BOHET OECK OEPA "" HA COEPMM   *
C              * OEPAHA CTOHKA <SS>  OEPAHA PEMHKA <DD>   *
C              * ACBAET PETAT O APECC  <DD>.               *
C              * COEPMOE  <SS>  HE MEHETC.                     *
C              *------------------------------------------------------*
C
C   METO:      OECKOE MOEPOBAHE.
C   -----
C
C   APAMETP:  BXOHE :
C  ----------      KD     - KO KOMAH  ;
C                  REG(8) - MACCB PECTPOB MKPOPOECCOPA ;
C                           REG(1) --> R0
C                           REG(2) --> R1
C                           REG(3) --> R2
C                           REG(4) --> R3
C                           REG(5) --> R4
C                           REG(6) --> R5
C                           REG(7) --> R6 ( KAATE CTEKA )
C                           REG(8) --> R7 ( CETK KOMAH  )
C                  FLAG(6)- MACCB AOB CC MKPOPOECCOPA ;
C                           FLAG(1) --> A  C (EPEHOC)
C                           FLAG(2) --> A  V (APM. EPEOHEHE)
C                           FLAG(3) --> A  Z (HEBO PETAT)
C                           FLAG(4) --> A  N (OTPAT.PETAT)
C                           FLAG(5) --> A  T
C                           FLAG(6) --> A I/O(POPTET)
C                  ADPRTO - APEC OPTA BBOA ;
C                  ADPRTI - APEC OPTA BBOA ;
C                  ADPROG - MAKCMAH APEC O ,B PEEAX KOTOPOO
C                           PAOTAET PABA POPAMMA ;
C                  IPORT  - COEPMOE OPTA BBOA ;
C                  IPORT1 - COEPMOE OPTA BBOA ;
C                  IBAI1 -  CTAP PAP
C                  IBAI2 -  MA PAP
C
C               BXOHE :
C                  T      - BPEM BOHEH KOMAH ;
C                  IER    - KAATE OK:
C                           IER=0  -  OOK HE OHAPEHO ;
C                           IER=1  -  OOHA AC KOMAH O
C                                     BXO A PEE O ;
C                           IER=2  -  POOO OPAEHE K EKE
C                                     AMT, MEE HEETH APEC.
C                           IER=3  -  HE HAA KOMAHA ;
C                           IER=4  -  OPAEHE K OPT B/B
C                                     HE O TOM APEC ;
C                           IER=5  -  KOMAHA OKA HE PEAOBAHA ;
C
C
C   OPOPAMM:  1. ADECIS, ADECDB, ADECBD ;
C   ------------
C
C   PMEAHE:    1. HET.
C   -----------
C
CZZZ-------------------------------------------------------------------
       COMMON /MEMER/ MEM(2048), MEM1(2048)
       INTEGER  REG(8), FLAG(6),  ADPROG, KB(16), KB1(16)
       INTEGER  ADPRTO, ADPRTI
       IER = 0
       KD = KD - 32768
       KOM = KD / 4096
C----------------------------------------------------------------------
C--> EM OEPAH CTOHK ( APEC--> IADRS,  CO--> IDATA )
       KD1 = ( KD - KOM*4096 ) / 64
       CALL ADECIS( KD1, ADPROG, REG, IADRS, IDATA, TI, IER )
       IF( IER   .EQ. 1 ) RETURN
       IER0 = IER
       IF( IADRS .GE.-8 ) GO TO 10
C--> APOC HA BBO AHHX  OPTA BBOA
CCCC   WRITE (6,*) ADPRTI,ADPRTO
       IF( (-IADRS) .NE. ADPRTI ) GO TO 9904
       IDATA = IPORT1
10     CONTINUE
C----------------------------------------------------------------------
C--> EM OEPAH PEMHK ( APEC--> IADRS1,  CO--> IOLD  )
       KD1 = KD - KOM*4096 - KD1*64
       CALL ADECIS( KD1, ADPROG, REG, IADRS1, IOLD, TO, IER )
       IF( IER   .EQ. 1 ) RETURN
       IER1 = IER
       IF( IADRS1.GE.-8 ) GO TO 20
C--> APOC HA BBO AHHX B OPT  BBOA
       IF( (-IADRS1) .NE. ADPRTO ) GO TO 9904
       IOLD = IPORT
20     CONTINUE
C----------------------------------------------------------------------
C -->  PAOEM COBO HA AT
       IBAI1 = IDATA / 256
       IBAI2 = IDATA - IBAI1*256
C--> KAKO AT OPABATBAEM ?
       IDATA = IBAI2
       IF ( IER0.EQ.2 ) IDATA = IBAI1
C -->  PAOEM COBO HA AT
       IBAI3 = IOLD / 256
       IBAI4 = IOLD - IBAI3*256
C--> KAKO AT OPABATBAEM ?
       IOLD = IBAI4
       IF ( IER1.EQ.2 ) IOLD = IBAI3
C--> PAOEMC O KOMAHAM :
       GO TO ( 100,  200,  300,  400,  500, 9903, 9903, 9903, 9903,
     *        9903, 9903, 9903, 9903,9903, 9903 ), KOM
       GO TO 9903
C----------------------------------------------------------------------
C              KOMAHA  "MOVB"
C----------------------------------------------------------------------
100    CONTINUE
       IF( IADRS1 .LT. 0 ) GO TO 110
       IF( IER1.EQ. 2 ) GO TO 105
       MEM(IADRS1+1)=(MEM(IADRS1+1)/256)*256 + IDATA
       GO TO 120
105    CONTINUE
       MEM(IADRS1+1)= MEM(IADRS1+1) + (IDATA -
     * MEM(IADRS1+2))*256
       MEM(IADRS1+2)= IDATA
       GO TO  120
110    CONTINUE
       IF( IADRS1 .LT.-8 ) GO TO 115
       IREG1 = REG(-IADRS1)/32768
       TREG2 = REG(-IADRS1) - IREG1*32768
       REG(-IADRS1) = (IREG2 / 256)*256 + IDATA
       IF (IDATA.GT.128) REG(-IADRS1) = REG(-IADRS1)+32768
       GO TO 120
115    CONTINUE
       IPORT = (IPORT / 256) + IDATA
120    CONTINUE
       IER = 0
C--> OCTAEM BPEM
       TB = 4.4E-6
       T = TB + TI + TO
C--> AMEMC PHAKAM.
       FLAG(2) = 0
       FLAG(3) = 0
       IF( IDATA .EQ. 0 ) FLAG(3) = 1
       FLAG(4) = 0
C      IF( IDATA .GE. 32768 ) FLAG(4) = 1
       RETURN
C######################################################################
C----------------------------------------------------------------------
C              KOMAHA  "CMPB"
C----------------------------------------------------------------------
200    CONTINUE
        IDATA = IDATA  - IOLD
C--> OCTAEM BPEM
       TB = 3.2E-6
       IF( TI .EQ. 0 .AND. TO .EQ. 0 ) TB = 3.6E-6
       T = TB + TI + TO
C--> AMEMC PHAKAM.
       FLAG(1) = 0
       IF(IDATA .GE. 0 ) GO TO 205
       FLAG(1) = 1
       IDATA = 256 + IDATA
 205   CONTINUE
       FLAG(2) = 0
C      IF( IDATA.GE.32768.AND.IOLD.LT.
C    *32768.AND.INEW.LT.32768)    FLAG(2)=1
C      IF( IDATA.LT.32768.AND.IOLD.GE.
C    *32768.AND.INEW.GE.32768)    FLAG(2)=1
       FLAG(3) = 0
       IF(IDATA.EQ.0)  FLAG(3) = 1
       FLAG(4) = 0
C      IF(INEW.GE.32768)      FLAG(4)=1
       IER = 0
       RETURN
C######################################################################
C----------------------------------------------------------------------
C              KOMAHA  "BITB"
C----------------------------------------------------------------------
300    CONTINUE
C--> PAOEM OEPAH CTOHK O CTEEHM BOK
       CALL ADECDB( IDATA, KB, IER )
       IF( IER .NE. 0 ) RETURN
C--> PAOEM OEPAH PEMHK O CTEEHM BOK
       CALL ADECDB( IOLD, KB1, IER )
       IF( IER .NE. 0 ) RETURN
C----------------------------------------------------------------------
       ISUM = 0
       DO 310 I=1,8
       KB(I) = KB(I) * KB1(I)
       ISUM  = KB(I) + ISUM
310    CONTINUE
C--> OCTAEM BPEM
       TB = 4.4E-6
       T = TB + TI + TO
C--> AMEMC PHAKAM.
       FLAG(2) = 0
       FLAG(3) = 0
       IF( ISUM .EQ. 0 ) FLAG(3) = 1
       FLAG(4) = KB(8)
       IER = 0
       RETURN
C######################################################################
C______________________________________________________________________
C                    KOMAHA "BICB"
C______________________________________________________________________
400    CONTINUE
C-->  PAOEM OEPAH CTOHK O CTEEHM BOK
       CALL  ADECDB(IDATA,KB,IER)
       IF(IER.NE.0)  RETURN
C-->  PAOEM OEPAH PEMHK O CTEEHM BOK
       CALL ADECDB(IOLD,KB1,IER)
       IF( IER. NE. 0 )  RETURN
C----------------------------------------------------------------------
       ISUM = 0
       DO 410  I=1,8
       IF( KB(I) .EQ. 1 ) KB1(I) = 0
       ISUM = ISUM + KB1(I)
410    CONTINUE
C-->   PEOPAEM PETAT B ECTHOM BE
       CALL ADECBD(IDATA,KB1,IER)
C-->  ACBAEM PETAT
       GO TO 100
C######################################################################
C______________________________________________________________________
C                    KOMAHA "BISB"
C______________________________________________________________________
500    CONTINUE
C-->  PAOEM OEPAH CTOHK O CTEEHM BOK
       CALL  ADECDB(IDATA,KB,IER)
       IF(IER.NE.0)  RETURN
C-->  PAOEM OEPAH PEMHK O CTEEHM BOK
       CALL ADECDB(IOLD,KB1,IER)
       IF( IER. NE. 0 )  RETURN
C----------------------------------------------------------------------
       ISUM = 0
       DO 510  I=1,8
       IF( KB(I). EQ. 1 ) KB1(I) = 1
       ISUM = ISUM + KB1(I)
510    CONTINUE
C-->   PEOPAEM PETAT B ECTHOM BE
       CALL ADECBD(IDATA,KB1,IER)
C-->  ACBAEM PETAT
       GO TO 100
C######################################################################
C----------------------------------------------------------------------
9903   CONTINUE
       IER = 3
       RETURN
C----------------------------------------------------------------------
9904   CONTINUE
       IER = 4
       RETURN
C----------------------------------------------------------------------
       END
