         SUBROUTINE DRG1F0(KAR, DAT, MSWALL, TOKN, VALLN, NDX, XGRAF )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C   OPOPAMMA:   DRG1F0(KAR, DAT, MSWALL, TOKN, VALLN, NDX, XGRAF )
C   ------------
C   HAHAEHE:    *** COHTE  OPAOTK PEKTB #PA1 ***
C   -----------      #PA1 T0 TM KOUT KSX
C
C                  T0 - HAAHOE BPEM EAT PAKOB;
C                  TM - KOHEHOE  BPEM EAT PAKOB;
C                  KOUT - EPE CKOKO TOEK BBOT;
C                  KSX -  KOECTBO CTPOK O OC "X" (BH) B PAKE;
C
C                  B CCKE APOCA HEOXOMO KABAT CTPOO
C                                                        *******
C                  BE BEH; P TOM POPTET PAOPA
C                  ( COACHO GETSPS ):
C                  "V", "U", "TOK".....
C                   EPBA -> OC "X",  BTOPA -> OC "Y";
C   METO:         OEBEH;
C   -----
C   APAMETP:     KAR - CMBOHA CTPOKA TEKCTA PEKTB(A-KOD,80);
C   ---------      DAT - MACCB PHTX AHHX PEKTB;
C                  MSWALL - COBA COCTOH E;
C                  TOKN, VALLN - MACCB XPAHEH "TOEK";
C                  NDX - PAMEPHOCT XGRAF;
C                  XGRAF - "CH"  BBOA PAKOB;
C
C   OPOPAMM:  1. COMMON PROF1;
C   -------------  2. GETSPS, DRG100, READ00 , PPNCOM
C
C   PMEAHE:    1. "MOAHE" --> TOKO  KOUT  KSX---->
C   ----------         1   100
C
CZZZ-------------------------------------------------------------------
         COMMON /PROF1/ MASPRT(200)
C-->   EO BPAEM  AA HAKOEH
         EQUIVALENCE ( MASPRT(48), HOUTT )
         EQUIVALENCE ( SETKA,  MASPRT(63) )
         EQUIVALENCE ( NTGRAF, MASPRT(47) )
         EQUIVALENCE ( NWTR,   MASPRT(13) )
         EQUIVALENCE ( NWTRE,  MASPRT(14) )
         EQUIVALENCE ( NRDR,   MASPRT(12) )
         INTEGER SPIS
         DIMENSION SPIS(55), MSWALL(*), TOKN(*), VALLN(*) , XGRAF(*)
         DIMENSION KAR(*), DAT(*)

!         write(*,*) '**** DRG1F0 ********'
!         write(*,*) '**** DRG1F0 ********'      
!         write(*,*) '**** DRG1F0 ********'   
!         write(*,*) '**** DRG1F0 ********'



C-->  ECT  MSWALL ?
       IF ( MASPRT(74) .EQ. 1 ) GO TO 59
       WRITE(NWTR, 60)
60     FORMAT(/' *** HET OCAH E - PEKTBA HOPPETC ***'/)
       RETURN
59     CONTINUE
C===>
C
         KOUT = 1
         KSX = 100
C===>
C=======>READ(NRDR, GRAF)
       KKK = IFIX( DAT(1) )
       IF ( KKK .GE. 2 ) GO TO 5600
       WRITE(NWTR, 57 )
57     FORMAT(/' *** HET "T0" / "TM" - PEKTBA HOPPETC ***'/)
       RETURN
5600   CONTINUE
       T0 = DAT(2)
       TM = DAT(3)
       IF ( KKK. EQ. 2 ) GO TO 58
       KOUT = IFIX( DAT(4) )
       IF ( KKK .EQ. 3 ) GO TO 58
       KSX = IFIX( DAT(5) )
C
C
58     CONTINUE
C=======>WRITE(NWTR, GRAF)
C====>
         IF ( KSX .LT. 0 ) KSX =100
C
         IF ( KOUT .LE. 0 ) KOUT = 1
C===>
         WRITE(NWTR, 50) T0, TM, KOUT, KSX
50     FORMAT(/' *** #PA1 PHTA:==> T0=', G12.5,' TM=',G12.5,' ***'/
     =          '                    ==> KOUT=',I3,' KSX=',I5,
     =   9X,    '     ***'/)
C----------------------------------------------------------------------
         CALL GETSPS( MSWALL, SPIS, IRC )
         GO TO ( 1,2,3), IRC
         CALL SUBERR(IRC)
3        CONTINUE
         WRITE(NWTR, 51)
51      FORMAT(//' *** KOHE AA HA "RDR" - PAOTA PEPBAETC ***'//)
         call STOPP(16)
C----------------------------------------------------------------------
2        CONTINUE
C-->  SPIS CT
         RETURN
C**********************************************************************
1        CONTINUE
C--> OOTOBKA K BBO...
       IF ( SPIS(1) .GT. 2 ) WRITE(NWTR,400) SPIS(1)
400    FORMAT(/' *** B APOCE ', I2, ' ABCMOCTE  "#PA1"',
     = ', OCTMO 2-E ***'/)
       IF ( SPIS(1) .GT. 2 ) SPIS(1) = 2
       IF ( SPIS(1) .LT. 2 ) WRITE(NWTR,4000)
4000   FORMAT(/' *** APOC  "#PA1" - OOEH, MAO AHHX ***'/)
       IF ( SPIS(1) .LT. 2 ) RETURN
C                            *******
       TIME = TM
       RK = KOUT
       KTXX = 0
C$$$$$ NTGRAF = INT( (TM-T0)/(HOUTT*RK) +0.5 )  + 0
       NTGRAF = 0
C-->
C-->
C-->
C--> OTKPOEMC       -->  OM HOUTT
         KOD = 1
         CALL READ00( KOD, HOUTT,  TOKN, VALLN)
         GO TO ( 100, 200, 300 ), KOD
         CALL SUBERR(KOD)
100      CONTINUE
C***** OKPEM ******************************************************
C---> KOHTPOPEM TM, B TIME --> MAX BPEM...
C        IF ( TIME .LT. TM ) WRITE(NWTR,56) TIME, TM, TIME
C56       FORMAT(/' *** AHHE AOB HAKOEH OPEEEH TOKO O ',
C    = G12.5, ' CEK. ***'/
C    = ' *** APOEHA BEPXH PAHA BPEMEHHOO HTEPBAA TM=',
C    = G12.5, ' CEK. ***'/
C    = ' *** EPEOPEEETC HA HAEHE TM=', G12.5, ' CEK. ***')
C        IF ( TIME .LT. TM ) TM = TIME
C**********************************************************************
C----------------------------------------------------------------------
       HOUTTX = HOUTT * 1.8E+4
       WRITE(NWTR, 5667 ) HOUTT, HOUTTX
5667   FORMAT(/' *** HAEH EPEMEHHX E OPEEEH C AOM',
     = 1X,G12.5, ' (', G12.5, ' ) ***'/)
C----------------------------------------------------------------------
         RK = KOUT
C--> CKOKO POCT BBECT
         NTGRAF = INT( (TM-T0)/(HOUTT*RK) + 0.5 ) + 0
C                                                *******
C----------------------------------------------------------------------
C  CKOKO OBOET XGRAF ( TXXM - COOTB. BPEM --> TM ):
       NXXDX = NDX/2
       TXXM = (NXXDX-1) * HOUTT * RK  +  T0
       IF ( NXXDX .LT. NTGRAF ) WRITE(NWTR,401) NTGRAF, NXXDX, TXXM
401    FORMAT(/' *** B HTEPBAE [T0,TM] COEPTC ', I5,
     =   ' TOEK ***'/' *** PAMEP O.. OCKAT',
     =   ' COOBAT TOKO ', I5, ' TOEK OPEEEH ***'/
     =   ' *** HAEHE TM MEHETC HA TM = ', G12.5, ' ***'/)
       IF ( NXXDX .LT. NTGRAF ) TM = TXXM
C
       NTGRAF = INT( (TM-T0)/(HOUTT*RK) + 0.5 )  + 0
C                                                 ****
C****CTPAXOBKA*********************************************************
       IF ( TM .LE. T0 ) WRITE(NWTR,5666) T0, TM
5666  FORMAT(//' *** HTEPBA HAEH [T0,TM]:=> ','[',G12.5,',',G12.5,
     =   '] ***'/ ' *** OPEEEH OOHO --> "#PA1" - ',
     =        ' HOPPETC ***'//)
       IF ( TM .LE. T0 ) RETURN
C**********************************************************************
C----------------------------------------------------------------------
         WRITE(NWTR ,52) NTGRAF
52       FORMAT(/' *** CTPOTC PAK O ', I5, ' TOKAM ***' /)
C-->  OTKPT EAAT
       CALL PPNCOM(3,NWTR)
         KTXX = 0
         KOD = 1
         CALL DRG100(KOD, KSX, SPIS, TIME, TOKN, VALLN, NDX, XGRAF )
         KXX = 0
C==> CTKA XGRAF
         DO 53 I = 1, NDX
53       XGRAF(I) = 0.0
C-->  K HAKOEH
102      CONTINUE
         KOD = 2
         CALL READ00(KOD, TIME, TOKN, VALLN )
         GO TO (101, 200, 300 ), KOD
         CALL SUBERR(KOD)
101      CONTINUE
C-->  HAA  TOKA
         IF ( TIME .LT. T0 ) GO TO 102
         IF ( TIME .GT. TM ) GO TO 105
103      CONTINUE
         KOD = 2
         IF ( KXX .EQ. 0 )
     =     CALL DRG100(KOD, KSX, SPIS, TIME, TOKN, VALLN, NDX, XGRAF)
         IF ( KXX .EQ. 0    ) KTXX = KTXX + 1
         KXX = KXX + 1
         IF ( KXX .EQ. KOUT ) KXX = 0
         GO TO 102
105      CONTINUE
C!!!===================================================================
         IF ( KTXX .NE. NTGRAF ) WRITE(NWTRE, 110) KTXX,NTGRAF
110      FORMAT(' *** PEAHO PH ', I5, ' TOEK, A APOC ',
     = I5, ' ***')
C!!!===================================================================
C---> BBECT PAK...
         KOD = 3
         CALL DRG100(KOD,KSX, SPIS, TIME, TOKN, VALLN, NDX, XGRAF)
C===>          PEKTBA BOHEHA
         RETURN
C++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
200      CONTINUE
C--->   O. KOHE, BCEO B AE KTXX TOEK
         WRITE(NWTR, 54) KTXX, NTGRAF
54       FORMAT(/' *** OCTHT KOHE AOB HAKOEH    ***'/
     = ' *** B APOEHHOM AOOHE OT T0 O TM ***'/
     =          ' *** OHAPEHO BCEO ', I5, ' TOEK PEEH ***'/
     =' *** B APABAETE ', I5, ' TOEK  OCTPOEH PAKA ***'/)
         RETURN
C++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
300      CONTINUE
C-->  . KOHE
         WRITE(NWTR,55) KTXX, NTGRAF, TIME
55       FORMAT(/' *** A HAKOEH PEEH HE  AKPT ***'/
     = ' *** B APOEHHOM AOOHE OT T0 O TM ***'/
     = ' *** OHAPEHO BCEO ', I5, ' TOEK PEEH ***'/
     = ' *** B APABAETE ', I5, ' TOEK  OCTPOEH PAKA ***'/
     = ' *** OCEH TOKA OPEEEHA  T =',G12.5, ' CEK. ***'/
     = ' *** PAOTA PEPBAETC ***********************************'///)
         call STOPP(16)
C++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
         END
