         SUBROUTINE GETNEW( MSWALL, TOKN, TOKN1, VALLN, VALLN1,
     *          YALL, JALL, LOGYTR, WORKX, IRC, YALLHP, WORKY )
CXXX----KOMèãEKC "MS1" --> BEPCàü 1.0  (OT ÑEKAÅPü 1986 É.)------------
C   èOÑèPOÉPAMMA:  GETNEW( MSWALL, TOKN, TOKN1, VALLN, VALLN1,
C   ------------    YALL, JALL, LOGYTR, WORKX, IRC, YALLHP, WORKY )
C
C   HAáHAóEHàE:    - BõóàCãEHàE OóEPEÑHOâ TOóKà "COCTOüHàü" ñEèà:
C   -----------    *** Ñãü T = TN + HXG OèPEÑEãüûTCü TOKN1 à VALLN1 ***
C
C              == èPà IPOL = 0 --> OÅõóHAü àHTEPèOãüñàü, ãàHEâHAü;
C                 èPà IPOL = 1 --> CèEñàAãúHAü, Ñãü METOÑA ãàH.-BàOã.;
C ***ãETO 1987********** BOãEBOE PEòEHàE: èPà DX<ZEROCP, DX=0.0 *****
C
C                      - èPà áAèPOCE (FRUN0 = 1) ---> BõèOãHüETCü
C                        TECT PìHÉE, èPà ùTOM ÑOèìCKAETCü
C                        HE ÅOãEE NRUNG "ÑPOÅãEHàâ" H0DATA;
C                         HXMIN "ÑPOÅàTCü" CàHXPOHHO;
C                      - B CãìóAE, H0 > H0_OLD -> TECT èPOBOÑàTCü BHE
C                        áABàCàMOCTà OT FRUN0;
C
C                      - èPà PONRUN = 1 (CM. MASPRT) BõBOÑàTCü CãEÑìûôEE
C                        TN  <CTAPTOBAü TOóKA>
C                        TN1 <"CTAPAü" TOóKA èPà TN+H0>
C                        TNX1 <HOBAü TOóKA  èPà TN+H0/2>
C                        TNX2 <HOBAü TOóKA  èPà TN+H0/2+H0/2>
C
C
C                      *** èPà FRUNGE = 0 TECT Hà KOÉÑA HE èPOBOÑàTCü **
C                      *** èPà FRUNGE = 2 TECT èPOBOÑàTCü HA KAÜÑOM   **
C                                               òAÉE                ****
C
C
C              == èPà KODSYS = 1 --> PEòEHàE CãAì ÅEá àTEPAñàâ;
C
C              == èPà KODSYS = 2 --> PEòEHàE CãAì C   àTEPAñàüMà;
C                                    EPSSYS--> TOóHOCTú;
C                      ( "KìCOK" -->  "C@CãAì@" );
C
C
C                  - CMEHA COCTOüHàü BEHTàãúHõX ùãEMEHTOB, BOáÅìÜÑEHàE
C                    îãAÉA FKOM B CãìóAE HAãàóàü KOMMìTAñàà BEHTàãEâ...
C                    [ èPà èOBTOPE PACóETA C TOóKà TN, HEOÅXOÑàMO HE
C                      àáMEHüü áHAóEHàâ FKOM, HXG à HX B MSWALL MOÑEãEâ
C                      "BEPHìTú" BEHTàãà B COCTOüHàE èPà T = TN,
C                      Ñãü óEÉO BOCèOãúáOBATúCü è/è RESETX..].
C
C                  - èPà HEOÅXOÑàMOCTà B TN = T0 ( CM. MASPRT )
C                    èPOBEÑEHàE èPOCECCA "OèPEÑEãEHàü àCXOÑHOÉO
C                    COCTOüHàü BEHTàãúHõX ùãEMEHTOB", A TAKÜE B CãìóAE
C                    TXG == TN, T.E. èPà HXG = 0.0 ==> èPOàáBOÑàTCü
C                    SEQTIM BOáBPATOB B "CTAPTOBYû" TOóKY TN PACóETA:
C                    èPà ùTOM -> BõBOÑ àHîOPMAñàOHHOÉO COOÅôEHàü;
C                   ( C.ó.K. SEQTIM - KOHTPOãú "áAñàKãàBAHàü" );
C                    ùTà CàTìAñàà BOáMOÜHõ èPà HXMIN = 0.0;
C
C                  - èPà BõPOÜÑEHàà CàCTEMõ - èPOàCXOÑàT 10-à
C                    KPATHAü èOèõTKA àáÅABàTCü OT ùTOâ CàTìAñàà;
C                    ùTO BOáMOÜHO èPà BKãûóEHàà îãAÉA SEQTRX à èPà
C                    ìCãOBàà HE PABEHCTBA 0.0 èPOBOÑàMOCTà GVENT6;
C                    BHE áABàCàMOCTà OT îãAÉA SEQTRX, èPà PACóETE TOóKà
C                    T = T0, KOHTPOãú BõPOÜÑEHHOCTà CàCTEMõ BKûóAETCü;
C
C                  - èPà áAèPOCAX OT DM... MOHàTOPOB àTEPAñàOHHõX
C                    ìTOóHEHàâ èEPEMEHHõX COCTOüHàü [ TOKN1 ],
C                    BõèOãHüETCü HE ÅOãEE MITER àTEPAñàâ;
C
C                - KAÜÑõâ DM MOHàTOP è.TàèA 2 & 3 èPà ZAPROS=2 BõèOãHüET
C                  CPABHEHàE èPEÑCKAáAHHOÉO áHAóEHàü BEKTOPA "TOK"
C                  (XPAHàTCü B "TOKN1") C BõóàCãEHHõM àCXOÑü àá
C                  áHAóEHàâ VALLN1;
C                B CãìóAE, KOÉÑA EPS=ABS(TOK_ü - TOKN1)/MAX(TOK_ü,TOKN1)
C                  > EITER --> KOD=1 à èPà MAXITR<EPS -->
C                 îàKCàPìETCü HOBOE áHAóEHàE MAXITR=EPS à NLITER=N_ùã-TA
C
C                - **** ìTOóHEHàE COCTOüHàü ***: ùTO-->
C                  BOáÅìÜÑEHàE îãAÉA FITER, óTO TPEÅìET OT DM MOHàTOPOB
C                  è.TàèA 2 & 3 èPà BõóàCãEHàà G-J èAPAMETPOB àCèPOãú-
C                  áOBATú HE èPEÑCKAáAHHõE áHAóEHàü "TOK", A áHAóEHàü
C                  "TOK", XPAHüôàECü B MACCàBE "TOKN1";
C
C                - èPà MITER = 0  -->  KOHTPOãü HA KOD ^=0 HET !!!!!!!!!
C
C
C   METOÑ:         - ÑàCKPETàáAñàü ìPABHEHàâ COCTOüHàü MAKPOMOÑEãEâ
C   -----            HA OCHOBE METOÑA ãàHàÑÜEPA-BàOãìÉÅà (H2^=0) àãà
C                    HE üBHOÉO METOÑA ùâãEPA (H2=0), COCTABãEHàE CàCTEMõ
C                    ãàHEâHõX AãÉEÅ. ìP-àâ à àX PEòEHàE;
C                    ìèPABãEHàE COCTOüHàEM BEHTàãúHõX ùãEMEHTOB HA
C                    OCHOBE àHîOPMAñàà Ñãü TN à TN+H0 MOMEHTA BPEMEHà;
C                    àHTEPèOãüñàü èPà HEOÅXOÑàMOCTà TOKOB à HAèPüÜEHàâ;
C
C                 - èPà èPOBEÑEHàà TECTA PìHÉE -> àCèOãúáìETCü
C                   PAÅOóàâ îAâã HA KAHAãE NFILER; CTEK Ñãü
C                   ÑBìX TOóEK PEòEHàü èPà T = TN  à T = TN1;
C                   KOHTPOãú ãOK. OòàÅKà - èO BEKTOPAM ìáã. HAèPüÜEHàâ;
C
C
C                  - "BõBOÑ" BEHTàãEâ B HAóAãúHOE COCTOüHàE
C                    OCìôECTBãüETCü B TOM CãìóAE, KOÉÑA PEÜàM AHAãà-
C                    áàPìEMOâ ñEèà, áAÑAHHõâ èOãúáOBATEãEM, HE COOTBET-
C                    CTBìET "HAóAãúHOMì" COCTOüHàû BEHTàãEâ.
C                    ( T.E. ECãà HA òAÉE OT "TN=T0" ÑO "TN+H0"
C                      HEKOTOPõE BEHTàãà àáMEHüûT CBOE COCTOüHàE
C                      TAK, óTO TX (BPEMü BOáMOÜHOâ KOMMìTAñàà) = T0,
C                      TO BõèOãHüETCü "HACTPOâKA" ùTàX BEHTàãúHõX
C                      ùãEMEHTOB, KOTOPAü áAKãûóAETCü B CMEHE àX
C                      COCTOüHàü; áATEM TOóKA TN+H0 PACóàTõBAETCü
C                      áAHOBO. ùTA èPOñEÑìPA BõèOãHüETCü HE     OÑàH
C                      PAá, HO TOãúKO B TOóKE T = T0 ).
C
C          ==     B áABàCàMOCTà OT METVET[MASPRT(107)] HXG OèPEÑEãüETCü:
C              =0 - àHTEPèOãüñàü K TXG MEÜÑì "TN"  à  "TN1 =TN+H0";
C              =1 - èEPECóET K TXG OT TN C H0=HXG;
C                   èPà ùTOM HXMIN - MIN BOáMOÜHõâ òAÉ;
C              =2 - "CãàèAHàE" "TN1" C "TXG",
C                   èPà ùTOM CMEHA COCTOüHàâ BEHTàãEâ C
C                    EPSKOM = TN1 - TXG
C              >2 - TO ÜE, óTO à =2, HO EPSKOM HE MOÑàîàñàPìETCü;
C
C          ==  èPà METVET=1 à HXMIN=0 --> PACóET KAK Ñãü METVET=0  ===
C
C
C   èAPAMETPõ:     MSWALL - CîOPMàPOBAHHõâ CèàCOK CãOB COCTOüHàü
C   ---------               MOÑEãEâ ùãEMEHTOB ñEèà;
C                  VALLN, TOKN - HAèPüÜEHàü à "TOKà" ñEèà èPà
C                                T = T0, T.E. B HAóAãúHõâ MOMEHT BPEMEHà
C                                B èOCãEÑCTBàà - B TEKìôàâ "CTAPTOBõâ"
C                                MOMEHT BPEMEHà T.E. B T = TN;
C                  VALLN1 à TOKN1 - TO ÜE Ñãü  TN = TN + HXG  ( H0 );
C                  YALL - MATPàñõ ìáãOBõX èPOBOÑàMOCTEâ;
C                  JALL - BEKTOP àCTOóHàKOB TOKA;
C                  LOGYTR - MACCàB èPàáHAKOB K.á. ìáãOB;
C                           ( Ñãü MAKPOMOÑEãEâ àÑEAãúHõX BEHTàãEâ );
C                 WORKX - PAÅ. MACCàB, PAáMEPHOCTúû HE MEHEE NSYS;
C                  IRC = 1 TOóKA PACóàTAHHA, èPà FKOM = 1 COCTOüHàü
C                          BEHTàãEâ àáMEHEHõ;
C                      = 2 Ñãü MOÑEãEâ C è.TàèOM #2 à/àãà #3 áA MITER
C                          àTEPAñàâ HE ÑOCTàÉHìTA TOóHOCTú EITER;
C                          ( ùTA CàTìAñàü B V.M=2.0 àÉHOPàPìETCü )
C                      = 3 - TECT PìHÉE HE BõèOãHEH, TOóHOCTú HE
C                            ÑOCTàÉHìTA ÑAÜE èOCãE NRUNGE
C                            PAá "ÑPOÅãEHàü" H0DATA;
C
C                      èPà KODSYS = 2 HEOÅXOÑàMO:
C                      WORKY --> PAáMEPHOCTú  <= NSYS;
C                      YALLHP --> PAáMEPHOCTú NDALL * NDALL;
C
C
C   èOÑèPOÉPAMMõ:  1. COMMON PROF1, PROF2, PROF3;
C   -------------  2. GETSYS,   MODVAL,  DECOM0+SOLVE0
C                  3. PRINT4, RSLMC, FACTR;
C   èPàMEóAHàE:
C   ----------
C
CZZZ-------------------------------------------------------------------
         COMMON /PROF1/ MASPRT(200)
         COMMON /PROF2/ MACTAB(1)
         COMMON /PROF3/ FUNTAB(1)
         DIMENSION MSWALL(1), TOKN(1), TOKN1(1), VALLN(1), VALLN1(1)
         DIMENSION YALL(1), JALL(1), LOGYTR(1)
         REAL JALL, MU
         INTEGER FEND, FKOM, ZAPROS, T5MSW, T6MSW, PON, FLOG
         EQUIVALENCE ( MASPRT(29), TN ),
     =               ( MASPRT(30), H0 ),
     =               ( MASPRT(31), MU ),
     =               ( MASPRT(32), H1 ),
     =               ( MASPRT(33), H2 ),
     =               ( MASPRT(50), ZEROCP ),
     =               ( MASPRT(13), NWTR ),
     =               ( MASPRT(14), NWTRE ),
     =               ( MASPRT(35), TXG ),
     =               ( MASPRT(23), NDALL ),
     =               ( MASPRT(37), FLOG ),
     =               ( MASPRT(26), NSYS ),
     =               ( MASPRT(34), FKOM ),
     =               ( MASPRT(41), T5MSW ),
     =               ( MASPRT(49), T6MSW ),
     =               ( MASPRT(46), NNTOK ),
     =               ( MASPRT(56), PON   ),
     =               ( MASPRT(42), T0    ),
     =               ( MASPRT(28), ZAPROS )
         EQUIVALENCE ( HXG, MASPRT(61) )
         EQUIVALENCE ( GVENT6, MASPRT(59) )
         EQUIVALENCE ( EITER,  MASPRT(67) )
         EQUIVALENCE ( FITER,  MASPRT(65) )
         EQUIVALENCE ( MITER,  MASPRT(66) )
         INTEGER FITER, SEQTRX
         EQUIVALENCE ( SEQTRX, MASPRT(64) )
         EQUIVALENCE ( SEQTIM, MASPRT(71) )
         EQUIVALENCE ( NDIVH0, MASPRT(84) )
         EQUIVALENCE ( NFILER, MASPRT(83) )
         EQUIVALENCE ( FRUN0,  MASPRT(82) )
         EQUIVALENCE ( NRUNGE, MASPRT(70) )
         EQUIVALENCE ( ERUNGE, MASPRT(69) )
         EQUIVALENCE ( H0OLD,  MASPRT(81) )
         EQUIVALENCE ( NLITER, MASPRT(79) )
         EQUIVALENCE ( MAXITR, MASPRT(80) )
         EQUIVALENCE ( FRUNGE, MASPRT(68) )
         EQUIVALENCE ( H0DATA, MASPRT(40) )
         EQUIVALENCE ( PONRUN, MASPRT(86) )
         EQUIVALENCE ( NSITER, MASPRT(88) )
         EQUIVALENCE ( PPVENT, MASPRT(106) )
         EQUIVALENCE ( EPSKOM, MASPRT(39)  )
         EQUIVALENCE ( HXMIN,  MASPRT(62)  )
         EQUIVALENCE ( METVET, MASPRT(107)  )
         EQUIVALENCE ( IPOL,   MASPRT(108)  )
         EQUIVALENCE ( KODSYS, MASPRT(109)  )
         EQUIVALENCE ( EPSSYS, MASPRT(110)  )
         EQUIVALENCE ( KODMU,  MASPRT(113)  )
         EQUIVALENCE ( KODMUM,  MASPRT(114)  )
         INTEGER PPVENT
         DIMENSION WORKX(1), WORKY(1), YALLHP(1)
         REAL MAXITR
         INTEGER CASE, FRUN0, FRUNGE, PONRUN, CASE1
         INTEGER SEQTIM
C
C--->  èPà SEQTRX = 1  -  BKãûóAETCü KOHTPOãú HA BõPOÜÑEHHOCTú;
C
         ID(I,J) = NDALL * (J-1) + I
C====>
         DATA IHELPV/ 0 /, IHELP6/0/, K10/10/
         MAXITR = 0.0
         NLITER = 0
        CASE = 0
        CASE1 = 0
        FKOM = 0
C       ********
100    CONTINUE
         IHELP6 = 0
         IHELPV = 0
C--->  KOHTPOãú BKûóàM:
         COND = 0.0
C-->  èPà SEQTRX = 0, BõKãûóàM:
         IF ( SEQTRX .EQ. 0 ) COND = -1.0
C--> èPà TN = T0, KOHTPOãú BKãûóàM èPàHìÑàTEãúHO...
         IF ( T0 .EQ. TN ) COND = 0.0
C---> NITER - C.ó.K. àTEPAñàâ, FITER - îãAÉ àTEPAñàâ....
         NITER = 0
         FITER = 0
         IRC = 1
C======================================================================
C--->   áAîàKCàPìEM BBEÑEHHOE áHAóEHàE GVENT6.......
         HELP6 = GVENT6
         GVENT6 = 0.0
52       CONTINUE
C----------------------------------------------------------------------
C==>  CîOPMàPOBATú CàCTEMì
         CALL GETSYS( MSWALL, YALL, JALL, LOGYTR,
     =                TOKN, TOKN1, VALLN, VALLN1 )
C
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C--->>>   C ã A ì  <<<-------------------------------------------------
C --  METKA  201  --> àTEP. METOÑ.
       GO TO ( 200, 201 ), KODSYS
       CALL SUBERR(KODSYS)
200    CONTINUE
C
C   PEòàTú CàCTEMì < DECOM0 + SOLVE0 >
C===> IPVT  <==> VALLN1
C===> WORK  <==> WORKX
         CALL DECOM0( NDALL, NSYS, YALL, COND, VALLN1, WORKX  )
C
         IF ( COND .NE. COND+1. ) GO TO 1
C--->>  ABAPàü....
202    CONTINUE
C---> ECãà MOÜEM - ùTO ÑEãO èõTAEMCü àCèPABàTú....
         IF ( HELP6 .EQ. 0.0 ) GO TO 15
C---->  ECãà àÑEAãúHõX BEHTàãEâ HET, TO à àCèPABãüTú HEóEÉO.....
         IF ( FLOG .EQ. 0 ) GO TO 15
C---> "BüKHEM"
         T1HELP = TN + H0
         WRITE(NWTRE, 16 )         TN, H0,  T1HELP
16       FORMAT(' *** B TOóKE: TN = ', G12.5, ' H0 = ', G12.5,
     =           ' TN1 = ', G12.5, '     ***'/
     =' ***  CàCTEMA [Y] * [V] = [J] B_õ_P_O_Ü_Ñ_E_H_A ',24X,  ' ***')
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
         IF ( IHELP6 .GT. K10 ) GO TO 15
         IHELP6 = IHELP6 + 1
         RHELP6 = IHELP6
         GVENT6 = RHELP6 * HELP6
         WRITE(NWTRE,14) GVENT6
14       FORMAT(' *** èPOBOÑàMOCTà áAKPõTõX BEHTàãEâ èPàHàMAûTCü PABHõMà
     =', E12.5, ' [CàM]***' )
         GO TO 52
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
15       CONTINUE
C!!!-------------------------------------------------------------------
C  CàCTEMA BõPOÜÑEHA îATAãúHO...............
         WRITE(NWTRE,10) TN, H0
         WRITE(NWTR ,10) TN, H0
10       FORMAT(//' *** CàCTEMA BõPOÜÑEHA  î_A_T_A_ã_ú_H_O   ***'/
     =          ' *** TN = ', E12.5, '  H0 = ', G12.5, ' ***')
C-->
C----------------------------------------------------------------------
C==>  CîOPMàPOBATú CàCTEMì  Ñãü èEóATà....
         CALL GETSYS( MSWALL, YALL, JALL, LOGYTR,
     =                TOKN, TOKN1, VALLN, VALLN1 )
C----------------------------------------------------------------------
C-->
       CALL PRINT4( YALL, JALL, LOGYTR )
C-->
C!!!-------------------------------------------------------------------
         CALL SUBERR(1)
1        CONTINUE
C===> PEòàTú CàCTEMì
         CALL SOLVE0( NDALL, NSYS, YALL, JALL, VALLN1, IRC )
C---> IRC - èOKA HE AHAãàáàPìEM.....
C===> PEòEHàE B VALLN1.....
         DO 20 I=1,NSYS
           VALLN1(I) = JALL(I)
20       CONTINUE
C
C--->> CãAì PEòEHõ.........
203    CONTINUE
C--->  BOCTAHOBàTú CTAPOE GVENT6
         GVENT6 = HELP6
C===> BãûóEH ãà AèèAPAT FLOG ?
         IF ( FLOG .EQ. 0 ) GO TO 60
C---> OèPEÑEãàTú TOKà OTKPõTõX BEHTàãEâ... ( B TOKN1 )
         KF = 3
         ZAPROS = 20
         CALL CALLDM(KF, MSWALL, YALL, JALL, LOGYTR,
     =               TOKN, TOKN1, VALLN, VALLN1, KODMD )
C--->
C===> MOÑàîàñàPìEM PEòEHàE COÉãACHO LOGYTR.......
         CALL MODVAL( VALLN1, LOGYTR )
60       CONTINUE
C==> OèPEÑEãàM HOBõE TOKà HA ùãEMEHTAX "èOCTOüHHOâ" CTPìKTìPõ.....
         ZAPROS = 2
C===> OèPOC BCEX DM...., KPOME àÑEAãúHõX BEHTàãEâ
         KF = 5
         CALL CALLDM(KF, MSWALL, YALL, JALL, LOGYTR,
     =               TOKN, TOKN1, VALLN, VALLN1, KODMD )
C
C--->  èPà MITER = 0, KOHTPOãü HET !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
       IF ( MITER .EQ. 0 ) GO TO 61
C--->
C---> ECTú ãà áAèPOCõ HA "àTEPAñàà"
         IF ( KODMD . EQ. 0 ) GO TO 61
C---> èPOCüT àTEPAñàâ.....
C======================================================================
C    MAKPOMOÑEãà è.TàèA #2 à/àãà #3   áAèPOCàãà ÑOÅABOóHõE
C              àTEPAñàà Ñãü ìTOóHEHàü èPEÑCKAáAHHõX áHAóEHàâ "TOK"
C              B ùTOM CãìóAE KODMD ^= 0
C
C        HEOÅXOÑàMO:
C OèPOCàTú DM... MOHàTOPõ C ZAPROS = 1 èPà BOáÅìÜÑEHàà FITER = 1 îãAÉA;
C DM... MOHàTOPõ B ùTOM CãìóAE ÑOãÜHõ àCèOãúáOBATú HE èPEÑCKAáAHHõE
C àMà áHAóEHàü "TOK", A áHAóEHàü àá MACCàBA "TOKN1"
C
C --->  BKãûóAEM FITER
         FITER = 1
C--->  îàKCàPìEM àTEPAñàû
         NITER = NITER + 1
C--->  èOBTOPüEM, ECãà ùTO BOáMOÜHO....
         IF ( NITER .LE.  MITER ) GO TO 52
C--> èPàEXAãà.....
         WRITE(NWTRE, 62 ) MITER, EITER, TN, H0
62     FORMAT(' *** B MOÑEãüX è.TàèA 2 à/àãà 3 áA ', I3,' àTEPAñàâ ',
     =     25X, '***'/
     =' *** TOóHOCTú ', G12.5, ' HE ÑOCTàÉHìTA ( TN=', G10.5,
     = ' H0=',G12.5, ' ***')
       WRITE(NWTRE,63) MAXITR, NLITER, NSITER
63     FORMAT(' *** MAX. èOÉPEòHOCTú ', G12.5,' BHOCàT ùãEMEHT # ',
     =  I5, ' (CM.#', I3, ') ', 5X, '***' )
C--->  ùTO èOKA àÉHOPàPìEM....!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
         IRC = 2
C---> DIGITA - MOÜET èOBTOPàTú PACóET èPà MEHúòEM H0..........
C
C======================================================================
C
61       CONTINUE
C--->  îãAÜEK, TO CÅPOCàM...
         FITER = 0
C
C===> TOKN  à TOKN1 OèPEÑEãEHõ Ñãü BCEX ùãEMEHTOB...èPà T => TN I TN1
C      VALLN  à  VALLN1 àáBECTHõ.....
CTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
CTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
CTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
C   T_E_C_T_____P_ì_H_É_E
C
700    CONTINUE
       GO TO ( 701, 704 ), CASE
C-->  HìÜEH ãà TECT?
C
C***>  èPà FRUNGE = 2 --->  TECTàPOBAHàE HA KAÜÑOM òAÉE !!!!!!!!!!!!!!!
C
C
       IF ( FRUNGE .EQ. 0 ) GO TO 799
       IF ( FRUNGE .EQ. 2 ) GO TO 710
C-->  èPà FRUN0 = 1 àãà èPà H0 > H0OLD  TECTàPìEM....
       IF ( FRUN0 .EQ. 0  .AND.  H0 .LE. H0OLD ) GO TO 799
C++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
710    CONTINUE
C-->  îàKC. èEPEMEHHõE
       H0OLD = H0
       H1OLD = H1
       H2OLD = H2
       TNOLD = TN
       TN1OLD = TN + H0
C----------------------------------------------------------------------
        KAKA5=5
       IF ( PONRUN .EQ. 1  .AND.  PON .EQ. 1 )
     =                      CALL DRPR01(KAKA5,  TNOLD, TOKN, VALLN )
       IF ( PONRUN .EQ. 1  .AND.  PON .EQ. 1 )
     =                      CALL DRPR01(KAKA5,  TN1OLD, TOKN1, VALLN1 )
C----------------------------------------------------------------------
C-->  îàKC. TOóKà B CTEKE HA KAHAãE NFILER...
       REWIND NFILER
       WRITE(NFILER) TN1OLD, ( VALLN1(I), I=1,NSYS)
       WRITE(NFILER) TN1OLD, ( TOKN1(I), I=1,NNTOK)
       WRITE(NFILER) TNOLD, ( VALLN(I), I=1,NSYS)
       WRITE(NFILER) TNOLD, (  TOKN(I), I=1,NNTOK)
       END FILE NFILER
C-->  àáMEHüEM òAÉ
C-->
       H0 = H0OLD / 2.0
       H1 = H1OLD / 2.0
       H2 = H2OLD / 2.0
C-->  CóET HOBOâ TOóKà  Ñãü TN + H0/2, îàKCAñàü B VALLN1 à TOKN1...
       CASE = 1
       GO TO 100
701    CONTINUE
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C--->  TOóKA Ñãü T = TN + H0/2  ---> B VALLN1 à TOKN1
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C-->  îàKCàPìEM
       TN = TN + H0
       DO 702 I = 1, NSYS
702    VALLN(I) = VALLN1(I)
       DO 703 I = 1, NNTOK
703    TOKN(I) = TOKN1(I)
C----------------------------------------------------------------------
       IF ( PONRUN .EQ. 1  .AND. PON .EQ. 1 )
     =                      CALL DRPR01(KAKA5, TN,      TOKN, VALLN )
C----------------------------------------------------------------------
C-->  PACóET Ñãü T = TN + H0/2 + H0/2  "HOBõâ" BõPàAHT..
       CASE = 2
       GO TO 100
704    CONTINUE
        CASE = 0
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C   TOóKA  Ñãü  T = TN +H0/2 +H0/2  -->  B VALLN1 à TOKN1
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
        TN1X = TN + H0
C----------------------------------------------------------------------
       IF ( PONRUN .EQ. 1  .AND. PON .EQ. 1 )
     =                      CALL DRPR01(KAKA5,   TN1X,  TOKN1, VALLN1 )
C----------------------------------------------------------------------
C--->  BõóàCãàM èOÉPEòHOCTú...
        REWIND NFILER
C-->  óàTAEM B JALL  CTAPOE VALLN1...
       READ(NFILER) TXX, ( JALL(I), I=1,NSYS)
C-->  CPABHEHàü
       EPSMAX = 0.0
       IMAX = 0
       DO 714 I = 1, NSYS
       X1 = ABS( VALLN1(I) )
       X2 = ABS( JALL  (I) )
       IF ( X1 .LE. ZEPOCP  .OR.  X2 .LE. ZEROCP ) GO TO 780
       XZ = AMAX1( X1, X2 )
       EPS = ABS(X1 - X2) / XZ
       GO TO 781
780    CONTINUE
C-->  OÑHO àá óàCEã ÅãàáKO K Hìãû.....
       EPS = ABS( X1 - X2 )
781    CONTINUE
       IF ( EPS .LT. EPSMAX ) GO TO 714
C-->  îàKCàPìEM...
       IMAX = I
       EPSMAX = EPS
714    CONTINUE
C-->           àTOÉOBõâ KOHTPOãú....
       IF (  EPSMAX .LE. ERUNGE ) GO TO 705
C-->  TECT HE èPOòEã.....
       WRITE( NWTRE, 706 ) TNOLD, TN1OLD, IMAX, EPSMAX, ERUNGE
706    FORMAT(' *** HA [', G12.5, ' -:- ', G12.5, ' ]  Ñãü ìáãA # ',
     =  I5, ' ***'/
     = ' *** ãOK. èOÉPEòHOCTú ', G10.5, ' ÅOãúòE áAÑAHHOâ ', G10.5,
     =  ' ***' )
C-->CMEHA òAÉA à TOóKà, MAKET HOBOâ TOóKà Ñãü T = TN(CTAPOE) + H0OLD/2
C-->
       DO 707 I=1,NSYS
707    VALLN1(I) = VALLN(I)
       DO 708 I=1, NNTOK
708    TOKN1(I) = TOKN(I)
C-->  BOCTAHOBàM "CTAPõE" TOKN à VALLN àá NFILER_A
C-->  èPOèìCTàM áAèàCú OÅ TOKN1
       READ(NFILER)
C-->  BOCTAHABãàBAEM...
       READ(NFILER) TXX, (VALLN(I), I=1, NSYS )
       READ(NFILER) TXX, (TOKN(I), I=1, NNTOK )
       TN = TNOLD
C--> èOÑÑPEPÜàM "CãìÜÅì" BPEMEHà....
       HXG = H0
       TXG = TN + H0
C-->  ìMEHúòàM H0DATA....
       H0DATA = H0DATA / 2.0
       HXMIN = HXMIN / 2.0
C--> H1, H0, H2 --> ìÜE àáMEHEHõ..
       XX = H0DATA * 1.8E+4
       WRITE(NWTRE, 709 ) H0DATA, XX
709    FORMAT(' *** áAÑAHHõâ òAÉ H0DATA àáMEHEH HA ', G12.5,
     = ' (',G10.5,' ) ***')
C-->  KOHTPOãú áAñàKã.
       NDIVH0 = NDIVH0 + 1
       IF ( NDIVH0 .LE. NRUNGE ) GO TO 710
C-->  èPàEXAãà.....
       WRITE(NWTRE, 711) NRUNGE, H0DATA
711    FORMAT( /' *** èPEBõòEHO ÑOè. KOã-BO "ÑPOÅãEHàâ" òAÉA H0DATA ',
     = I5, ' ***'/
     = ' *** "TECT PìHÉE" OTKãûóAETCü, PACóET BEÑETCü C H0DATA = ',
     = G12.5, ' ***'/)
       WRITE(NWTR, 711) NRUNGE, H0DATA
       FRUNGE = 0
       IRC = 3
C-->  MAKET -->  TECT èPOòEã....
       GO TO 705
C++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
705    CONTINUE
C-->  TECT èPOòEã....
C-->  BOCTAHOBãEHàE "ÉãOÅAãúHOE"
       REWIND NFILER
       READ(NFILER) XX, ( VALLN1(I), I=1,NSYS)
       READ(NFILER) XX, ( TOKN1 (I), I=1,NNTOK)
       READ(NFILER) XX, ( VALLN (I), I=1,NSYS)
       READ(NFILER) XX, ( TOKN  (I), I=1,NNTOK)
C-->
       TN = TNOLD
       H0 = H0OLD
       H1 = H1 OLD
       H2 = H2 OLD
       HXG = H0
       TXG = TN + H0
C-->  BCE....
799    CONTINUE
CTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
CTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
CTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
C==> ÅõãA ãà KOMMìTAñàü?( ECãà T5MSW à T6MSW = 0, TO HET HEOÅXOÑàMOCTà )
C    èEPEOèPEÑEãüTú TX_G BPEMü PEAãúHOÉO òAÉA...)
C
         IF ( T5MSW .EQ. 0  .AND. T6MSW .EQ. 0 ) GO TO 3
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
       FKOM = 0
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C===> TX_G  HAâTà...
C--->  ÜÑEM KOM-û...
         ZAPROS = 3
         KF = 2
         CALL CALLDM( KF, MSWALL, YALL, JALL, LOGYTR,
     =                TOKN, TOKN1, VALLN, VALLN1, KODMD )
3        CONTINUE
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
       GO TO ( 851 ), CASE1
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C
C====>  ÅõãA  ãà  K O M ì T A ñ à ü ?????
         IF ( FKOM .EQ. 0 ) GO TO 40
C######################################################################
C  O Å P A Å O T K A   K O M ì T A ñ à à ..............................
C######################################################################
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C  OT 21.10.86.
       IF ( METVET .EQ. 0 ) GO TO 820
       IF ( METVET .EQ. 1 ) GO TO 850
       IF ( METVET .EQ. 2 ) GO TO 880
C@@@ àHAóE KAK  = 2, HO ÅEá MOÑ. EPSKOM @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
       GO TO 890
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
820    CONTINUE
C***** à H T E P è O ã ü ñ à ü   **************************************
C===>  àáMEHàTú COCTOüHàE BEHTàãEâ...
         ZAPROS = 4
         KF = 2
         CALL CALLDM( KF, MSWALL, YALL, JALL, LOGYTR,
     =                TOKN, TOKN1, VALLN, VALLN1, KODMD )
C
C******> ìCTAHOBàTú "HEüBHõâ ùâãEP", T.K. B ùTOM CãìóAE FKOM = 1
C  èPà ìCãOBàà KODMU=0 ...........
         IF ( KODMU .EQ. 1 ) GO TO 54321
         H1 = H0
         H2 = 0.0
54321    CONTINUE
C
C
C
C
C**********************************************************************
C**********************************************************************
C====> "HACTPOâKA" BEHTàãEâ====>  TOãúKO Ñãü òAÉA T0 <===> T0+H0
C====>  ECãà TX = T0, TO èOèõTKA PACóETA ñEèà  OT CTAPOâ
C====> "CTAPTOBOâ" TOóKà, èPà ùTOM COCTOüHàü BEHTàãEâ ìÜE àáMEHEHõ;
C====>  ùTA èOñEÑìPA BõèOãHüETCü #HE CTPOÉO# OÑàH PAá Ñãü TN = T0 à
C====>  BCEÉO SEQTIM PAá Ñãü TN ^= T0:
C######################################################################
C######################################################################
         IF ( ABS(TXG-T0) .GT. ZEROCP ) GO TO 50
C===>   #èOMOÉAEM#  à èOBTOPüEM, ECãà ùTO èPà T  = TN
         TXG = T0 + H0
         HXG = H0
         GO TO 52
50       CONTINUE
C!!!@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
         IF ( HXG .NE. 0.0 ) GO TO 55
C---> "èPÅìKCOBõBAHàE" !!!COOÅôEHàE ÅãOKàPOBAHO (13.01.87)!!!
         TN1 = TN + H0
C        WRITE(NWTRE, 56 ) TN1,     TN
56       FORMAT(            ' *** èPà TN1=', G12.5, ' "CÅPOC" B "CTAPTOB
     =ìû" TOóKì TN=',G12.5,' ***')
         IHELPV = IHELPV + 1
         TXG = TN + H0
         HXG = H0
         IF ( IHELPV .LE. SEQTIM ) GO TO 52
C-@@@@@@@
         WRITE(NWTRE, 57) SEQTIM, TN, METVET
         WRITE(NWTR,  57) SEQTIM, TN, METVET
57    FORMAT(//' *** BõèOãHEHO ', I5,' "CÅPOCOB" PACóETA B "CTAPTOBìû"',
     =  ' TOóKì TN=', G12.5, ' ***'/
     = ' *** PACóET èPEPõBAETCü -> METVET=', I3, '     ***'///)
         CALL SUBERR(0)
55       CONTINUE
C!!!@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C**********************************************************************
C@@@@
       IF ( METVET .GE. 2 ) GO TO 856
C          @@@@@@@@@@@@@@@
C----------------------------------------------------------------------
C**********************************************************************
C===>   àHTEPèOãüñàü [TOKN]  <=> [TOKN1]  B  [TOKN1]
C===>   àHTEPèOãüñàü [VALLN] <=> [VALLN1] B  [VALLN1]
C
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
       IF ( IPOL .EQ. 0 ) GO TO 900
C-->> CèEñ. àHTEPèOã. àá TN <-> TN1 B TXG ( XPAHàTú B "N1" )
       D1X = (H1 - HXG) / H0
       D2X = (H2 - HXG) / H0
       DO 901 I = 1, NSYS
       VN1 = VALLN1(I)
       VN  = VALLN (I)
       VALLN1(I) = D1X * VN1 + D2X * VN  - HXG * ( VN1 - VN )
901    CONTINUE
C---
       DO 902 I=1, NNTOK
       TTN1 = TOKN1(I)
       TTN  = TOKN (I)
       TOKN1(I) = D1X * TTN1 + D2X * TTN - HXG * ( TTN1 - TTN )
902    CONTINUE
       GO TO 903
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
900    CONTINUE
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C  KOHTPOãú àHTEPèOãüñàà ...
       IF ( HXG .GT. H0 ) GO TO 800
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C*******>DTX = (TX - TN ) / H0
         DTX = HXG / H0
         DO 4 I = 1, NSYS
         VN = VALLN(I)
         DVN1 = VALLN1(I) - VN
C******** BOãEBOE PEòEHàE:
         IF ( ABS(DVN1) .LT. ZEROCP ) DVN1 = 0.0
         VALLN1(I) = VN + DVN1 * DTX
4        CONTINUE
C----------------------------------------------------------------------
         DO 5 I=1,NNTOK
         TTN = TOKN(I)
         DTN1 = TOKN1(I) - TTN
C******** BOãEBOE PEòEHàE:
         IF ( ABS(DTN1) .LT. ZEROCP ) DTN1 = 0.0
         TOKN1(I) = TTN + DTN1 * DTX
5        CONTINUE
C*******BCE********
903    CONTINUE
802    CONTINUE
C!!!-------------------------------------------------------------------
         TN1 = TN + HXG
         IF ( PON .EQ. 1  .AND. PPVENT .EQ. 1 )
     =                     CALL DRPR01( 4, TN1, TOKN1, VALLN1 )
C!!!-------------------------------------------------------------------
         RETURN
40       CONTINUE
C===> KOMìTAñàà HE ÅõãO....
C     TOKN1  à   VALLN1  Ñãü  T  =  TN + HXG  OèPEÑEãEHõ
         RETURN
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
800    CONTINUE
       TXG = TN + HXG
       WRITE(NWTRE,801)  TN, H0, TXG, HXG, METVET
801    FORMAT( ' *** ABAPàü B ÅãOKE àHTEPèOãüñàà...[GETNEW]:',
     =  5X, '(METVET=', I2, 10X, ' ***'/
     = ' *** TN=',E12.5,' H0=',E12.5,' TXG=',E12.5,' HXG=',E12.5,
     = ' ***'  )
       GO TO 802
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
850    CONTINUE
C@@@ èEPECóET....
C@@  COCTOüHàE HE MEHüEM, A CóàTAEM C H0 = HXG.....
       IF ( HXG .EQ. 0.0 ) GO TO 820
       CASE1 = 1
       H0M1 = H0
       H0 = HXG
       TXG = TN + H0
       GO TO 52
C-->  èO CASE1 ....
851    CONTINUE
       H0 = H0M1
C-->  èEPECóàTAãà K TOóKE TN+HXG ....
       IF ( FKOM .EQ. 1 ) GO TO 852
C***
       WRITE(NWTRE, 85344 ) TN, HXG, METVET, HXMIN, EPSKOM
85344  FORMAT(' *** èPOèìCK KOMMìTAñàà TN=', G12.5, ' HXG=',G12.5,
     = ' ***'/
     = ' *** METVET=', I3, ' HXMIN=',G12.5, ' EPSKOM=', G12.5, ' ***')
       GO TO 853
C-->  àáMEHàM COCTOüHàE BEHTàãEâ...
852    CONTINUE
C=
         ZAPROS = 4
         KF = 2
         CALL CALLDM( KF, MSWALL, YALL, JALL, LOGYTR,
     =                TOKN, TOKN1, VALLN, VALLN1, KODMD )
C
853    CONTINUE
C-->  èEóATú "KOMMìTAñàà" :::
       TN1 = TN + HXG
       IF ( PON .EQ. 1 .AND. PPVENT .EQ. 1 )
     =                 CALL DRPR01( 4, TN1, TOKN1, VALLN1 )
       CASE1 = 0
       RETURN
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
880    CONTINUE
C-->  "CãàèAHàE"
C-->  HOBõâ EPSKOM....
       EPSOLD = EPSKOM
C-->   EPSKOM = (TN+H0) - (TN+HXG)
       EPSKOM = H0 - HXG
       IF ( EPSKOM .LT. 0.0 ) WRITE(NWTRE,8805) TN, H0, HXG, EPSKOM
8805   FORMAT(' *** TN=',G12.5,' H0=',G12.5,' HXG=',G12.5,
     =         ' EPSKOM=', G12.5, ' ***')
885    CONTINUE
C===>  àáMEHàTú COCTOüHàE BEHTàãEâ...
         ZAPROS = 4
         KF = 2
         CALL CALLDM( KF, MSWALL, YALL, JALL, LOGYTR,
     =                TOKN, TOKN1, VALLN, VALLN1, KODMD )
C
       EPSKOM = EPSOLD
C-->  ÑAãEE TAK ÜE KAK Ñãü METVET=0    KPOME àHTEPèOãüñàà..
       GO TO 50
856    CONTINUE
C-->  B "N1" PEáìãúTAT ... èEóATAEM...
       TN1 = TN + HXG
       IF ( PON .EQ. 1 .AND. PPVENT .EQ. 1 )
     =      CALL DRPR01( 4, TN1, TOKN1, VALLN1 )
C@@@@@ C ã à è A H à E  @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
       HXG = H0
       TXG = TN + HXG
       RETURN
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
890    CONTINUE
C-->  ÅEá MOÑ. EPSKOM_A...
       EPSOLD = EPSKOM
       GO TO 885
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C
C@CãAì@ ---------------------------------------------------------------
201    CONTINUE
C-->  CãAì C àTEP. ìTOó.
C  YALLHP  --> àCXOÑHAü, YALL - ÑEKOMèOáàPOBAHAü...
C
C-->  XPAHàM...
       DO 205 I=1,NSYS
       DO 206 J=1,NSYS
       IDHH = ID(I,J)
       YALLHP(IDHH) = YALL(IDHH)
206    CONTINUE
205    CONTINUE
C-->  YALL = L * U,  PER -> WORKY
       CALL FACTR( YALL, WORKY, NSYS, NDALL, IERFAC )
C
       IF ( IERFAC .EQ. 0 ) GO TO 207
C-->  TOóHOE BõPAÜÑEHàE
       WRITE(NWTRE, 2000) TN
2000   FORMAT(' *** YALL HE îAKTOPàáìETCü TN=',G12.5, ' ***' )
C
       GO TO 202
207    CONTINUE
C-->  èPOÅìEM PEòATú..
       EPSXXX = EPSSYS
       CALL RSLMC(YALLHP, YALL, JALL, VALLN1, NSYS, EPSXXX,
     =            IERRSL, NDALL, WORKX, WORKY )
C
C-->  ???
       IF ( IERRSL .EQ. 0 ) GO TO 203
C
       GO TO (211, 212, 213, 214 ), IERRSL
       CALL SUBERR(IERRSL )
211    CONTINUE
C-->  TOóHA TOãúKO HOPMA..
C@@@@@@WRITE(NWTRE,2001)     TN
2001   FORMAT(' *** B CãAì TOóHOCTú -> TOãúKO Ñãü',
     =  ' HOPMõ PEòEHàü TN=',G12.5,  ' ***' )
C-->  àÉHOPàPìEM..
       GO TO 203
212    CONTINUE
C-->  TOóHOCTú HOPMõ HàÜE áAÑ.
       WRITE(NWTRE,2002)         EPSXXX, TN
2002   FORMAT(' *** B CãAì',
     =  ' PEòEHàE C TOóHOCTúû =',G12.5, ' TN=',G12.5,   ' ***' )
C-->  IGNORE
       GO TO 203
213    CONTINUE
C-->  HET CMõCãA..
       WRITE(NWTRE,2003) TN
2003   FORMAT(' *** PEòEHàE CãAì HE àMEET CMõCãA TN=', G12.5, ' ***' )
       GO TO 202
C
214    CONTINUE
C-->  YALL = L*U  -->  B U --> 0-ãú B ÑàAÉOHAãE...
       WRITE(NWTRE,2004) TN
2004   FORMAT(' *** CãAì -> Hìãà B ÑàAÉOHAãà [U] TN=',G12.5, ' ***')
       GO TO 202
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
         END
