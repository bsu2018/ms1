         SUBROUTINE APF GET ( ICAR, RCAR, IER, NRDR, NWTR, DIALOG)
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C      OPOPAMMA:  APF GET ( ICAR, RCAR, IER, NRDR, NWTR, DIALOG)
C      ------------
C      HAHAEHE:    BBO TEKCTOBO HOPMA C KAHAA NRDR,
C      ----------     PABKA BBEEHHO HOPMA HA OECKE
C                     TEPM. P KAOM OPAEH BEETC OH
C                     TEPM. B CAE PX OOK - EAT COOEH
C                     HE NWTR, B OPMATE ABCEM OT HAEH DIALOG.
C                     B TOM CAE IER = 1. P OCTEH KOHA
C                     AA HA NRDR - IER = 2.
C      METO:         OEMEHTHA "OKAKA" TEPMOB.
C      -----
C      APAMETP:    ICAR - OEPEHO BBEEHH C NRDR TEPM (INTEGER*4);
C      ---------     RCAR - OEPEHO BBEEHH C NRDR TEPM (REAL*4);
C                    IER  - = 0  -> CEHOE BEEHE TEPMA;
C                           = 1  ->  PE OK, ACT BBOMX
C                                   CTPOK HOPPOBAOC;
C                           = 2  -> HEOAHH KOHE AA HA NRDR;
C                     NRDR, NWTR - KAHA BBOA/BBOA;
C                     DIALOG - = 0 -> AKETH PEM;
C                              = 1 -> TEPAKTBH PEM;
C     OPOPAMM: APFTEM, APFTRT, APFSQE, APFPAK;
C     ------------
C     PMEAHE:  1. PABO PAEH HA TEPM CM. B APFTEM;
C     ----------   2. P DIALOG = 1 ---> IER BCEA = 0;
C                  3. BOMOHO OPAEHE: CALL APFGET(ICAR, ICAR, ...
CZZZ-------------------------------------------------------------------
         EQUIVALENCE ( RSIM(1), SIM(1) )
         INTEGER DIALOG, ER, SIM, FLAG, TEKS, EORDR, BLANK
         DIMENSION KAR(80), SIM(80), RSIM(80), ER(80)
         DATA FLAG/0/, EORDR/0/, BLANK/' '/
         IER = 0
         IF ( EORDR .EQ. 1 ) GO TO 999
         IF ( FLAG  .EQ. 1 ) GO TO 100
C
C===> K TEH  BEEH TEPMOB
C
10       DO 1 I=1,80
1        KAR(I)=BLANK
         READ(NRDR,600, END=999) (KAR(I),I=1,80)
600      FORMAT(80A1)
         IF ( DIALOG .EQ. 0 ) WRITE(NWTR,601) (KAR(I),I=1,80)
601      FORMAT( 20X,80A1 )
C===== EPEEM B F-KO:
         CALL APF TEM(KAR, MAXS, SIM, RSIM, ER, IX )
         IF ( IX .EQ. 0 ) GO TO 11
C==== PE OK
         IF ( DIALOG .EQ. 0 ) WRITE(NWTR,602) IX, (ER(I),I=1,80)
         IF ( DIALOG .EQ. 1 ) WRITE(NWTR,603) IX, (ER(I),I=1,80)
602      FORMAT(1X,'*** OOK ', I3, ' ***=>',80A1)
603      FORMAT(80A1/' <== CPABTE OK B CTPOKE ==> ')
         IF ( DIALOG .EQ. 1 ) GO TO 10
         IER = 1
         GO TO 10
C===> OOK HET, CTAHOBM AAOH CKAHPOBAH
11       FLAG = 1
         TEKS = 1
         GO TO 100
C
C====> TEK BXO
C
100      CONTINUE
C====  TEPM OCTEH?  HEOXOMO TAT HOB PO...
         IF ( TEKS .GT. MAXS ) GO TO 10
         ICAR = SIM(TEKS)
         RCAR = RSIM(TEKS)
         TEKS = TEKS + 1
         RETURN
C
C===== HEOAHH KOHE AA HA NRDR
C
999      EORDR = 1
         IER = 2
         RETURN
         END
