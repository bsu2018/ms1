         SUBROUTINE GETMSW( BA0, KNOT, PAR0, MSWALL, IER )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C
C      OPOPAMMA: GETMSW( BA0, KNOT, PAR0, MSWALL, IER )
C      ------------
C
C      HAHAEHE: -  OPMPET CCOK PABX COB MAKPOMOEE
C      -----------    MSWALL  [ M_ACRO S_TATUS W_ORD ],
C                     COEPAEO BHTPEHHEE OCAHE MAKPOMOEE;
C                  - KCPET HOMEP HAAA EPBOO OCAH B MSWALL
C                    EMEHTOB C PHAKOM TA MOE PABHM # 5
C                    ( T5MSW = MASPRT(41) );
C                  - KCPET HOMEP HAAA EPBOO OCAH B MSWALL
C                    EMEHTOB C PHAKOM TA MOE PABHM # 6
C                    ( T6MSW = MASPRT(49) );
C                  - OPEEET KOECTBO BBOHX HAEH TOKOB 
C                    CE. EPEMEHHX ( COACHO O MACTAB(6) ),
C                    OEHHOE HAEHE   ===>  ACBAETC B
C                    NNTOK OE MASPRT(46);
C                  - P HA EMEHTOB, MOEPEMX MAKPO-
C                    MOEM C EAHM BEHTM ( .T # 6 ) -
C                    BOAET A  FLOG  ( MASPRT(37) <-- 1 );
C                    !!! BHMAHE !!! PEOOAETC, TO HOPMA
C                     B MSWALL OTCOPTPOBAHA O O "PHAK TA";
C
C      METO:       AOHEHE MSW COACHO HOPMAOHHX MACBOB
C      -----        BA0, KNOT  PAR0; ETAHA HACTPOKA
C                   KOHKPETHO MAKPOMOE POBOC /
C                   C MEHAM FM_XXXX ( CM. TA. MACTAB )
C                   HACTPOKA AKAETC B BCEH BCEX
C                   HEOXOMX KOHCTAHT, COEMX B
C                   / DM_XXXX - PACETA MAKPOMOE;
C
C                    OECKO CB MCW COB--> P HEOXOMOCT
C                       BBAET  CALLLM - / POCMOTPA MSW_ALL
C                        BOBA P APOCE ( EPE MACTAB OCAHE )
C                       COOTBET. LM..@..  MOHTOPOB HACTPOK..
C
C
C
C     APAMETP:    HOPMAOHHE MACB:
C     ---------     BA0 - MACCB CCKA EMEHTOB;
C                   KNOT - MACCB CCKA OB OKEH;
C                   PAR0 - MACCB CCKA APAMETPOB;
C                          ( CM. INPUT0 );
C                   MSWALL - MACCB PABX COB MAKPOMOE;
C                   IER -  = 0  BCE T MOEE OCTH;
C                          = N  T HOMEP N HE OCTEH,
C                               (AHE POCMOTP BA0
C                                PEKPAEH);
C                          = 1 - LM MOHTOP BB OECK OK;
C                          ******************************************
C
C
C     OPOPAMM: 1. CALLFM - "BBAK" MOHTOPOB FM..@...
C     ------------
C                   2. COMMON PROF1, PROF2, PROF3
C                   3.         SUBERR;
C                   4. CALL_LM - "BBAK" MOHTOPOB LM..@..
C
C
C    PMEAHE:    1. OCE CEHOO OPMPOBAH MSWALL
C    ----------        MACCB BA0, KNOT  PAR0 HE HH;
C                   2. CTPKTPA BBAEO PEOEH FM.( B CALLFM):
C                      CALL FM.....( BA0T, KNOTT, PAR0T,
C                                    MSW<EPEMEHHA ACT>,
C                                    LM );
C                      EC:
C                      ...T - TEKE EMEHT MACCBOB,
C                      MSW<EP. ACT> - TEKEE MECTO B MSWALL,
C                      HO !!!BHMAHE!!! HAHA C O "SMP"
C                       ( MH CCOK OB );
C                      LM - HA EPEMEHHO ACT OCAH MSW;
C                      ( HA TOKO OE SPM  SRAB );
C
C                   3. PEOOAETC, TO BA0 OTCOPTPOBAH O
C                      BOPACTAH PHAKA TA MAKPOMOE;
C
C
C                  CTPKTPA MACCBA  MSWALL:
C                  --------------------------
C
C  +-------------...+------+------------+------------+...+----------+
C  I            I   I AP. I"OCTOHHA"I"EPEMEHHA"I   IAP. CE.I
C  I CKPTOP I   I CE.I ACT MSW  I ACT MSW  I   I       I
C  I            I   I MSW  I (INTEGER*4)I            I   I  HO [0]I
C  +------------+...+------+------------+------------+...+----X-----+
C  I1 2 3 4 5   I   I  1   I   8 COB   I    ????    I        I
C  +------------+   +------+------------+------------+        I
C                      I                                      I
C                      V                                      I
C                      +>------------------------------------>+
C
C
C               "OCTOHHA" ACT MSW:
C                ----------------------
C
C  +-------+--------+--------+--------+------+------+----------+------+
C  I HOMEP I HOMEP  I HOMEP  I PHAKI KO I KO. I AP. BB.I PE   I
C  I EME I TA   I /    I TA   I ECT I BB. I HA. B  I E   I
C  I HTA   I MOE I PACETAI        I BO   I HA I "TOKN"  I PB   I
C  I       I        I DM.....I        I OBI EH.I B "TOKN1"I      I
C  +-------+--------+--------+--------+------+------+----------+------+
C  I  1    I   2    I   3    I    4   I   5  I  6   I    7     I  8   I
C  +-------+--------+--------+--------+------+------+----------+------+
C
C
C               "EPEMEHHA" ACT MSW:
C               -----------------------
C
C  +----------++-------------+-------------+
C  I CCOK   II CCOK      I PAOA     I
C  I OB    II BHTPEHHX  I OACT     I
C  I OK-  II APAMETPOB  I MAKPOMOE I
C  I EH    II MAKPOMOE I             I
C  I EMEHTA II             I             I
C  I          II             I             I
C  +----------++-------------+-------------I
C  I 9+K"OBII   SPM       I  SRAB       I
C  +----------++-------------+-------------+
C
C  EPEMEHHA ACT OHOCT AOHETC / FM.... HA OCHOBE "OTPEKOB"
C  HOPMAOHHX MACCBOB BA0, KNOT, PAR0
CZZZ-------------------------------------------------------------------
         COMMON/PROF1/ MASPRT(200)
         COMMON/PROF2/ MACTAB(800)
         COMMON/PROF3/ FUNTAB(50)
         DIMENSION BA0(*), KNOT(*), PAR0(*), MSWALL(*)
         INTEGER BA0, FM, TIP, TKEL, FMM, DM, ADRMSW, T5MSW
         INTEGER PTIP, T6MSW, ADRTOK, T4MSW
         IER = 0
C===> KAHA EAT
         NWTR = MASPRT(13)
         NWTRE = MASPRT(14)
C===>  KAATE
         NNTOK = 0
         MMSWA = MSWALL(2)
         T5MSW = 0
         T6MSW = 0
         T4MSW = 0
C---> KAATE CBOO. MECTA B TOKN  TOKN1
         ADRTOK = 1
         IMSWA = 6
         MSWALL(IMSWA) = 0
         IBA0 = 6
C===> KEL - KO-BO EMEHTOB OCAH B BA0, TKEL - C..K.
         KEL = MASPRT(3)
         TKEL = 0
C######################################################################
C  P A   O P   O  E P E  H O  O  O   C A H  
C######################################################################
1        CONTINUE
C===> HE EPEOHC  M?
         IF ( IBA0 .LE. BA0(3) ) GO TO 100
105      CONTINUE
C!!!-------------------------------------------------------------------
         WRITE(NWTRE, 500) IBA0, TKEL
500      FORMAT(' *** O. CO B GETMSW: IBA0=', I10, ' TKEL=',I10)
C******* CALL PRINT0( BA0, KNOT, PAR0 )
C!!!-------------------------------------------------------------------
         CALL SUBERR(1)
100      CONTINUE
C===>  OE O AP. CE.
         ADRMSW = IMSWA
         MSWALL(ADRMSW) = 0
C===> OPEEEHE OCTOHHO ACT TEKEO MSW, CTAH. HA. EO:
         IMSWA = IMSWA + 1
C===> AP. HAAA MSW E AP. CE.
         IMSWA0 = IMSWA
         MSWALL( IMSWA + 0 ) = BA0( IBA0 )
         MSWALL( IMSWA + 1 ) = BA0( IBA0 + 1 )
         MSWALL( IMSWA + 2 ) = -1
C===> KO-BO OB:
         MSWALL( IMSWA + 4 ) = BA0( IBA0 + 7 )
C===> AC CCKA OB IMP TK;
         IMP = BA0( IBA0 + 7 )
         IK = BA0( IBA0 + 2 )
         DO  101  I=1, IMP
101      MSWALL( IMSWA+ 8 + (I-1) ) = KNOT( IK + (I-1) )
C===> KAATE -> HA HAAO EPEMEHHO ACT, A CCKOM OB
         IMSWA = IMSWA + 8 + IMP
C==> OTOBMC K OPMPOBAH EPEMEHHO ACT:
         TIP = BA0( IBA0 + 1 )
         PTIP = BA0( IBA0 + 4 )
         MSWALL( IMSWA0 + 3 ) = PTIP
         IKNOT = BA0( IBA0 + 2 )
         IPAR0 = BA0( IBA0 + 3 )
C===> POBEPM HAE PEAA FM .... & DM....
         I1 = 1
104      CONTINUE
         IF ( MACTAB(I1) .EQ. 0  ) GO TO 102
         IF ( MACTAB(I1) .EQ. TIP ) GO TO 103
         I1 = I1 + MASPRT(17)
         GO TO 104
102      CONTINUE
C!!!-------------------------------------------------------------------
         WRITE(NWTRE, 501) TIP
501      FORMAT(' *** O. CO--> TA # ', I10, ' HET B MACTAB')
C!!!-------------------------------------------------------------------
         GO TO 105
103      CONTINUE
C===> ECT  PEAA?
         IF ( MACTAB(I1+7) .GT. 0 ) GO TO 106
C===>  HET !!!
         WRITE(NWTR, 502) TIP
502      FORMAT(//' *** MAKPOMOE T HOMEP: ', I5,
     =          ' OKA HE OEPBAETC ***'/
     =          ' *** OTCTCBET POPAMMHA PEAA ***'/
     =          ' *** OCAHE E CPACBAETC ***'///)
         IER = TIP
         RETURN
C######################################################################
106      CONTINUE
C===> *********** KO-BO BBOHX HAEH
         IKK = MACTAB( I1+5 )
         IKK1 = IKK / 100
         IKK2 = IKK - IKK1 * 100
         MSWALL(IMSWA0 + 5) = IKK2
C===>   AOMHM TO KO-BO B NNTOK--->
         NNTOK = NNTOK + IKK2
C===> OPEEEM APECA B TOKN  TOKN1.....
         MSWALL( IMSWA0 + 6 ) = ADRTOK
C---> B PEEPB -1....
         MSWALL( IMSWA0 + 7 ) = -1
C===> HOBOE CBO. MECTO B TOKN  TOKN1....
         ADRTOK = ADRTOK + IKK2
C   ( ADRTOK  <==>  NNTOK + 1  B KOHE OECCA )
C===> BEM FM  DM:
         KODFM = MACTAB(I1+6)
         FM = KODFM/1000
         DM = KODFM - FM*1000
         MSWALL(IMSWA0 + 2 ) = DM
C**********************************************************************
C  BBAEM FM@@@@.....
C  IMSWA - KAATE TEK. O B MSWALL;   BOBPAT HA METK 1000
C######################################################################
          CALL CALLFM( FM, BA0(IBA0), KNOT(IKNOT), PAR0(IPAR0),
     =                 MSWALL(IMSWA), LM )
C######################################################################
1000    CONTINUE
C---->  OEPEHOO EMEHTA COPMPOBA "EPEMEHH" ACT MSW
C                          ( EE HA LM COB )
         TKEL = TKEL + 1
         IMSWA = IMSWA + LM
C---> HE EPEOHC  M E???
         IF ( IMSWA .GT. MMSWA ) GO TO 9999
C---> AEM B HAAO OCAH AP. CE.
         MSWALL( ADRMSW ) = IMSWA
       IF ( PTIP .NE. 4 ) GO TO 155
C-->  KCA -TA C .TOM # 4
       IF ( T4MSW .EQ. 0 ) T4MSW = ADRMSW
155    CONTINUE
         IF ( PTIP .NE. 5 ) GO TO 150
C===>  KCA EMEHTOB C PHAKOM TA MAKPOMOE # 5
         IF ( T5MSW .EQ. 0 ) T5MSW = ADRMSW
150      CONTINUE
         IF ( PTIP .NE. 6 ) GO TO 151
C==> KCA EMEHTA C .TA # 6
         IF ( T6MSW .EQ. 0 ) T6MSW = ADRMSW
151      CONTINUE
C---> KA. C. OHM
         MSWALL( IMSWA ) = 0
C----> CMECTMC B BA0
         IBA0 = IBA0 + MASPRT(4)
C---->  OEPKA CKPTOPA..
         MSWALL(3) = IMSWA
         IF ( TKEL .LT. KEL ) GO TO 1
C---> K O H  A E M:
         MSWALL(3) = IMSWA
         MASPRT(41) = T5MSW
         MASPRT(49) = T6MSW
         MASPRT(93) = T4MSW
         MASPRT(37) = 0
         IF ( T6MSW .NE. 0 ) MASPRT(37) = 1
C!!!-------------------------------------------------------------------
         WRITE(NWTRE, 504) KEL, IMSWA, T4MSW, T5MSW, T6MSW
504      FORMAT(/' *** HACTPOKA MAKPOMOEE  ', I5, ' EMEHTOB',
     = ' ABEPEHA ***'/
     =' *** ( AHTO ', I10, ' COB B CCKE M_S_W_ALL )        ***'/
     =' *** [ T4MSW = ',I5,'  T5MSW = ',I5,' T6MSW = ',I5 ,' ]       ***
     ='/ )
C!!!-------------------------------------------------------------------
C====> B MASPRT(46) - KO-BO  BB. HAEH  TOKA  CE. EPEMEHHX.
         MASPRT(46) = NNTOK
C===>  CAMO POBEPKA...
         IF ( ADRTOK .EQ. (NNTOK+1) ) GO TO 152
C!!!-------------------------------------------------------------------
         NWTRE = MASPRT(14)
         WRITE(NWTRE, 153 ) NNTOK, ADRTOK
153      FORMAT(' *** CO B KOHE  GETMSW: NNTOK = ', I5,
     =          ' ADRTOK = ', I5, ' ***' )
C!!!-------------------------------------------------------------------
         CALL  SUBERR(1)
152      CONTINUE
C######################################################################
C   O K O H  A T E   H A   HACTPOKA EPE LM_MOHTOP:
C
       CALL CALLLM( MSWALL, KOD )
       IER = KOD
C----------------------------------------------------------------------
         RETURN
9999     CONTINUE
C!!!-------------------------------------------------------------------
         WRITE(NWTRE, 505 ) TKEL, LM, ADRMSW , FM
505   FORMAT(' *** HET MECTA B M_S_W_ALL ...', I4, ' EMEHTA ***'/
     =       ' *** HA APOEHHO . ACT MSW ', I10, ' COB ***'/
     =       ' *** HAAO OCAH B MSWALL.......', I10, ' COBA ***'/
     =       ' *** HOMEP MOHTOPA FM..............', I10 /)
C----------------------------------------------------------------------
         CALL SUBERR(0)
         RETURN
         END
