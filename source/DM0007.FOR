         SUBROUTINE DM0007 ( MSW, RMSW, YALL, JALL, LOGYTR,
     *                       TOKN, TOKN1, VALLN, VALLN1, KOD,
     *                         MSWALL, RMSWAL, ADRMSW )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C   OPOPAMMA:  DM0007 ( MSW, RMSW, YALL, JALL, LOGYTR
C  -------------             TOKN, TOKN1, VALLN, VALLN1, KOD,
C                              MSWALL, RMSWAL, ADRMSW )
C
C   HAHAEHE:    B ABCMOCT OT HAEH AA ZAPROS [MASPRT(28)]:
C   -----------    BOHET CEE HK:
C
C                  A) ZAPROS = 1
C                     ----------
C                  OPMPOBAHE BKAOB B YALL MATP POBOMOCTE 
C                  JALL - BEKTOP CTOHKOB TOKA HAEH APAMETPOB
C                  KBBAEHTHX  G - J BETBE  MOE EMEHTA E
C
C                      P KODMUM = 1 --> BCEA H1  H2 BPATC
C                                         COACHO MU APAMETP, A HE
C                                         O TEKM H1  H2
C
C
C                   EKTPECKA  MAHA 3X3X0:
C                   ****************************
C                  T # 11  --> "P. BAP.", MB(_T_)
C                  T # 110 --> "P. BAP.", MB(_OMEA_)
C                  T # 14  --> "P. BAP.", MB(_T_) - M_FT(#)
C                  T # 140 --> "P. BAP.", MB(_OMEA_) -  M_FT(#)
C                  T # 12  --> "REDUCE."  , MB(_T_)
C                  T # 120 --> "REDUCE."  , MB(_OMEA_)
C                  ****************************************************
C                             TOB # 11  # 12  14:
C                            ----------------------
C                   M_BHE(T) - AAETC KCOHO-HEHO HKE
C                               EPE MACCB MAS < T1 Y1 .... >
C                                ( CM. / KMAS02 );
C
C                       TOB # 110  # 120  140:
C                     -------------------------
C              M_BHE(_OMEGA_) AAETC KO. OHOMA:
C              MAS < A0 A1 A2 ...>;
C
C                      MB := A0 + A1 * OMEGA + A2 * OMEGA**2 + ....
C
C
C                             TOB # 11  110:
C                            ---------------------
C                  EMEHT OCBAETC:
C            ?? T 11  #S1N #S2N #S3N #F1N #F2N #F3N
C                       #S1K #S2K #S3K #F1K #F2K #F3K
C                      RS RF LS  MS  LR  MR  MSR  PTAU GD**2
C                       MAS < T1 Y1 ....   > ;
C
C                     [ "PHO" B A P  A H T ]
C
C                             TOB # 14  140:
C                            ---------------------
C                  EMEHT OCBAETC:
C            ?? T 11  #S1N #S2N #S3N #F1N #F2N #F3N
C                       #S1K #S2K #S3K #F1K #F2K #F3K
C                      RS RF LS  MS  LR  MR  MSR  PTAU GD**2  #
C                       MAS < T1 Y1 ....   > ;
C    # - HAEHE  MF_T TOO -TA BTAETC  M_BHE.
C
C                     [ "PHO" B A P  A H T ]
C
C                             TOB # 12  120:
C                            ---------------------
C                  EMEHT OCBAETC:
C            ?? T 11  #S1N #S2N #S3N #F1N #F2N #F3N
C                       #S1K #S2K #S3K #F1K #F2K #F3K
C                      RS RF LVS LVF MSS MFF     PTAU GD**2
C                       MAS < T1 Y1 ....   > ;
C
C@
C
C               *** BOMOH TEPAOHHE TOHEH ***:
C                   P BOEH FITER [ MASPRT(65) ] --->
C                   HAEH "TOK"_ - POHO BHM METOOM -
C                   HE BCTC, A BPATC  MACCBA TOKN1;
C               ***
C                  B) ZAPROS = 2
C                     ----------
C                  BCEHE HAEH TOKOB B BETBX B T(N+1) MOMEHT
C                  BPEMEH   CXO  G  J APAMETPOB  HAEH
C                  OBX HAPEH HA EMEHTE PACTAHHX  T(N+1)
C                     AC (KCA) TX HAEH B "TOK T(N+1)";
C                 - P TOM KOHTPOPETC "PACXOEHE" ME
C                   HAEHM, OEHHM O BHO CXEME (POHO) 
C                   OPEEEHHM CXO  BCEHHX HAEH VALLN1;
C                   KOHTPO BEETC O HE PEBEH EITER[MASPRT(67)]
C                   OTHOCTEHO OPEHOCT. B HE AOPTHOM CAE
C                   B "MAXITR" ACBAETC MAX_OPEHOCT 
C                   B "NLITER" KCPETC HOMEP EMEHTA.....
C                   APAMETP "KOD" = 1;
C
C
C                  C) ZAPROS = 3
C                     **********
C                     HE OEPBAETC ( PEEPB );
C
C                  D) ZAPROS = 4
C                     **********
C                     HE OEPBAETC;
C
C   METO:         CKPETA PABHEH COCTOH MOE AHHOO
C   -----          TA HA OCHOBE METOA HEPA BO:
C                  Y(N+1) = Y(N) + H1*F(N+1) + H2*F(N).
C
C   APAMETP:     MSW, RMSW - PABEE COBO COCTOH MAKPOMOE
C   ---------      ( "OTPEOK" MACCB MSWALL -> C.M. / GETMSW );
C                  YALL - MATPA P0BOMOCT AHAPEMO E;
C                  JALL - BEKTOP CTOHKOB TOKA AHAPEMO E;
C                  VALLN - BEKTOP OBX HAPEH AHAPEMO E:
C                          B T = TN;
C                  VALLN1- BEKTOP OBX HAPEH AHAPEMO E:
C                          B T = TN + H0;
C                  TOKN    TOKN1  -  HAEH "TOKOB" P T :=
C                                     TN    TN + H0;
C                                   PAMEPHOCT CM. MASPRT(46)=NNTOK;
C                  LOGYTR - BEKTOP PHAKOB K.. OB:
C                  COETC B MAKPOMOEX C PHAKOM TA = 5;
C                  PAMEPHOC MACCBOB P "ALL" OPEETC:
C                   MAX_DIMENSION ---> NDALL = MASPRT(23)
C                   TEKA_PAMEPHOCT ---> NSYS = MASPRT(26)
C                  KOD - APAMETP OPATHO CB C MOHTOPOM DM....
C                   ( =1 P OO OK. OPEHOCT );
C
C
C
C   OPOPAMM:  1. COMMON PROF1, PROF2, PROF3;  + PRINT5 - OTAKA;
C   ------------      DEPOSA, ME1N13, ME2N13, ME3N13,
C                     KMAS01, KMAS02,  MA1N13, MA2N13, MA3N13;
C
C   PMEAHE:  1.CTPKTP MSW COBA MAKPOMOE AHHOO TA CM. HE
C   ----------   2. P ZAPROS ^=   1  2 - COOEHE  XO;
C                3. P FTEST=-1 EAT OT. H. EPE PRINT5;
C
C               "OCTOHHA" ACT MSW TA # 11, 110, 12, 120:
C                ----------------------------------------------
C                      +  14   140:
C  +-------+--------+--------+--------+------+------+-------+---+
C  I HOMEP I HOMEP  I HOMEP  I PHAKI KO I KO. IAP.   IPE I
C  I EME I TA   I /    I TA   I ECT I BB. IHA.   IE I
C  I HTA   I MOE I PACETAI MOE I BO   I HA I"TOKN" IPB I
C  I       I        I DM.....I       .I OBI EH.I"TOKN1"I   I
C  +-------+--------+--------+--------+------+------+-------+---+
C  I  1    I   2    I   3    I    4   I   5  I  6   I  7    I 8 I
C  +-------+--------+--------+--------+------+------+-------+---+
C
C  +--------------------------------------------------------------+
C  I  OKEH S1N S2N S3N F1N F2N F3N S1K S2K F1K F2K F3K I
C  I           12-T COB: OT 9 O 20                             I
C  +--------------------------------------------------------------+
C
C              RMSW T # 11, 110, 12, 120 [ . MAHA 3X3X0 ] :
C              ************************************************
C         + 14   140
C  +--------+-----+------+------+-------+-------+-------+-------+-----+
C  I PEEPB I"DOM"I PARD I PARM I PARGY I PARG1 I PARJY I PARJ0 I TMASI
C  I 3,4,5  I  I      I      I       I       I       I       I     I
C  I        IMEX. I 9-T I 9-T I 36-T I 36-T I 6-T  I 6-T  I NMASI
C  I        IP- I COB I COB I COB  I COB  I COB  I COB  I COBI
C  +--------+-----+------+------+-------+-------+-------+-------+-----+
C  I 21 - 25I 26  I27-35 I36-44 I45-80  I81-116 I117-122I123-128I129-@I
C  I ****   I     I      I      I       I       I       I       I     I
C  +--------+-----+------+------+-------+-------+-------+-------+-----+
C  +D1            +D2    +D3    +D4     +D5     +D6     +D7     +D8   +
C
C              @ - OPEEETC PAMEPOM MAS <...> ==> ...+ NMAS + 1
C            *** - 22 - APEC B TOKN/N1 HAEH MFT  # (T 14,140)
C
C
C
C--->  D@ -> HOMEPA OE B MSW_ALL MACCBA;
C
C
C
C
C
C      HA MSW_ALL ==> D8 + NMAS + 1; (+1 - HA H TMAS );
C
C      HA "EPEMEHHO" ACT ==> DR8 + NMAS + 1;
C
C      PACPOBKA MACCBOB PARD  T.. CM. B / ME@N13 ...  FM0008;
C
C     B MACCBE TOKN  TOKN1 COEPTC:
C
C    OT 1 O 6   - HAEH TOKOB A OMOTOK: S1 S2 S3 F2 F2 F3;
C
C       7        -  HAEHE GAMMA -> O OOEH POTOPA;
C
C       8        -  HAEHE OMEGA -> OBA ACTOTA BPAEH POTOPA
C                                     ( B OHOEPOHO MOE );
C       9        -  HAEHE MFT - . MA. MOMEHTA;
C
C      10        -  HAEHE M_BHE(T) - BHEH HAPOH MOMEHT;
C
C  OPM:
C  ********
C   HKT A) ( E AA ):
C            O AHHM  TOKN  VALLN:
C            -1                          D L(N)
C   J0 = L(N)  *[ U(N) - ( R + OMEGA(N) *-------  ) * TOKN ]     (B MSW)
C                                        D GAMMA
C   MFTN =  TOKN
C
C   MBHN =  TOKN
C
C   DOMN = [PTAU/JMOM] * ( MBHN - MFTN )    (B MSW)
C
C   TOKN_Y(BH) = TOKN + H0 * J0    (B TOKN1)
C
C   GAM_Y(BH)  = GAM_N + H0 * OMEG_N  (B TOKN1)
C
C   OMEG_Y(BH) = OMEG_N + H0 * DOMN   (B TOKN1)
C
C
C   HKT A) ( POOEHE,  P AE, TOKO TO):
C   O AHHM  TOKN1, MSW  TOKN:
C
C   MFTN_1 = F(GAMN_1, TOKN_1)  AC B TOKN1
C
C   MBHN_1 = HE CTAETC*** SUB( VALLN, TOKN_1, (TN+H0), ...)
C
C   DOMN_1 = HET **** [PTAU/JMOM] * ( MBHN_1 - MFTN_1 )
C
C   GAMN_1 =  TOKN1   GAMN + H1 * OMEGN_1 + H2 * OMEGN
C
C   OMEGN_1 =  TOKN1   OMEGN + H1 * DOMN_1 + H2 * DOMN
C
C   G0 = [ L(N+1) + H1*R + OMEGN_1 * D(L(N+1))/D(GAM) ] ** (-1)
C
C   GY = H1 * G0
C
C   G1 = G0 * L(N+1)
C
C   JY = G1 * [ TOKN + H2 * J0 ]
C
C------
C
C   HKT B) -->  PACET TOKN1  KOHTPO:
C   O AHHM  TOKN1, MSW, VALLN1:
C
C   TOKX = GY * UL(N+1) + JY;  UL--> VALLN1(*) - VALLN1(*);
C
C   MFTX = F( GAMN_1, TOKX )
C
C   MBHX = SUB( VALLN1, TOKX, (TN+H0), ...)  TOB 13  130
C                                           "-" MFT_ #.
C   DOMX = [PTAU/JMOM] * ( MBHX - MFTX )
C
C   OMEGX = OMEGN + H1 * DOMX + H2 * DOMN
C
C   GAMX =  GAMN +  H1 * OMEGX + H2 * GAMN
C
C   OCK  EPS:= [MAX] -> ABS(TOKX - TOKN1)/MAX(TOKX,TOKN1)
C
C   P  EPS > MAXITR --> KCA CTA: NLITER, NSITER,...
C                         KOD = 1
C                         *******
C
C   KCA B TOKN1 HAEH TOKX, .....
C
C
CZZZ-------------------------------------------------------------------
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
C      DIMENSION G12(12,12), J12(12)
C      REAL J12
C!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
         COMMON /PROF1/ MASPRT(200)
         COMMON /PROF2/ MACTAB(800)
         COMMON /PROF3/ FUNTAB(50)
         DIMENSION MSW(*), RMSW(*), YALL(*), JALL(*), LOGYTR(*)
         DIMENSION VALLN(*), RMASPT(1), VALLN1(*), TOKN(*), TOKN1(*)
         EQUIVALENCE ( MASPRT(1), RMASPT(1) )
         REAL JALL, ME3N13, MA3N13
         EQUIVALENCE ( ZAPROS, MASPRT(28) )
         DIMENSION MSWALL(*), RMSWAL(*)
         DIMENSION UL(6),  TOKX(6)
         INTEGER ADRMSW
         INTEGER D1,D2,D3,D4,D5,D6,D7,D8
         INTEGER FTEST
         EQUIVALENCE ( NNTOK,  MASPRT(46) )
         EQUIVALENCE ( FTEST,  MASPRT(60) )
         EQUIVALENCE ( NSYS,   MASPRT(26) )
         EQUIVALENCE ( NDALL,  MASPRT(23) )
         EQUIVALENCE ( NWTRE,  MASPRT(14) )
         EQUIVALENCE ( TN,     MASPRT(29) )
         EQUIVALENCE ( H0,     MASPRT(30) )
         EQUIVALENCE ( MU,     MASPRT(31) )
         EQUIVALENCE ( H1OLD,  MASPRT(32) )
         EQUIVALENCE ( H2OLD,  MASPRT(33) )
         EQUIVALENCE ( FITER,  MASPRT(65) )
         EQUIVALENCE ( EITER,  MASPRT(67) )
         EQUIVALENCE ( NLITER, MASPRT(79) )
         EQUIVALENCE ( MAXITR, MASPRT(80) )
         EQUIVALENCE ( NSITER, MASPRT(88) )
         EQUIVALENCE ( ZEROCP, MASPRT(50) )
         EQUIVALENCE ( KODMUM, MASPRT(114) )
         INTEGER FITER,  ZAPROS, TIP
         REAL MAXITR, MFTN, MBHN, KMAS02, MFTX, MBHX, KMAS01, MU, MFTN1
         DATA KAKA9 / 9 /
C**********************************************************************
       DATA D1, D2, D3, D4, D5, D6,  D7,  D8
     =  /   21, 27, 36, 45, 81, 117, 123, 129 /
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C   BEH, ABCE OT KOHKPETHO MOE:
C 1) BCE D1,....  CM. BE;
C 2) PAMEPHOCT PA. MACCBOB ( HH KXALL, A HE KALL):
C!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
C 3) PAMEPHOCT ACT "GY", "JY" KXALL - KOTOP BKABAEM:
       DATA KXALL/6/
C 4) "OHE" PAMEPHOCT GY  JY:
       DATA KALL/6/
C 5) BCOM. KAATE-> CMEEHE B MSW  COOTB. MACCBOB
C    ( HA "1" MEHE COOTB. D1, D2,....):
       DATA IPARD, IPARM, IPARGY, IPARG1, IPARJY, IPARJ0, ITMAS
     =    /  26,    35,    44,     80,      116,    122,   128 /
C 6) KAATE HA "DOM" COBO:
       DATA IDOM/26/
C 7) CMEEHE B TOKN/TOKN1 HA "MEXAHECKE" EPEMEHHE:
       DATA IGAM, IOMEG, IMFT, IMBH
     =    /  +6,   +7,    +8,   +9  /
C 8) KAATE HA [PTAU/JMOM] OTHOCTEHO PARM( OT CMEEH D3 ):
       DATA IPTJ/+8/
C--->  HK "BXMEPHX" MACCBOB:
       IDGY(I,J) = IPARGY + (J-1)*KALL + I
       IDG1(I,J) = IPARG1 + (J-1)*KALL + I
       IDYALL(I,J) = (J-1) * NDALL + I
C      !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
       TIP = MSW(2)
C--
       IF ( TIP .EQ. 11  .OR. TIP .EQ.110.OR.TIP .EQ.14.OR.TIP.EQ.140
     =  .OR.  TIP .EQ. 12  .OR. TIP .EQ. 120       ) GO TO  99990
       GO TO 9999
99990  CONTINUE
CQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ
C--->  BOP H1   H2 --->
       H1 = H1OLD
       H2 = H2OLD
       IF ( KODMUM .EQ. 0 )  GO TO 3000
       H1 = H0 * ( 1.0 - MU )
       H2 = H0 * MU
3000   CONTINUE
CQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ
C-->  KA- HA TOK...
       ITOK = MSW(7)
       ITOK1 = ITOK - 1
C--->  BOP PEMA APOCA..
       GO TO( 100, 200), ZAPROS
C===> HAE OKA
         NWTRE = MASPRT(14)
         WRITE(NWTRE,9997) MSW(3), ZAPROS
9997     FORMAT( ' *** DM MOHTOP #', I4, ' APOC OCBAH OOEH
     = ***'/ ' *** ZAPROS = ', I5, ' - HOPPETC ***')
         RETURN
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C---- ZAPROS = 1 ------------------------------------------------------
100    CONTINUE
C-->  AEHE HAPEH:
       DO 102 I=1,KALL
       IF ( I .GT. KXALL ) GO TO 1020
C-->   PEAHE, HE EMPEPHE...
       K = MSW( I + 8 )
       M = MSW( 8 + KXALL + I )
       VK = 0.0
       IF ( K .NE. 0 ) VK = VALLN(K)
       VM = 0.0
       IF ( M .NE. 0 ) VM = VALLN(M)
       UL(I) = VK - VM
       GO TO 102
1020   CONTINUE
C-->  EMEPHE ...
       UL(I) = 0.0
102    CONTINUE
C--->
C-->  HE POCT  TEPA ?
       IF ( FITER .EQ. 1 ) GO TO 101
C-->  HKT A) --- HAAO -----(E AA)
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C      WRITE(6,66666) ( IQ, RMSW(IQ), IQ=D1,D8 )
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C66666  FORMAT(1X,5(1X,'R(',I3,')=', G12.5 ) )
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C-->  PACET J0:
       GAMMA = TOKN(ITOK+IGAM)
       OMEGA = TOKN(ITOK+IOMEG)
       IF ( TIP .EQ. 12  .OR. TIP .EQ. 120 )
     = CALL ME2N13( RMSW(D2), RMSW(D3), OMEGA, GAMMA,
     =              TOKN(ITOK), UL, RMSW(D7) )
       IF ( TIP.EQ.11.OR.TIP.EQ.110.OR.TIP.EQ.14.OR.TIP.EQ.140 )
     = CALL MA2N13( RMSW(D2), RMSW(D3), OMEGA, GAMMA,
     =              TOKN(ITOK), UL, RMSW(D7) )
C??????????????????????????????????????????????????????????????????????
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C      WRITE(6,66666) ( IQ, RMSW(IQ), IQ=D1,D8 )
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C-->  MFT_N    MBH_N
C*****
C      MEET CMC EPECTAT, T.K. B C. HTEP. TOK MEH.
C     MFT -->  MEH. OEH C.
         MFTN = TOKN(ITOK+IMFT)
C      #########################
C@@    IF ( TIP .EQ. 12  .OR.  TIP .EQ. 120 )
C@@  =     MFTN = ME3N13( RMSW(D2), GAMMA, TOKN(ITOK) )
C@@    IF ( TIP.EQ.11.OR.TIP.EQ.110 .OR. TIP.EQ.14.OR.TIP.EQ.140)
C@@  =     MFTN = MA3N13( RMSW(D2), GAMMA, TOKN(ITOK) )
C-->
C66667  FORMAT('  MFTN=',G12.5,' MBHN=',G12.5,' G=',G12.5,' OM=',G12.5)
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C   MBHN -->  MOHO BT  TOKN,
C   MOHO EPECTAT  ETA F(OMEGA)
C***
C##    IF ( TIP .EQ. 11  .OR.   TIP .EQ. 12  .OR. TIP  .EQ. 14 )
C##  = MBHN = KMAS02( TN, RMSW(D8) )
C##
C##    IF ( TIP .EQ. 110  .OR.   TIP .EQ. 120  .OR. TIP .EQ. 140 )
C##  = MBHN = KMAS01(OMEGA,  RMSW(D8) )
C##
C@@@@@ TOKN(ITOK+IMFT) = MFTN
C###   TOKN(ITOK+IMBH) = MBHN
       MBHN = TOKN(ITOK + IMBH )
C      #########################
C
C??????????????????????????????????????????????????????????????????????
C-->  DOM_N -> MEX. XAP-KA..
       DOMN = RMSW(D3+IPTJ) * ( MBHN - MFTN )
       RMSW ( IDOM ) = DOMN
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C      WRITE(6,66667) MFTN, MBHN, GAMMA, OMEGA
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C--->  POHO "BHX" HAEH
       DO 103 I=1,KALL
       TOKN1( ITOK1 + I ) = TOKN(ITOK1+I) + H0*RMSW(IPARJ0+I)
103    CONTINUE
       TOKN1(ITOK + IGAM ) = GAMMA + H0 * OMEGA
       TOKN1(ITOK + IOMEG ) = OMEGA + H0 * DOMN
C----------------------------------------------------------------------
C-->  HKT A) C AOM....
101    CONTINUE
C**********************************************************************
C
C  -->  "BHE"   "TEPAOHHE" GAMMA  OMEGA-->  OMEG1  GAM1
       OMEG1 = TOKN1( ITOK + IOMEG )
       GAM1  = TOKN1( ITOK + IGAM  )
C**** EPECET MFT  OEPK TOB 14  140:::>
C    HAEH GAM1  TOKN1  PACET MFTN1  AC EO B TOKN1:
C
C      #########################
       IF ( TIP .EQ. 12  .OR.  TIP .EQ. 120 )
     =     MFTN1 = ME3N13( RMSW(D2), GAM1,  TOKN1(ITOK) )
       IF ( TIP.EQ.11.OR.TIP.EQ.110 .OR. TIP.EQ.14.OR.TIP.EQ.140)
     =     MFTN1 = MA3N13( RMSW(D2), GAM1,  TOKN1(ITOK) )
       TOKN1(ITOK + IMFT ) = MFTN1
C    ############
C-->  GAMMA    OMEGA  B TOEK  TN--->
       OMEGA = TOKN( ITOK + IOMEG )
       GAMMA = TOKN( ITOK + IGAM  )
C--> O  AHHM POHOA  HAXOM  GY    G1 --->
C
C-->  PACET "OHX" ( T.E KALL HA KALL ) GY  G1....
       IF ( TIP .EQ. 12  .OR. TIP .EQ. 120 )
     = CALL ME1N13( RMSW(D2), RMSW(D3), H1, OMEG1, GAM1, RMSW(D4),
     =                 RMSW(D5) )
       IF ( TIP .EQ. 11  .OR. TIP .EQ. 110 .OR.TIP.EQ.14.OR.TIP.EQ.140)
     = CALL MA1N13( RMSW(D2), RMSW(D3), H1, OMEG1, GAM1, RMSW(D4),
     =                 RMSW(D5) )
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C      WRITE(6,66666) ( IQ, RMSW(IQ), IQ=D1,D8 )
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C-->  PACET JY...
       IF ( H2 .EQ. 0.0 ) GO TO  104
C-->  H2 HE 0.0,  ET J0...
       DO 105 I=1,KALL
       TOKX(I) = TOKN(ITOK1+I) + H2 * RMSW(IPARJ0+I)
105    CONTINUE
C-->  JY = G1 * TOKX
       DO 106 I=1,KALL
       SUM = 0.0
       DO 107 J=1,KALL
       INDEX = IDG1(I,J)
       SUM = SUM + RMSW(INDEX) * TOKX(J)
107    CONTINUE
       RMSW(IPARJY+I) = SUM
106    CONTINUE
       GO TO 1070
C**********************************************************************
104    CONTINUE
C-->  H2 = 0.0,  OABK HET
       DO 108 I=1,KALL
       SUM = 0.0
       DO 109 J = 1,KALL
       INDEX = IDG1(I,J)
       SUM = SUM + RMSW(INDEX) * TOKN(ITOK1 + J)
109    CONTINUE
       RMSW(IPARJY + I ) = SUM
108    CONTINUE
C----------------------------------------------------------------------
1070   CONTINUE
C
C   GY     JY   OPEEEH....
C---  BKABAEM ----
       IIX = KAKA9 + KXALL
       CALL DEPOSA( MSW(KAKA9), MSW(IIX), KXALL, KALL,RMSW(D4),RMSW(D6),
     =              YALL,  JALL )
C
C--->    GY  JY  OM "PABEPHTE" MATP--->
C$$$$$$CALL MOT005( RMSW(D4), G12,  RMSW(D6), J12 )
C-->  BOM B PH--->******
C
C   BKA
C        DO  552 I=1,12
C        DO  553 J1=1,12
C        IJ1XX = IDYALL( MSW(8+I), MSW(8+J1) )
C****
C553      YALL(        IJ1XX       )=YALL( IJ1XX )
C    =                              + G12( I, J1 )
C552      JALL(MSW(8+I))=JALL(MSW(8+I)) - J12(I)
C                                      $  -------- !!!
C@@@@
       KOD = 0
       IF ( FTEST .NE. -1 ) RETURN
C--->  OTAOHA EAT:
       CALL PRINT5( TN, H1, H2, RMSW, TOKN, TOKN1, ITOK )
       RETURN
C----------------------------------------------------------------------
C----------------------------------------------------------------------
C---- ZAPROS = 2 ------------------------------------------------------
200    CONTINUE
C-->  AEHE HAPEH-->  HOBOE
       DO 201 I=1,KALL
       IF ( I .GT. KXALL ) GO TO 2010
C-->   PEAHE, HE EMPEPHE...
       K = MSW( I + 8 )
       M = MSW( 8 + KXALL + I )
       VK = 0.0
       IF ( K .NE. 0 ) VK = VALLN1(K)
       VM = 0.0
       IF ( M .NE. 0 ) VM = VALLN1(M)
       UL(I) = VK - VM
       GO TO 201
2010   CONTINUE
C-->  EMEPHE ...
       UL(I) = 0.0
201    CONTINUE
C-->  HAEM TOK  O  VALLN1...
       DO 202 I=1,KALL
       SUM = RMSW(IPARJY + I )
       DO 203 J=1,KALL
       INDEX = IDGY(I,J)
       SUM = SUM + RMSW(INDEX)*UL(J)
203    CONTINUE
       TOKX(I) = SUM
202    CONTINUE
C--->  MFT    MBH ...
C  -->  "BHE"  TEP. HAEH  TN1 ( PECKAAHE) -->
       GAM1 = TOKN1(ITOK + IGAM)
       OMEG1 = TOKN1(ITOK + IOMEG)
C######################################################################
C    TA 14/140 BOP MFTN1   TOKN1(#)  ETA B MBH(TN1)
       IF ( TIP.EQ.14.OR.TIP.EQ.140) MFTN1=TOKN1( MSW(D1+1) )
C######################################################################
C--->   HAEH  GAMMA  OMEGA  B TN  TOEK -->
       GAMMA = TOKN(ITOK+IGAM)
       OMEGA = TOKN(ITOK+IOMEG)
C-->  # HE BH A  MEXAHK #####--->  ( MFT  O HOBM TOKAM )::>
       IF ( TIP .EQ. 12  .OR.  TIP .EQ. 120 )
     =          MFTX = ME3N13( RMSW(D2), GAM1, TOKX )
C
       IF ( TIP .EQ. 11  .OR.  TIP .EQ.110.OR.TIP.EQ.14.OR.TIP.EQ.140)
     =          MFTX = MA3N13( RMSW(D2), GAM1, TOKX )
C-->   M_BH    TN+H0   :-->
C****
C  MBHX-->  C ETOM TOKX, GAM1, OMEG1--->  14/140 ECT MFTN1(#)
C****
       TN1 = TN + H0
       IF ( TIP .EQ. 11  .OR.   TIP .EQ. 12  .OR. TIP .EQ. 14 )
     = MBHX = KMAS02( TN1, RMSW(D8) )
C
       IF ( TIP .EQ. 110  .OR.   TIP .EQ. 120  .OR. TIP .EQ. 140 )
     = MBHX = KMAS01( OMEG1,   RMSW(D8) )
C--
C######################################################################
       IF ( TIP .EQ. 14 .OR. TIP .EQ. 140 ) MBHX = MBHX - MFTN1
C######################################################################
       DOMX = RMSW(D3+IPTJ) * ( MBHX - MFTX )
       DOMN = RMSW(IDOM)
C--->  ####  BOHEHE  HEBHOO  AA ( TA KOPPEK )::-->
       OMEGX = OMEGA + H1*DOMX + H2*DOMN
       GAMX = GAMMA + H1*OMEG1 + H2*OMEGA
C
C
C----------------------------------------------------------------------
C-->  OEHKA OPEHOCT...
       EPSX = 0.0
       NSM = 0
       DO 204 I=1,KALL
       X1 = ABS( TOKN1(ITOK1+I) )
       X2 = ABS( TOKX(I) )
C++++
       IF ( X1 .LE. ZEROCP  .OR.  X2 .LE. ZEROCP )  GO TO 2040
       XZ = AMAX1( X1, X2 )
       EPS = ABS( X1 - X2 ) / XZ
       GO TO 2041
2040   EPS = ABS( X1 - X2 )
2041   CONTINUE
C+++++
       IF ( EPS .LT. EPSX ) GO TO 204
C-->  KCPEM  B MOE...
       EPSX = EPS
       NSM = I
204    CONTINUE
C-->   MEXAHK....
C----------------------------------------------------------------------
       X1 = ABS(GAM1)
       X2 = ABS(GAMX)
C++++
       IF ( X1 .LE. ZEROCP  .OR.  X2 .LE. ZEROCP )  GO TO 2050
       XZ = AMAX1( X1, X2 )
       EPS = ABS( X1 - X2 ) / XZ
       GO TO 2051
2050   EPS = ABS( X1 - X2 )
2051   CONTINUE
C+++++
       IF ( EPS .LT. EPSX ) GO TO 205
C-->  KCPEM..
       EPSX = EPS
       NSM = IGAM + 1
205    CONTINUE
C----------------------------------------------------------------------
       X1 = ABS(OMEG1)
       X2 = ABS(OMEGX)
C++++
       IF ( X1 .LE. ZEROCP  .OR.  X2 .LE. ZEROCP )  GO TO 2060
       XZ = AMAX1( X1, X2 )
       EPS = ABS( X1 - X2 ) / XZ
       GO TO 2061
2060   EPS = ABS( X1 - X2 )
2061   CONTINUE
C+++++
       IF ( EPS .LT. EPSX ) GO TO 206
C-->  KCPEM..
       EPSX = EPS
       NSM = IOMEG + 1
206    CONTINUE
C--->  EPEAC TOKOB  B   TOKN1...
       DO 207 I=1,KALL
       TOKN1(ITOK1+I) = TOKX(I)
207    CONTINUE
       TOKN1(ITOK+ IGAM) = GAMX
       TOKN1(ITOK+ IOMEG) = OMEGX
       TOKN1(ITOK+ IMFT ) = MFTX
       TOKN1(ITOK+ IMBH ) = MBHX
C--->  ECT  "OA" OKA  ????
       KOD = 0
       IF ( EPSX .LT. EITER ) RETURN
       KOD = 1
C-->  OKA ECT, HE HHO  EE KCPOBAT....
       IF ( EPSX .LT. MAXITR ) RETURN
       MAXITR = EPSX
       NLITER = MSW(1)
       NSITER = NSM
       RETURN
C######################################################################
9999     CONTINUE
         NWTRE = MASPRT(14)
         WRITE(NWTRE,9998) MSW(1), MSW(2)
9998     FORMAT( ' *** O. CO B DM0007 - APOC HA OCBAHE O
     =O TA ***'/
     =    ' *** EMEHT # ', I10, ' T MOE # ', I10, ' ***'//)
         CALL SUBERR(0)
         RETURN
         END
