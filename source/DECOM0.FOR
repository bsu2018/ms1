         SUBROUTINE DECOM0( NDIM, N, A, COND, IPVT, WORK )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C   OPOPAMMA:  DECOM0( NDIM, N, A, COND, IPVT, WORK )
C   -------------
C
C   HAHAEHE:    OPEEET L_U PAOEHE BEECTBEHHO MATP A  
C   ----------      OEHBAET EE OCOBEHHOCT;
C
C   METO:         ACOBO CKEHE O CTOAM C ACTHM BOPOM
C   -----           BEEO EMEHTA;
C
C   APAMETP:     NDIM - ABOHA "CTPOHA" PAMEPHOCT MATP A;
C   ---------      N - OPOK CCTEM ( MATP A  BCEX BEKTOPOB );
C                  COND - OEHKA OCOBEHHOCT MATP A:
C                    EC  "COND .EQ. COND+1" --> TO MATPA KA K
C                    BPOEHHO; P TOHOM BPAEH COND = 1.0E+32;
C                    EC P OPAEH K DECOM0 "COND=-1.0" --> OEHKA
C                    OCOBEHHOCT HE BCETC -> KOHTPO HET!!!!!
C                  A - CXOHA MATPA CCTEM " A * X = B ";
C                      OCE BOHEH DECOM0 - COEPT:
C                      L _ U PAOEHE A, C TOHOCT O EPECTAHOBOK;
C                  IPVT - BEKTOP BEX EMEHTOB:
C                     IPVT(K) - HEKC K- BEE CTPOK;
C                     IPVT(N) = (-1)**<CO EPECTAHOBOK>;
C                  WORK - PAO BEKTOP;
C
C   OPOPAMM:  HET
C  --------------
C
C
C   PMEAHE:  1.  PEEH CCTEM, OCE EKOMO MATP A,
C   ----------      HEOXOMO COOBAT / SOLVE0;
C                2. OPEETE DET(A) =
C                      IPVT(N)*A(1,1)*A(2,2)*...*A(N,N);
C                3. BXO B MATP A(I,J)==> EPE  A( ID(I,J) ) :
C                   ID(I,J) = NDIM*(J-1) + I
C
CZZZ-------------------------------------------------------------------
         DIMENSION A(1), WORK(1), IPVT(1)
         REAL A, COND, WORK
         INTEGER NDIM, N, IPVT
C--->
         REAL EK, T, ANORM, YNORM, ZNORM
         INTEGER NM1, I, J, K, KP1, KB, KM1, M
C--->
         ID(I,J) = NDIM * ( J - 1 ) + I
C--->
         IPVT(N) = +1
         IF ( N .EQ. 1 ) GO TO 80
         NM1 = N - 1
C
         IF (COND .EQ. -1.0 ) GO TO 100
C--> BCT 1-HOPM MATP A
         ANORM = 0.0
         DO 10 J=1,N
               T = 0.0
               DO 5 I=1,N
                   T = T + ABS( A( ID(I,J) ) )
5              CONTINUE
              IF ( T .GT. ANORM ) ANORM = T
10      CONTINUE
C
100      CONTINUE
C
C---> ACOBO CKEHE C ACTHM BOPOM BEEO EMEHTA
C
         DO 35 K=1, NM1
            KP1 = K + 1
C
C---> HAT BE EMEHT
C
            M = K
            DO 15 I=KP1, N
               IF ( ABS( A( ID(I,K) ) ) .GT. ABS( A( ID(M,K) ) ) )
     =                      M = I
15          CONTINUE
         IPVT(K) = M
         IF ( M .NE. K ) IPVT(N) = - IPVT(N)
         KK = ID(K,K)
         MK = ID(M,K)
         T = A(MK)
         A(MK) = A(KK)
         A(KK) = T
C
C--->    POCK CE. AA, EC BE EMEHT BCE E PABEH 0
C
         IF ( T .EQ. 0.0 ) GO TO 35
C
C--->    BCEHE MHOTEE
C
         DO 20 I=KP1, N
            IK = ID(I,K)
            A(IK) = - A(IK) / T
20       CONTINUE
C
C---->   EPPECTABT  CKAT O CTOAM
C
            DO 30 J=KP1, N
               MJ = ID(M,J)
               KJ = ID(K,J)
               T = A(MJ)
               A(MJ) = A(KJ)
               A(KJ) = T
               IF ( T .EQ. 0.0 ) GO TO 30
               DO 25 I = KP1, N
                  IJ = ID(I,J)
                  IK = ID(I,K)
                  A(IJ) = A(IJ) + A(IK) * T
25             CONTINUE
30          CONTINUE
35       CONTINUE
C
C----------------------------------------------------------------------
         IF ( COND .EQ. -1.0 ) RETURN
C----------------------------------------------------------------------
C
C---> COND = <1-HOPMA MATP A> * < OEHKA  1-HOPMA MATP A**(-1)>
C     OEHKA HAXOTC OCPECTBOM OHOO AA METOA OPATHX
C     TEPA  HAMEHEO CHPHOO BEKTPA,  EO:
C     PEEHE BX CCTEM PABHEH:
C        T
C      A   * Y = E
C
C      A   * Z = Y
C
C      E E - BEKTOP  +1  -1, BPAHH TAK, TO [Y] --> MAX.
C     (GALIMOTXQ)
C             T
C---> PEAEM A  * Y  =  E
C
         DO 50 K=1,N
            T = 0.0
            IF ( K .EQ. 1 ) GO TO  45
            KM1 = K - 1
            DO 40 I = 1, KM1
               T = T + A( ID(I,K) ) * WORK(I)
40          CONTINUE
45          EK = 1.0
            IF ( T .LT. 0.0 ) EK = -1.0
            KK = ID(K,K)
            IF ( A(KK) .EQ. 0.0 ) GO TO 90
            WORK(K) = - ( EK + T ) / A(KK)
50       CONTINUE
C----->
         DO 60 KB = 1, NM1
            K = N - KB
            T = 0.0
            KP1 = K + 1
            DO 55 I = KP1, N
               T = T + A( ID(I,K) ) * WORK(K)
55          CONTINUE
            WORK(K) = T
            M = IPVT(K)
            IF ( M .EQ. K ) GO TO 60
            T = WORK(M)
            WORK(M) = WORK(K)
            WORK(K) = T
60       CONTINUE
C--->
         YNORM = 0.0
         DO 65 I =1, N
            YNORM = YNORM + ABS( WORK(I) )
65       CONTINUE
C
C---->  PET  A * Z = Y
C
         CALL SOLVE0( NDIM, N, A, WORK, IPVT, IRC )
C
         ZNORM = 0.0
         DO 70 I=1, N
            ZNORM = ZNORM + ABS( WORK(I) )
70       CONTINUE
C
C--->  OEHT "OCOBEHHOCT"
C
         COND = ANORM * ZNORM / YNORM
         IF ( COND .LT. 1.0 ) COND = 1.0
C
         RETURN
C
C----> CA MATP  1*1
C
80       CONTINUE
         IF ( COND .EQ. -1.0 ) RETURN
         COND = 1.0
         IF ( A(1) .NE. 0.0 ) RETURN
C
C--->  "TOHOE" BPOEHE
C
90       COND = 1.0E+32
         RETURN
         END
