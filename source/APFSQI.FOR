         SUBROUTINE APFSQI  ( KOD, N0, N1, N2, IF )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)----------
C    OPOPAMMA    APFSQI(KOD,N0,N1,N2,IF)
C
C      HAHAEHE: EPEBO CA, ACAHHOO POBM CMBOAM B
C      ----------  ECTHOE CO C KCPOBAHHO TOKO (INTEGER*4)
C
C      METO:      OEMEHTHOE PEOPAOBAHE (CEBA HAPABO) CXOHX
C      -----       POBX AHHX, PECTABX BHEH OPM AC
C                  PEOPAEMOO CA;
C
C      APAMETP:  KOD - MACCB AHHX  PEOPAOBAH ( B F-KOE.);
C      ---------   N0  - PEOPAOBAHHOE EOE CO ( INTEGER*4 );
C                  N1  - HOMEP EMEHTA B MACCBE KOD HAAA HOPMA
C                         OEAE PEOPAOBAH;
C                  N2  - KOECTBO EMEHTOB OCTHX 
C                         PEOPAOBAH;
C                  IF  - HKATOP PEOPAOBAH:
C                      IF = 1  - P AOOHOM PEOPAOBAH:
C                                P TOM: N1 = N1 + N2; N2 = 0;
C
C                      IF = 2  MACCB KOD HE KOHC, OHAPEH CMBO
C                              "HE PA",B N1 - HOMEP B MACCBE KOD,
C                               COOTBETCTB OHAPEHHOM HE -
C                               POBOM CMBO; B N2 - HA ( KO-BO
C                               EMEHTOB B MACCBE KOD ) OCTABEC
C                               ACT - E CMBOA "HE PA" -
C                                B MACCBE KOD;
C                               N0 - PEOPAOBAHHOE CO, PECTABEH-
C                               HOE PAM OT N1 O CMBOA "HE PA";
C                               ( PABHOE 0 );
C                     IF = 3 - P PEOPAOBAH CA POOO
C                              EPEOHEHE; P TOM CTPOKA ( MACCB
C                              KOD ) POOAET POCMATPBATC.
C                         A)  P BCTPEE CMBOA "HE PA" -
C                             N1 - APEC "HE PA" ( HOMEP B KOD ), A
C                             N2 - HA OCTABEC ACT, E CMBOA 0
C                                "HE PA";
C                         )  EC CTA "HE PA" HE AKCPOBAHA,
C                             A OE ( MACCB KOD ) CEPAHO, TO:
C                              N1=N1+N2, N2=0.
C                          BO BCEX CAX IF=3, PHMAETC N0=MAX/MIN
C                          ( B ABCMOCT OT HAKA )  HAEH
C                       INTEGER*4 B PECTABEH HA COEMO BM.
C
C                    IF = 4 - N2 AAH MEHE H ( N2<0 ), P TOM
C                          N0=0, N1  N2 E MEHEH
C                    IF = 5 - N2 AAHO PABHO H ( N2=0 ), P TOM
C                          N0=0, N1=N1+1, N2=0;
C                    IF = 6 - BOHKAET P OTKE PEOPAOBAH
C                         O ( MACCBA KOD ) COCTOEO  OHX
C                         HEHAEX POEOB  CMBOOB:
C                               <->,<+>; P TOM: N0=0, N1=N1+N2, N2=0;
C
C      OPOPAMM: APFTRT;
C      ------------
C
C      PMEAHE:   PEOOAETC, TO MACCB B F-KOE OPOEH
C      ----------     COACHO TAE B OPOPAMM APFTRT .
C                    ( P TOM <PA> = FKOD(I) - 1 );
C
C
CZZZ ------------------------------------------------------------------_
         INTEGER * 4  P, P1, TKOD, LIMITM, LIMITP, LIMIT
         DIMENSION KOD(1), TKOD(13)
         DATA IVV/0/, LIMITM/-2147483647/, LIMITP/+2147483647/
         DATA                        LIMIT/214748364/
         DATA TKOD/'0','1','2','3','4','5','6','7','8','9',
     *             ' ', '+', '-' /
         IF ( IVV .EQ. 1 ) GO TO 1
C----------------------------------------------------------------------
C EPB BXO: OPABM LIMITM
         LIMITM = LIMITM - 1
C  EPB BXO: EPEKOP. TKOD
         IVV=1
         CALL  APFTRT(1, 13,  TKOD,  TKOD  )
C----------------------------------------------------------------------
1        CONTINUE
         NMAX = N1 + N2 -1
         IF = 4
         N0 = 0
         IF ( N2 .LT. 0 ) GO TO 100
         IF ( N2 .NE. 0 ) GO TO 3
C=====>  N2 = 0
         N0 = 0
         N1 = N1 + 1
         N2 = 0
         IF = 5
         GO TO 100
C----------------------------------------------------------------------
C    EPEM POE
C----------------------------------------------------------------------
3        DO 4 I=N1,NMAX
         IT = I
         IF ( KOD(I) .NE. TKOD(11) ) GO TO 5
4        CONTINUE
C=====> OH POE
         N0 = 0
         IF = 6
         N1 = N1 + N2
         N2 = 0
         GO TO 100
C====> ECT  HAK ?  (IZ=0 =EQ= "+")
5        CONTINUE
         IZ = 0
         IF ( KOD(IT) .EQ. TKOD(12)  .OR. KOD(IT) .EQ. TKOD(13) )
     =                       GO TO 60
         GO TO 6
60       CONTINUE
         IF ( KOD(IT) .EQ. TKOD(13) ) IZ = -1
C====> HA HOB CMBO
         IT = IT + 1
         IF ( IT .LE. NMAX ) GO TO 6
C=====> OE KOHOC TOKO OH HAK...
         IF = 6
         N0 = 0
         N1 = N1 + N2
         N2 = 0
         GO TO 100
C
C  ==== K PEMA CE ====
C
6        CONTINUE
         ID = 0
         I1 = IT
         IF = 2
         N0 = 0
         DO 7 I=I1, NMAX
         IT = I
         IF ( KOD(I) .LT. TKOD(1)  .OR.  KOD(I) .GT. TKOD(10) )
     =                       GO TO 8
C========> HAA PA...
         IF ( N0 .GT. LIMIT ) GO TO 9
         N0 = N0 * 10
         IF ( N0 .EQ. 10*LIMIT .AND. KOD(I) .GT. 7 .AND. IZ .EQ. 0 )
     =                       GO TO 9
         IF ( N0 .EQ. 10*LIMIT .AND. IZ .EQ. -1 ) GO TO 10
C========>  BCE HOPMAHO
         N0 = N0 +(KOD(I) - 1)
         GO TO 7
C=======> P  OTP. CE "B PTK" K MIN. OCTMOM
10       ID = -1
         NX =(KOD(I) - 1) -1
         N0 = N0 + NX
7        CONTINUE
C======> OE KOHOC, BCE PAOPA
         IF = 1
         N1 = N1 + N2
         N2 = 0
C======> KAK HAK ?
         IF ( IZ .EQ. 0 ) GO TO 100
         N0 = - N0
         IF ( ID .EQ. -1 ) N0 = N0 -1
         GO TO 100
C**********************************************************************
C  OCOE CA
C**********************************************************************
8        CONTINUE
         IF = 2
         N1 = IT
         N2 = NMAX - IT
         IF ( IZ .EQ. 0 ) GO TO 100
         N0 = -N0
         IF ( ID .EQ. -1 ) N0 = N0 -1
         GO TO 100
C====>  EPEOHEHE.....
9        CONTINUE
         N0 = LIMITP
         IF ( IZ .EQ. -1 ) N0 = LIMITM
         IF = 3
C====CKAHPEM AE....
         I1 = IT
         DO 12 I=I1, NMAX
         IT = I
         IF ( KOD(I) .LT. TKOD(1)  .OR.  KOD(I) .GT. TKOD(10) )
     =                            GO TO 11
12       CONTINUE
C======> OE KOHOC, HO EPEOHEHE....
         N1 = N1 + N2
         N2 = 0
         GO TO 100
C======> BCTETAC HE PA
11       N1 = IT
         N2 = NMAX - IT
         GO TO 100
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
100      R E T U R N
         END
