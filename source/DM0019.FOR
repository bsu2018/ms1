         SUBROUTINE DM0019 ( MSW, RMSW, YALL, JALL, LOGYTR,
     *                       TOKN, TOKN1, VALLN, VALLN1, KOD,
     *                         MSWALL, RMSWAL, ADRMSW )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C   OPOPAMMA:  DM0019 ( MSW, RMSW, YALL, JALL, LOGYTR,
C   -------------            TOKN, TOKN1, VALLN, VALLN1, KOD,
C                              MSWALL, RMSWAL, ADRMSW )
C
C   HAHAEHE:  MOHTOP         MAKPOMOE # TA 92:
C  ------------  BEHTH K ( BA BEHT 1- OT "K" K "M" );
C                ************************************************
C                POHAK TA #6
C
C                   +----I<I-----+   *EPB BEHT_KATOHA PA*
C                   I            I
C  *K_E*---------+            +------*M_E*
C                   I            I
C                   +----I>I-----+   *BTOPO BEHT_AHOHA PA*
C
C
C     HAPEHE OOPHOE  1-O BEHT -->   V(O1);
C     HAPEHE OOPHOE  2-O BEHT -->   V(O2);
C     HAPEHE PABEH  1-O BEHT --> V(1) - V(2)
C     HAPEHE PABEH  2-O BEHT --> V(2) - V(1)
C     ( T.E. TO TO  BEHT 1, HO C OPATHM HAKOM );
C
C
C       PEAETC "PAEHOE" PABEHE BEHTM:
C                    P OACAH OHOO -> APET OA HA HEO
C                                             MCOB "C" 
C                                             PAPEEHE OA "C"
C                                             HA PO;
C                    P OACAH OOX -> PAPEEHE "C" HA TOT,
C                                            KOTOPOO HAPEHE
C                                           PABEH COOTB. HHO
C                                           PE POBOMOCT;
C
C              EMEHT OCBAETC:
C
C    # T 92  K  M    O1  O2   1  2  DTCIU  EYYV   EYYI;
C
C     E:     K, M  -   OKEH,
C
C              O1, O2  -   "OOPHOO" HAPEH-> V(01), V(O2)
C
C              1, 2  -   "PABEO" HA- -> [(1)-V(2)]
C
C              DTCIU - TEHOCT MCA "C" -> [ B . PACAX ]
C                      MC EHEPPTC COACHO CPABHEH
C                      HAP. OOPHOO -> BPAEMOO  MACCBA
C                      VALLN/VALLN1   HAPEH "PABEO" ->
C                      BPAEMOO  VALLN/VALLN1;
C
C  EYYV - MAX. O. AMTA C P BPMTEHM PEME PAOT;     
C  EYYI - MAX. O. AMTA C P HBEPTOPHOM   PEME PAOT;
C
C
C   !!! CHA "C" EHEPPETC B MOMEHT EPECEEH KPBO
C       PABEO HAPEH BEHT C KPBO OOPHOO
C       HAPEH - HCAA ACTOK.
C   !!!
C   !!!   "ECTECTBEHHO" PAOT KA_2 B AE E PEKOMEHETC:
C
C        U_O_1<KATO> := - E_A;
C
C        U_O_2<AHO>  := + E_A;
C   !!!
C
C
C === BBOHE HAEH: I1         - TOK  BHE. BBOOB, OT "K" K "M";
C                        I2, I3     - TOK BEHTE,
C                        I3, I4     - "C" HA BEHTX;
C
C######################################################################
C    PACPEEEHE HAPEH PABEH O         AHOHO-KATOHM
C                      BEHTM
C
C                 EYY:=<HAPEHE PABEH>:= [V(1) - V(2)]
C                      --------------------------------------------
C
C    "KATOH" BEHT                      "AHOH" BEHT
C
C   BEHT. 01         -->  "-" EYY       BEHT. 02         --> "+" EYY
C
C                      OOPHE HAPEH:
C
C   BEHT. 01   -->  V(O1)              BEHT. 02          --> V(O2)
C
C######################################################################
C-->  UYN/N1  - HAP. PABEH
C
C
C                  B ABCMOCT OT HAEH AA ZAPROS [MASPRT(28)]:
C
C                  BOHET CEE HK:
C
C                  A) ZAPROS = 1
C                     ----------
C                 -  OPMPOBAHE BKAOB B YALL MATP POBOMOCTE
C                   HAEH "POBOMOCT" AKPTX BEHTE ( GVENT6 )
C                   [ B AHHO BEPC KOMEKCA ];
C                  - OPMPOBAHE BEKTOPA K.. OB "LOGYTR"
C                     HEHTHX OB --> COETC
C                     /  GETLOG --> OCECTBT "EMEHTAPH" BKA;
C
C                  1A) ZAPROS = 10
C                      ------------
C                      OPMPOBAHE "TEHEBO" CCTEM PABHEH
C                       ( OEMEHTH BKA )
C
C                  B) ZAPROS = 20
C                     ------------
C                  BCEHE HAEH TOKOB B BETBX B T(N+1) MOMEHT
C                  BPEMEH. P TOM TOK OTKPTX BEHTE:( K  M )
C                  <TOKN1>:= <VALLN1[K]> - <VALLN1[M]>;
C                   TOK AKPTX BEHTE = 0.0;
C                  AC TX TOKOB B MACCB TOKN1;
C                   !!! BOHT O MOKA PEEH VALLN1 !!!
C
C                  C) ZAPROS = 3
C                     -----------
C                      O OPEEEHHM TOKAM BEHTHX "E"
C                      OPMPET CHA "PAPEEHE/APET" CX  TX
C                      CXO  HAPEH PABEH  OOPHX
C                      HAPEH (  KA, KB, KC ) -->
C                      OPEEET MOMEHT "ECTECTBEHHO" KOMMTA
C                      BEHTE ( CM. / MCIU50 ); HA OCHOBE TOO
C                     OBOTC AHA HA BOMOH CMEH COCTOH
C                     BEHT [ OTKPT <==> AKPT ]:
C                     P TOM: FKOM = 0 - COCTOHE HE MEHOC;
C                               FKOM = 1 - HA TEKEM AE COCTOHE
C                                         OHO "O" MEHTC B
C                                         B T = TX MOMEHT BPEMEH;
C                                         PEAHO B POPAMME OPEE-
C                                         ETC HX - A BOMOHO
C                                         KOMMTA, ATEM TX=TN+HX;
C                                         P HX < HXMIN [MASPRT(62)]
C                                         PHMAETC HX = HXMIN;
C                                         COCTOHE HX=0.0 BBAET
C                                         EAT COOEH;
C                                         POBEEH COTBETCTBE
C                                         MEHEH B MASPRT:
C                                          FKOM <== "1"
C                                         HXG = MIN( HX, HXG )
C                                         TXG = TN + HXG
C
C              ET: ICLOSE - MO TOKA "AKPT" BEHT;
C                    UOPEN  - MO HAPEH "OTKPT" BEHT;
C
C
C                  D) ZAPROS = 4
C                     **********
C                   - P TX_G  [MASPRT(35)] .EQ. TX_BEHT   -
C                      KCPETC CMEHA COCTOH BEHT APAMETPOM
C                      KD;
C                     PABEHCTBO POBEPETC C TO. O "EPSKOM".
C
C   METO:         PAHOBHOCT BOHOBOO AOPTMA  OPMPOBAH
C   -----          MACCBA LOGYTR --> EE / GETLOG;
C
C                  "TEHEBA" CCTEMA OPMPETC "MACTAPOBAHHA"
C                   TAK, TO: V[X] - V[Y] = <TOK    X-Y   BETB>;
C                   , OTMEEHHE B LOGYTR(*) = 0 - "AOBE"
C                    KAO HEHTHO P OTKPTX BEHTE;
C
C   APAMETP:     MSW, RMSW - PABEE COBO COCTOH MAKPOMOE
C   ---------      ( "OTPEOK" MACCB MSWALL -> C.M. / GETMSW );
C                  YALL - MATPA P0BOMOCT AHAPEMO E;
C                  JALL - BEKTOP CTOHKOB TOKA AHAPEMO E;
C                  VALLN - BEKTOP OBX HAPEH AHAPEMO E:
C                          P  T  =  TN;
C                  VALLN1- BEKTOP OBX HAPEH AHAPEMO E:
C                          P  TN + H0;
C                  TOKN   TOKN1 - HAEHE EPEMEHHX "COCTOH"
C                                  MOE P TN    TN + H0;
C                          ( PAMEPHOCT -> CM. MASPRT(46) = NNTOK )
C                  LOGYTR - BEKTOP PHAKOB K.. OB:
C                  COETC B MAKPOMOEX C PHAKOM TA = 6;
C                  PAMEPHOC MACCBOB P "ALL" OPEETC:
C                   MAX_DIMENSION ---> NDALL = MASPRT(23)
C                   TEKA_PAMEPHOCT ---> NSYS = MASPRT(26)
C                  KOD - APAMETP OPATHO CB C MOHTOPOM DM....
C
C
C
C
C   OPOPAMM:  1. COMMON PROF1, PROF2, PROF3;
C   ------------   2. DM00B9, SEQCIU, SEQMAX
C
C   PMEAHE:  1.CTPKTP MSW COBA MAKPOMOE AHHOO TA CM. HE
C   ----------   2. P ZAPROS ^=1, 10,20,3,4 - BAA COOEH  XO
C                3. P FTEST = 1 -> EAT HA WTRE AKTA CMEH COCTOH
C              OPMAT MSW # TA 92 [ BEHTH K ]:
C              -------------------------------------------
C               "OCTOHHA" ACT
C               ******************
C
C  +-------+--------+--------+--------+------+------+--------+----+
C  I HOMEP I HOMEP  I HOMEP  I  P. I KO I KO. I AP.   I PE I
C  I EME I TA   I /    I TA   I ECT I BB. I HA.  I E I
C  I HTA   I MOE I PACETAI (PE.) I BO   I HA I "TOKN" I PB I
C  I       I        I DM.....I       .I OBI EH.I "TOKN1"I    I
C  +-------+--------+--------+--------+------+------+--------+----+
C  I  1    I   2    I   3    I    4   I   5  I  6   I   7    I 8  I
C  +-------+--------+--------+--------+------+------+--------+----+
C
C
C              EPEMEHHA ACT MSW:
C              *********************
C
C  COBO     COBO     OOHAEH  OECKOE HAEHE
C  OT        OT
C  HAAA    EPEMEH.
C  MSW       ACT
C
C  9          -        HOMEP A : 1 - BEHT --I>I--, 2 - --I<I--
C  10         -        HOMEP A : 1 - BEHT --I<I--, 2 - --I>I--
C
C-- -- - - - - --- - - - - - - - -
C  11, 12     1, 2     [F] HOMEPA OB O1, O2;
C
C  13, 14     3, 4     [F] HOMEPA OB 1, 2;
C
C  15          5       [F] DTCIU - T. MCA "C"
C
C 16<->25     6<->15      MSWV1  -  COBO PABEH 1-M BEHTEM
C      $$                 ( B 25 --->  EYYV )
C 26<->35    16<->25      MSWV2  -  COBO PABEH 2-M BEHTEM
C      $$                 ( B 35 --->  EYYI )
C**********************************************************************
C
C   LM OA = 35  COB, LM_OK. =  25
C
C       OPMAT MSWV_EHT  DM00B9:
C       -------------------------------
C
C      COBO                   HAEHE
C
C      1       KD - KO COCTOH: =0 - AKPT, =1 - OTKPT;
C      2       HX - A OT TN, BOMOHOE BPEM EPEKEH;
C
C ( B [*] HOMEPA MSW_VEHT  / "MCIU50" )
C
C  [1] 3       TS - BPEM CTAPTA MCA( "E" KOMMTA );
C  [2] 4       TK - BPEM HA MCA( "E" KOMMTA );
C  [3] 5       CX - KO PAPEEH/APETA "C":
C                   =0 - C APEEHO OABAT HA BEHT,
C                   =1 - C PAPEEHO OABAT HA BEHT;
C [4] 6        TX - BPEM, C KOTOPOO ECTBET KO "CX";
C
C
C [5] 7        MCIU - KO MCA --->
C                     MCIU   = 00  --> "C" HET B [TN, TN+H0];
C                                       HXCIU = 0.0;
C                     MCIU   = 01  --> B [TN, TN+H0] -> EPEH POHT
C                                   MCA "C", HXCIU = HTEPBA OT
C                                      TN O EPEHEO POHTA "C";
C                     MCIU   = 10 -->  B [TN, TN+H0] -> AH POHT
C                                   MCA "C", HXCIU = HTEPBA
C                                      OT TN O AHEO POHTA MCA;
C                     MCIU   = 11 -->  B [TN, TN+H0] "C" BKEH,
C                                      COCTOHE HE MEH, HXCIU=0.0;
C
C
C [6] 8        HXCIU - A OT TN, O OEPEHOO POHTA "C";
C (---)
C     9              - A KD COCTOH;
C    10              - B 1-M --> EYYV,  BO 2-M --> EYYI
C
C********************************************************************
C
CZZZ-------------------------------------------------------------------
         COMMON /PROF1/ MASPRT(200)
         COMMON /PROF2/ MACTAB(800)
         COMMON /PROF3/ FUNTAB(50)
         DIMENSION MSW(*), RMSW(*), YALL(*), JALL(*), LOGYTR(*)
         DIMENSION VALLN(*), RMASPT(1), VALLN1(*), TOKN(*), TOKN1(*)
         REAL JALL
         DIMENSION MSWALL(*), RMSWAL(*)
         INTEGER ADRMSW
         EQUIVALENCE ( MASPRT(1), RMASPT(1) )
         EQUIVALENCE ( MASPRT(62), HXMIN )
         EQUIVALENCE ( MASPRT(14), NWTRE )
         EQUIVALENCE ( MASPRT(59), GVENT6 )
         EQUIVALENCE ( MASPRT(94), DTMCIU )
         EQUIVALENCE ( MASPRT(60), FTEST )
         EQUIVALENCE ( MASPRT(57), OPEN6 )
         INTEGER FTEST, OPEN6
         EQUIVALENCE ( ZAPROS, MASPRT(28) )
         EQUIVALENCE ( NDALL,  MASPRT(23) )
         EQUIVALENCE ( TN,     MASPRT(29) )
         EQUIVALENCE ( H0,     MASPRT(30) )
         EQUIVALENCE ( H1,     MASPRT(32) )
         EQUIVALENCE ( H2,     MASPRT(33) )
         EQUIVALENCE ( FKOM,   MASPRT(34) )
         EQUIVALENCE ( TXG,    MASPRT(35) )
         EQUIVALENCE ( HXG,    MASPRT(61) )
         EQUIVALENCE ( NTXG,   MASPRT(36) )
         EQUIVALENCE ( EPSKOM, MASPRT(39) )
         EQUIVALENCE ( ZEROCP, MASPRT(50) )
         INTEGER FKOM, ZAPROS
         EQUIVALENCE ( ICLOSE, MASPRT(77) )
         EQUIVALENCE ( UOPEN,  MASPRT(78) )
         REAL ICLOSE
C----------------------------------------------------------------------
       DIMENSION TOKXN(2), TOKXN1(2),  THELP( 2), VHN(4), VHN1(4)
       DIMENSION KVENT( 2), MVENT( 2), UYN( 2), UYN1( 2),
     =           UON( 2), UON1( 2)
C
       INTEGER       CXA, CXK
       REAL                          IKN, IKN1, IAN, IAN1
C -->  AHOHE  ( HAAO BEHT ):
       DATA KVENT
     = /10,09/
C--> KATOHE  ( KOH BEHTE ):
       DATA MVENT
     = /09,10/
C
C----------------------------------------------------------------------
       KOD = 0
C--->  KOHTPO TA
         IF ( MSW(2) .NE. 92 ) GO TO 9999
C
       TN1 = TN + H0
C---> BOP PEMA:
         IF ( ZAPROS .EQ. 1 )   GO TO 100
         IF ( ZAPROS .EQ. 10 )  GO TO 200
         IF ( ZAPROS .EQ. 20 )  GO TO 300
         IF ( ZAPROS .EQ. 3 )   GO TO 400
         IF ( ZAPROS .EQ. 4 )   GO TO 500
C===> HAE OKA
         NWTRE = MASPRT(14)
         WRITE(NWTRE,9997) MSW(3), ZAPROS
9997     FORMAT( ' *** DM MOHTOP #', I4, ' APOC OCBAH OOEH
     = ***'/ ' *** ZAPROS = ', I5, ' - HOPPETC ***')
         RETURN
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
9999     CONTINUE
         NWTRE = MASPRT(14)
         WRITE(NWTRE,9998) MSW(1), MSW(2)
9998     FORMAT( ' *** O. CO B DM0019 - APOC HA OCBAHE O
     =O TA ***'/
     =    ' *** EMEHT # ', I10, ' T MOE # ', I10, ' ***'//)
         CALL SUBERR(0)
667      CONTINUE
C---------------Z A P R O S = 1----------------------------------------
C
100    CONTINUE
101    CONTINUE
C-> ZAPROS = 1 -->                  -->  OCE. BOB MOHTOPA BEHE
C-->  B COOTBETCTB C MACCBAM RMSW<50>, UYN, UYN1, UON, UON1
C
666    CONTINUE
       NEL = MSW(1)
       DO 102 NV = 1,2
C-->  APEC RMSW<50> BEHT-->
       INV = (NV-1) * 10 + 16
C-->   OKEH-->
       K1 = KVENT(NV)
       M1 = MVENT(NV)
       K = MSW(K1)
       M = MSW(M1)
C-->  HOMEP O. BEHT
       NPEL = NEL*10000+NV
C-->  MOHTOPHOE OCBAHE-->
       CALL DM00B9(K, M, NPEL, MSW(INV), RMSW(INV), YALL, JALL, LOGYTR,
     =            TOKXN, TOKXN1, VALLN, VALLN1, KOD, UON(NV), UON1(NV),
     =            UYN(NV), UYN1(NV), DTCIU )
C- - - - - -
102    CONTINUE
C**********************************************************************
       RETURN
C**********************************************************************
C**********************************************************************
C**********************************************************************
200    CONTINUE
201    CONTINUE
C-->  ZAPROS=10-> TO TO   ZAPROS=1
       GO TO 666
C######################################################################
C######################################################################
C######################################################################
300    CONTINUE
C-->  ZAPROS=20 -->  TOK BEHTE          OPEEEM...>
C**********************************************************************
301    CONTINUE
C--> ZAPROS = 20  -> TOK BEHTE B TOKN/N1-->
C      ITOKNV --> (ITOK-1) + 1 + NV = ITOK+0+NV
C++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
       ITOK = MSW(7)
       NEL = MSW(1)
       DO 302 NV = 1,2
C-->  APEC RMSW<50> BEHT-->
       INV = (NV-1) * 10 + 16
C-->   OKEH-->
       K1 = KVENT(NV)
       M1 = MVENT(NV)
       K = MSW(K1)
       M = MSW(M1)
C-->  HOMEP O. BEHT
       NPEL = NEL*10000+NV
C-->  MOHTOPHOE OCBAHE-->
       CALL DM00B9(K, M, NPEL, MSW(INV), RMSW(INV), YALL, JALL, LOGYTR,
     =            TOKXN, TOKXN1, VALLN, VALLN1, KOD, UON(NV), UON1(NV),
     =            UYN(NV), UYN1(NV), DTCIU )
C- - - - - -
C-->  PACTABT OPE. HAEH TOKOB-->
       ITOKNV = ITOK     + NV
       TOKN1(ITOKNV) = TOKXN1(1)
       THELP(NV) = TOKXN1(1)
302    CONTINUE
C-->  "TOOBE" TOK-->
C-->  TOK OT  "K"  K  "M" -->
C
       TOKN1( ITOK ) = THELP(2) - THELP(1)
C
C-->  TOK E, A "C" EE HE OPEEEH....
       RETURN
C######################################################################
C######################################################################
C######################################################################
C######################################################################
400    CONTINUE
C-->  ZAPROS=3  ->  AHA BOMOHOO COCTOH/EPEKEH
401    CONTINUE
C-->  ZAPROS=3 -  TOK OPEEEH, HAEM AHOHE  KATOHE TOK B
C                 AAX BEHTE  BCHEH CX, TX
C
C**********************************************************************
C----------------------------------------------------------------------
C
C-->  UON/N1  - OOPHE HAP.
C-->  UYN/N1  - HAP. PABEH
C
C  VHN / N1 - "CTHHE" HAPEH HA AX
C              O1, O2, 1, 2        B TN/TN+H0
C
C######################################################################
C    PACPEEEHE HAPEH PABEH O         AHOHO-KATOHM
C                      BEHTM
C
C                 EYY:=<HAPEHE PABEH>:= [V(1) - V(2)]
C                      --------------------------------------------
C
C    "KATOH" BEHT                      "AHOH" BEHT
C
C   BEHT. 01    -->  "-" EYY            BEHT. 02         --> "+" EYY
C
C                      OOPHE HAPEH:
C
C   BEHT. 01   -->  V(O1)              BEHT. 02          --> V(O2)
C
C######################################################################
       DO 403 I=1,4
C-->  HOMEP A:
       K = MSW(I+10)
       VKN = 0.0
       VKN1 = 0.0
       IF ( K .EQ. 0 ) GO TO 404
       VKN  =  VALLN( K )
       VKN1 = VALLN1( K )
404    CONTINUE
       VHN(I)   = VKN
       VHN1(I)  = VKN1
403    CONTINUE
C-->  HAPEH PABEH*******
C******* TN BPEM *****************************************************
C   K A T O  H A     P    A:
       UYN(01) = - ( VHN(3) - VHN(4) )
C---            !!!!
C   A H O  H A     P    A:
       UYN(02) = + ( VHN(3) - VHN(4) )
C--
C----------------------------------------------------------------------
C******* TN + H0 BPEM *************************************************
C   K A T O  H A     P    A:
       UYN1(01) =  - ( VHN1(3) - VHN1(4)  )
C---              !!!!
C   A H O  H A     P    A:
       UYN1(02) = + ( VHN1(3) - VHN1(4) )
C--
C----------------------------------------------------------------------
C***** O  O P H  E   H A  P   E H  :
C********TN BPEM: ****************************************************
C-->
       UON(01) = VHN(1)
       UON(02) = VHN(2)
C----------------------------------------------------------------------
C********TN+H0  BPEM: *************************************************
C-->
       UON1(01) =  VHN1(1)
       UON1(02) =  VHN1(2)
C-->
C++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
C --->   KAOO BEHT CBOE CX < AHOHOE>, CX <KATOHOE>  TX:
C
       ITOK = MSW(7)
       IKN     = TOKN (ITOK + 01)
       IKN1    = TOKN1(ITOK + 01)
       IAN     = TOKN (ITOK + 02)
       IAN1    = TOKN1(ITOK + 02)
C----------------------------------------------------------------------
C--> HAPEHE PABEHE B TN  B   TN+H0 -->
       EYYN1 = VHN1( 3) -  VHN1( 4 )
       EYYN  = VHN ( 3) -  VHN ( 4 )
C
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C  OPAHEHE.....
       EYYV = RMSW(25)
       EYYI = RMSW(35)
       CALL SEQMAX( EYYN, IKN, IAN,  EYYV, EYYI )
       CALL SEQMAX( EYYN1, IKN1, IAN1,  EYYV, EYYI )
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
C----------------------------------------------------------------------
       INVK = (1-1)*10 + 16
       INVA = (2-1)*10 + 16
       CXK = MSW(INVK+4)
       CXA = MSW(INVA+4)
C----------------------------------------------------------------------
       CALL SEQCIU( TXK, TXA, CXK, CXA, IKN, IKN1, IAN, IAN1,
     =  IFXK, IFXA,    EYYN, EYYN1 )
C
C$$$$$$GO TO 440
C
C-->  CMEHA CX  TX B MSW<50>  1     -> KATO,  2    -> AHO  :
C
       NV = 1
C-->  AP. HAAA MSW<50>   KATOH BEHT
       INV = ( NV-1) * 10 + 16
       MSW(INV+4) = CXK
       IF ( IFXK  .EQ. 1 )    RMSW(INV+5) = TXK
C
       NV = 2
C-->  AP. HAAA MSW<50>  AHOH BEHT
       INV = ( NV-1) * 10 + 16
       MSW(INV+4) =  CXA
       IF ( IFXA  .EQ. 1 )    RMSW(INV+5) = TXA
C----------------------------------------------------------------------
450    CONTINUE
C######################################################################
C######################################################################
C-->  BOHM ZAPROS=3   BEHTE***********************************
       NEL = MSW(1)
       ITOK = MSW(7)
       DTCIU = RMSW(15)
       DO 451 NV = 1,2
       INV = (NV-1) * 10 + 16
       K1 = KVENT(NV)
       M1 = MVENT(NV)
       K = MSW(K1)
       M = MSW(M1)
       NPEL = NEL*10000 + NV
C-->  PACTABM TOKXN/N1
       ITOKNV = ITOK  +  NV
       TOKXN(1) =  TOKN ( ITOKNV )
       TOKXN1(1) = TOKN1( ITOKNV )
C-->  BCE OPEEEHO...
C-->  MOHTOPHOE OCBAHE-->
       CALL DM00B9(K, M, NPEL, MSW(INV), RMSW(INV), YALL, JALL, LOGYTR,
     =            TOKXN, TOKXN1, VALLN, VALLN1, KOD, UON(NV), UON1(NV),
     =            UYN(NV), UYN1(NV), DTCIU )
C- - - - - -
C-->  PMEM CHA "C"-->
       ICIUNV = ITOK + 2 +  NV
       TOKN1(ICIUNV) = TOKXN1(2)
451    CONTINUE
C-->  APOC ...
       RETURN
C----------------------------------------------------------------------
C######################################################################
500    CONTINUE
C-->  ZAPROS=4
C
C-->   BEHTE  -->  AHAOHO ZAPROS=1-->
       GO TO 666
C
       END
