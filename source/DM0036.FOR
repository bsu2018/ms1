         SUBROUTINE DM0036 ( MSW, RMSW, YALL, JALL, LOGYTR,
     *                       TOKN, TOKN1, VALLN, VALLN1, KOD,
     *                         MSWALL, RMSWAL, ADRMSW )
CXXX----KOMEKC "MS1" --> BEPC 1.1  (OT   MA   1988 .)------------
C   OPOPAMMA:  DM0036 ( MSW, RMSW, YALL, JALL, LOGYTR,
C   -------------            TOKN, TOKN1, VALLN, VALLN1, KOD,
C                              MSWALL, RMSWAL, ADRMSW )
C   HAHAEHE:
C   -----------
C   HAHAEHE:  MOHTOP   MAKPOMOE MKPOPOECCOPHO CCTEM,
C   ----------   OCTPOEHHO HA AE MKPOPOECCOPA CEP
C                K1801BM1(2,3), MEEO CCTEM KOMAH PM "DEC".
C                ******************************************************
C                PHAK TIP # 5 -> O. MAKPOMOE.
C
C
C
C                  B ABCMOCT OT HAEH AA ZAPROS [MASPRT(28)]:
C                  BOHET CEE HK:
C
C                  A) ZAPROS = 1
C                     ----------
C                   HE EAET HEO
C
C
C                  B) ZAPROS = 2
C                     ----------
C                   HE EAET HEO
C
C                                                                      )
C                  C) ZAPROS = 3
C                     -----------
C                     OBOTC PACET HAEH BXOHX CHAOB
C                     O BECTHM BXOHM CHAAM.
C                     P TOM: FKOM = 0 - COCTOHE BXOHX
C                                          CHAOB HE MEHOC;
C                               FKOM = 1 - HA TEKEM AE COCTOHE
C                                         OHO "O" MEHTC B
C                                         B T = TX MOMEHT BPEMEH;
C                                         PEAHO B POPAMME OPEE-
C                                         ETC HX-A BOMOHO CME-
C                                         H COCTOH, ATEM TX=TN+HX;
C                                         P HX < HXMIN [MASPRT(62)]
C                                         PHMAETC HX = HXMIN;
C                                         COCTOHE HX=0.0 BBAET
C                                         EAT COOEH;
C                                         POBEEH COTBETCTBE
C                                         MEHEH B MASPRT:
C                                          FKOM <== "1"
C                                         HXG = MIN( HX, HXG )
C                                         TXG = TN + HXG
C
C
C
C                  D) ZAPROS = 4
C                     **********
C                   - P TX_G  [MASPRT(35)] .EQ. TX[RMSW(10)] -
C               ( PABEHCTBO POBEPETC C TO. O "EPSKOM"[MASPRT(39)])
C                      KCPETC CMEHA COCTOH BXOHOO CHAA,
C                      B POTBHOM CAE, HAEHE BXOHOO CHAA
C                      BOCCTAHABBAETC;
C
C   METO:         OECKOE MOEPOBAHE
C   -----
C
C   APAMETP:     MSW, RMSW - PABEE COBO COCTOH MAKPOMOE
C   ---------      ( "OTPEOK" MACCB MSWALL -> C.M. / GETMSW );
C                  YALL - MATPA P0BOMOCT AHAPEMO E;
C                  JALL - BEKTOP CTOHKOB TOKA AHAPEMO E;
C                  VALLN - BEKTOP OBX HAPEH AHAPEMO E:
C                          P  T  =  TN;
C                  VALLN1- BEKTOP OBX HAPEH AHAPEMO E:
C                          P  TN + H0;
C                  TOKN   TOKN1 - HAEHE EPEMEHHX "COCTOH"
C                                  MOE P TN    TN + H0;
C                          ( PAMEPHOCT -> CM. MASPRT(46) = NNTOK )
C                  LOGYTR - BEKTOP PHAKOB K.. OB:
C                  COETC B MAKPOMOEX C PHAKOM TA = 6;
C                  PAMEPHOC MACCBOB P "ALL" OPEETC:
C                   MAX_DIMENSION ---> NDALL = MASPRT(23)
C                   TEKA_PAMEPHOCT ---> NSYS = MASPRT(26)
C                  KOD - APAMETP OPATHO CB C MOHTOPOM DM....
C
C
C
C
C   OPOPAMM:  1. COMMON PROF1, PROF2, PROF3;
C   ------------   2. SEQSOS, ADEC**
C
C   PMEAHE:  1.CTPKTP MSW COBA MAKPOMOE AHHOO TA CM. HE
C   ----------   2. P ZAPROS ^=  1, 2, 3, 4 - BAA COOEH  XO
C                3. P FTEST >=1 -> EAT HA WTRE AKTA CMEH COCTOH
C
C
C                    "OCTOHHA" ACT MSW
C                     ----------------------
C
C  +-------+--------+--------+--------+------+------+-------+---+
C  I HOMEP I HOMEP  I HOMEP  I PHAKI KO I KO. IAP.   IPE I
C  I EME I TA   I /    I TA   I ECT I BB. IHA.  IE I
C  I HTA   I MOE I PACETAI MOE I BO   I HA I"TOKN" IPB I
C  I       I        I DM.....I        I OBI EH.I"TOKN1"I   I
C  +-------+--------+--------+--------+------+------+-------+---+
C  I  1    I   2    I   3    I    4   I   5  I  6   I   7   I 8 I
C  +-------+--------+--------+--------+------+------+-------+---+
C
C
C
C                   OPMAT RMSW T # 380:
C                  -----------------------
C+-----------I--------------I------I-----------------------------------
C  # COBA   I    # COBA B I KTO  I
C OT HAAA  I    OTPEKE   IOPE.I
C BCEO MSW  I    RMSW B    I      I       OOHAEHE - HAEHE
C OCAH   I    FM0032    I      I
C------------I--------------I------I-----------------------------------
C     9      I     0        I      I HOMEP A ( BCEA 0 )
C----------------------------------------------------------------------
C    10      I     1        I  DM  I TX - BPEM BOMOHOO EPEKEH;
C    11      I     2        I  DM  I KX - KAATE MEHEH COCTOH
C            I              I      I      OPTA  B/B HA AE ;
C    12      I     3        I  FM  I TTAKT - EPO TAKTOBO ACTOT ;
C    13      I     4        I  FM  I P - A OTAOHO EAT:
C            I              I      I     P=0 - OTAOHA EAT OTK.
C            I              I      I     P=1 - OTAOHA EAT BK.
C    14      I     5        I  FM  I           PEEPB
C    15      I     6        I  FM  I           PEEPB
C    16      I     7        I  DM  I KX - KAATE MEHEH COCTOH
C            I              I      I      OPTA B/B HA AE ;
C    17      I     8        I  DM  I TT - TEKEE BPEM ;
C    18      I     9        I  DM  I R0 - COEPMOE POH R0 P T=TT ;
C    19      I    10        I  DM  I R1 - COEPMOE POH R1 P T=TT ;
C    20      I    11        I  DM  I R2 - COEPMOE POH R2 P T=TT ;
C    21      I    12        I  DM  I R3 - COEPMOE POH R3 P T=TT ;
C    22      I    13        I  DM  I R4 - COEPMOE POH R4 P T=TT ;
C    23      I    14        I  DM  I R5 - COEPMOE POH R5 P T=TT ;
C    24      I    15        I  DM  I R6 - COEPMOE POH R6 P T=TT ;
C    25      I    16        I  DM  I R7 - COEPMOE POH R7 P T=TT ;
C    26      I    17        I  DM  I FLC-HAEHE AA "C" CC P T=TT
C    27      I    18        I  DM  I FLV-HAEHE AA "V" CC P T=TT
C    28      I    19        I  DM  I FLZ-HAEHE AA "Z" CC P T=TT
C    29      I    20        I  DM  I FLN-HAEHE AA "N" CC P T=TT
C    30      I    21        I  DM  I FLT-HAEHE AA "T" CC P T=TT
C    31      I    22        I  DM  I FLIO-HAEHE AA "I/O" CC
C            I              I      I             P T=TT ;
C    32      I    23        I  DM  I IPORT  -COEPMOE OPTA BBOA
C    33      I    24        I  DM  I IPORT1 -COEPMOE OPTA BBOA
C            I              I      I             P T=TT ;
C    34      I    25        I  FM  I ADRPROG-MAKCMAH APEC O ;
C    35      I    26        I  FM  I ADRPRTO-APEC OPTA BBOA;
C    36      I    27        I  FM  I ADRPRTI-APEC OPTA BBOA ;
C    37      I    28        I  DM  I TO - CTAPOE BPEM ;
C    38      I    29        I  DM  I R0 - COEPMOE POH R0 P T=TO ;
C    39      I    30        I  DM  I R1 - COEPMOE POH R1 P T=TO ;
C    40      I    31        I  DM  I R2 - COEPMOE POH R2 P T=TO ;
C    41      I    32        I  DM  I R3 - COEPMOE POH R3 P T=TO ;
C    42      I    33        I  DM  I R4 - COEPMOE POH R4 P T=TO ;
C    43      I    34        I  DM  I R5 - COEPMOE POH R5 P T=TO ;
C    44      I    35        I  DM  I R6 - COEPMOE POH R6 P T=TO ;
C    45      I    36        I  DM  I R7 - COEPMOE POH R7 P T=TO ;
C    46      I    37        I  DM  I FLC-HAEHE AA "C" CC P T=TO
C    47      I    38        I  DM  I FLV-HAEHE AA "V" CC P T=TO
C    48      I    39        I  DM  I FLZ-HAEHE AA "Z" CC P T=TO
C    49      I    40        I  DM  I FLN-HAEHE AA "N" CC P T=TO
C    50      I    41        I  DM  I FLT-HAEHE AA "T" CC P T=TO
C    51      I    42        I  DM  I FLIO-HAEHE AA "I/O" CC
C            I              I      I             P T=TO ;
C    52      I    43        I  DM  I IPORT  -COEPMOE OPTA BBOA
C    53      I    44        I  DM  I IPORT1 -COEPMOE OPTA BBOA
C            I              I      I             P T=TO ;
C    54      I    45        I  FM  I  # - HOMEP EMEHTA;
C    55      I    46        I  FM  I  #CM - HOMEP TOKA EMEHTA # ;
C    56      I    47        I  LM  I  ATOKM - AP B TOKN/N1 HAEH
C            I              I      I           TOKA HOMEPA #CM ;
C----------------------------------------------------------------------
C  OA HA MSW --> LM<BC> = 56
C
C  HA EPEMEH. ACT --> LM<RMSW> = 47
C----------------------------------------------------------------------
C
C
C
C        OPAHA AMT B PEAHO MKPOPOECCOPHO CCTEME
C         B MOEPE EE POPAMME (MACCB MEM  MEM1)
C        -------------------------------------------------------
C
C        OPAHA AMT B PEAHO MKPOPOECCOPHO CCTEME
C
C
C               COBO
C           AT      AT                      AT
C        *---------+---------*               *---------*
C        ! CTAP ! MA ! 000000        ! MA ! 000000
C        ! CTAP ! MA ! 000002        ! CTAP ! 000001
C        ! CTAP ! MA ! 000004        ! MA ! 000002
C        ! CTAP ! MA ! 000006        ! CTAP ! 000003
C        ! CTAP ! MA ! 000010        ! MA ! 000004
C        ! CTAP ! MA ! 000012        ! CTAP ! 000005
C        ! CTAP ! MA ! 000014        ! MA ! 000006
C        ! ................. ! ......        ! CTAP ! 000007
C        ! ................. ! ......        ! ....... ! ......
C        ! ................. ! ......        ! ....... ! ......
C        ! CTAP ! MA ! 003774        ! MA ! 003776
C        ! CTAP ! MA ! 003776        ! MA ! 003777
C        *---------+---------*               *---------*
C
C
C        OPAHA AMT B MOEPE POPAMME
C            (MACCB   MEM    MEM1 )
C     *-------------------------------------*
C     ! COBO C APECOM 000000              ! 0001
C     ! CTAP AT COBA C APECOM 000000 ! 0002
C     ! COBO C APECOM 000002              ! 0003
C     ! CTAP AT COBA C APECOM 000002 ! 0004
C     ! COBO C APECOM 000004              ! 0005
C     ! CTAP AT COBA C APECOM 000004 ! 0006
C     ! COBO C APECOM 000006              ! 0007
C     ! CTAP AT COBA C APECOM 000006 ! 0008
C     ! COBO C APECOM 000010              ! 0009
C     ! CTAP AT COBA C APECOM 000010 ! 0010
C     ! ................................... ! ....
C     ! ................................... ! ....
C     ! ................................... ! ....
C     ! COBO C APECOM 003776              ! 2047
C     ! CTAP AT COBA C APECOM 003776 ! 2048
C     *-------------------------------------*
C
C
C----------------------------------------------------------------------
C
C
C     BBOME HAEH:
C
C     I #.1 - I #.8  -  POH MKPOPOECCOPA ( B ECTHOM BE ) ;
C     I #.9          -  CC MKPOPOECCOPA ( B ECTHOM BE ) ;
C     I #.10         -  COEPMOE OPTA BBOA( B ECTHOM BE ) ;
C     I #.11         -  BPEM,  KOTOPOO XPAHTC KAAHHE HAEH;
C
C
CZZZ-------------------------------------------------------------------
         COMMON /PROF1/ MASPRT(200)
         COMMON /PROF2/ MACTAB(800)
         COMMON /PROF3/ FUNTAB(50)
         COMMON /MEMER/ MEM(2048), MEM1(2048)
         DIMENSION MSW(*), RMSW(*), YALL(*), JALL(*), LOGYTR(*)
         DIMENSION VALLN(*), RMASPT(1), VALLN1(*), TOKN(*), TOKN1(*)
         DIMENSION MSWALL(*), RMSWAL(*)
         INTEGER ADPORT, ADPROG
         EQUIVALENCE ( MASPRT(1), RMASPT(1) )
         EQUIVALENCE ( MASPRT(62), HXMIN )
         EQUIVALENCE ( MASPRT(14), NWTRE )
         EQUIVALENCE ( MASPRT(60), FTEST )
         INTEGER FTEST
         EQUIVALENCE ( ZAPROS, MASPRT(28) )
         EQUIVALENCE ( HXG,    MASPRT(61) )
         EQUIVALENCE ( NDALL,  MASPRT(23) )
         EQUIVALENCE ( TN,     MASPRT(29) )
         EQUIVALENCE ( H0,     MASPRT(30) )
         EQUIVALENCE ( H1,     MASPRT(32) )
         EQUIVALENCE ( H2,     MASPRT(33) )
         EQUIVALENCE ( FKOM,   MASPRT(34) )
         EQUIVALENCE ( TXG,    MASPRT(35) )
         EQUIVALENCE ( NTXG,   MASPRT(36) )
         EQUIVALENCE ( EPSKOM, MASPRT(39) )
         EQUIVALENCE ( ZEROCP, MASPRT(50) )
         EQUIVALENCE ( RN, N )
         INTEGER FKOM, ZAPROS, TIP
         NOUT = 10
C--->  KOHTPO TA
         TIP = MSW(2)
         IF ( TIP .EQ. 380 ) GO TO 11
C######################################################################
         NWTRE = MASPRT(14)
         WRITE(NWTRE,9998) MSW(1), TIP
9998     FORMAT( ' *** O. CO B DM0036 - APOC HA OCBAHE O
     =O TA ***'/
     =    ' *** EMEHT # ', I10, ' T MOE # ', I10, ' ***'//)
         CALL SUBERR(1)
         RETURN
C######################################################################
11       CONTINUE
C---> BOP PEMA:
         GO TO ( 667, 666, 600, 500       ), ZAPROS
C===> HAE OKA
         NWTRE = MASPRT(14)
         WRITE(NWTRE,9997) MSW(3), ZAPROS
9997     FORMAT( ' *** DM MOHTOP #', I4, ' APOC OCBAH OOEH
     = ***'/ ' *** ZAPROS = ', I5, ' - HOPPETC ***')
         RETURN
C======================================================================
C---------------Z A P R O S = 1----------------------------------------
667      CONTINUE
         KOD = 0
         RETURN
C======================================================================
C---------------Z A P R O S = 2----------------------------------------
666      CONTINUE
C---> CPOC BPEMEH  TX - BOMOHOO EPEKEH ...
         MSW(11) = 0
         KOD = 0
         RETURN
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C---- Z A P R O S = 3 ---- TOKN1    VALLN1  OPEEEH ---------------
600      CONTINUE
C---> AOMHM CTAP TOK.
         RMSW(37) = RMSW(17)
         DO 602 I=1,16
         MSW(37+I) = MSW(17+I)
602      CONTINUE
         IADPRG = MSW(34)
         DO 605 I=1,IADPRG
         MEM1(I) = MEM(I)
605      CONTINUE
C-->     TO B OPT BBOA ?...
         MSW(33) = IFIX( TOKN1(MSW(56)))
C--> POOM BOHT PAB POPAMM.
         TN1 = TN + H0
CCCC     WRITE (6,*) MSW(33)
C400     FORMAT (8X,E15.6)
         CALL ADEC00( RMSW(17), TN1, MSW(13), NOUT, MSW(11), MSW(18),
     *   MSW(26), MSW(32), MSW(33),MSW(35),MSW(36), MSW(34) , IER )
         IF( IER .NE. 0 ) GO TO 9999
         RMSW(10) = RMSW(17)
         DO 422 I=1,8
         TOKN1(ITOK+I-1) =  MSW(17+I)*1.
422      CONTINUE
         ICCP = MSW(31)*128 + MSW(30)*16 + MSW(29)*8 +
     +          MSW(28)*4   + MSW(27)*2  + MSW(26)
         TOKN1(ITOK+8) =  ICCP*1.
         TOKN1(ITOK+9) = MSW(32)*1.
         TOKN1(ITOK+10)= RMSW(10)
CCCCC    WRITE (6,430) (TOKN1(ITOK+I-1),I=1,11)
C430     FORMAT (5X,F12.8)
         IF( MSW(11) .NE. 1 ) RETURN
         FKOM = 1
         HX = RMSW(10) - TN
         HXG = MIN( HX,HXG )
         TXG = TN + HXG
         RETURN
C######################################################################
500      CONTINUE
C--- Z A P R O S = 4  --- KCA CMEH COCTOH BXOHOO CHAA.
C----------------------------------------------------------------------
         KOD = 0
         MSW(33) = IFIX(TOKN1(MSW(56)))
         IF( MSW(11) .EQ. 0 ) GO TO 520
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C---> EC TXG  "PMEPHO" PABHO  TX MOE, TO CMEHA HHA !
         TX = RMSW(10)
         EPST = ABS( TX - TXG )
         IF( EPST .GT. EPSKOM ) GO TO 510
C---> HAE CMEHM COCTOHE...
         GO TO 520
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
510      CONTINUE
C---> B CCTEME POOA KOMMTA PAHE, EM  HAC. BEPHEMC !!!
         RMSW(17) = RMSW(37)
         DO 515 I=1,16
         MSW(17+I) = MSW(37+I)
515      CONTINUE
         IADPRG = MSW(34)
         DO 516 I=1,IADPRG
         MEM(I) = MEM1(I)
516      CONTINUE
C-->  BOHM PAB POPAMM O MOMEHTA BPEMEH  T=TXG
         CALL ADEC00( RMSW(17), TXG, MSW(13), NOUT, MSW(11), MSW(18),
     *   MSW(26), MSW(32), MSW(33),MSW(35),MSW(36), MSW(34) , IER )
         IF( IER .NE. 0 ) GO TO 9999
         RMSW(10) = RMSW(17)
C---> BBEEM TEKEE COCTOHE M-CCTEM
520      CONTINUE
         ITOK = MSW(7)
         DO 522 I=1,8
         TOKN1(ITOK+I-1) =  MSW(17+I)*1.
522      CONTINUE
         ICCP = MSW(31)*128 + MSW(30)*16 + MSW(29)*8 +
     +          MSW(28)*4   + MSW(27)*2  + MSW(26)
         TOKN1(ITOK+8) =  ICCP*1.
         TOKN1(ITOK+9) = MSW(32)*1.
         TOKN1(ITOK+10)= RMSW(10)
C****    WRITE (6,530) (TOKN1(ITOK+I-1),I=1,11)
C530     FORMAT (5X,F12.8)
         RETURN
C######################################################################
C-->  EAT COOEH O OKAX.
9999     CONTINUE
         NWTRE = MASPRT(14)
         GO TO ( 9991, 9992, 9993, 9994, 9995, 9996 ),IER
         RETURN
C----------------------------------------------------------------------
9991     CONTINUE
         WRITE(NWTRE,99991) MSW(1), TIP
99991    FORMAT( ' *** OECK CO B PABE POPAMME  ',
     =   'MKPOPOECCOPHO CCTEM '/
     =   ' *** OOHA AC KOMAH,O BXO A PEE O ***'/
     =   ' *** EMEHT # ', I10, ' T MOE # ', I10, ' ***'//)
         CALL SUBERR(1)
         RETURN
C----------------------------------------------------------------------
9992     CONTINUE
         WRITE(NWTRE,99992) MSW(1), TIP
99992    FORMAT( ' *** OECK CO B PABE POPAMME  ',
     =   'MKPOPOECCOPHO CCTEM '/
     =   ' *** OPAEHE K EKE AMT,MEE HEETH APECC  ***'/
     =   ' *** EMEHT # ', I10, ' T MOE # ', I10, ' ***'//)
         CALL SUBERR(1)
         RETURN
C----------------------------------------------------------------------
9993     CONTINUE
         WRITE(NWTRE,99993) MSW(1), TIP
99993    FORMAT( ' *** OECK CO B PABE POPAMME  ',
     =   'MKPOPOECCOPHO CCTEM '/
     =   ' *** OOHA AC KOMAH                           ***'/
     =   ' *** EMEHT # ', I10, ' T MOE # ', I10, ' ***'//)
         CALL SUBERR(1)
         RETURN
C----------------------------------------------------------------------
9994     CONTINUE
         WRITE(NWTRE,99994) MSW(1), TIP
99994    FORMAT( ' *** OECK CO B PABE POPAMME  ',
     =   'MKPOPOECCOPHO CCTEM '/
     =   ' *** APOC HA BBO AHHX  OPTA BBOA-BBOA        ***'/
     =   ' *** EMEHT # ', I10, ' T MOE # ', I10, ' ***'//)
         CALL SUBERR(1)
         RETURN
C----------------------------------------------------------------------
9995     CONTINUE
         WRITE(NWTRE,99995) MSW(1), TIP
99995    FORMAT( ' *** OECK CO B PABE POPAMME  ',
     =   'MKPOPOECCOPHO CCTEM '/
     =   ' *** AHHA KOMAHA OKA HE PEAOBAHA                 ***'/
     =   ' *** EMEHT # ', I10, ' T MOE # ', I10, ' ***'//)
         CALL SUBERR(1)
         RETURN
C----------------------------------------------------------------------
9996     CONTINUE
         WRITE(NWTRE,99996) MSW(1), TIP
99996    FORMAT( ' *** OECK CO B PABE POPAMME  ',
     =   'MKPOPOECCOPHO CCTEM '/
     =   ' *** KO KOMAH OTCTCTBET B EPEHE KOMAH           ***'/
     =   ' *** EMEHT # ', I10, ' T MOE # ', I10, ' ***'//)
         CALL SUBERR(1)
         RETURN
C----------------------------------------------------------------------
         END
