       SUBROUTINE MCIU50( TN, H0, UOPN, UOPN1, UYPN, UYPN1,
     *                    DTCIU, DTMCIU, MSW50, RMSW50 )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C   OPOPAMMA: MCIU50( TN, H0, UOPN, UOPN1, UYPN, UYPN1,
C                         DTCIU, DTMCIU, MSW50, RMSW50 )
C   HAHAEHE: "EHEPATOP CHAOB C" O AOPTM
C   -----------  "BEPTKAHOO PABEH" C ETOM APETA-PAPEEH
C                 OA CHAOB "C" ( OT 5.08.86 );
C
C   METO:    CPABHEHE BX CHAOB, KCA EPEXOA X
C   -----      "PAHOCT" EPE "HO" OT OTPATEHOO HAEH;
C              O TM AHHM -> BCEHE TS - BPEMEH CTAPTA,
C              OCTAHOE OEBHO;
C
C      !!! "C" CTAPTT B TOKE EPECEEH U_PABEH C
C                         "HCAAM" ACTKAM U_OOPHOE.
C      !!!
C
C
C   APAMETP-OOHAEH:
C   ----------------------
C              UOPN, UOPN1 - OOPHE HAPEH,
C              UYPN, UYPN1 - PABE HAPEH,
C                              B T=TN  T=TN+H0
C              TN - BPEM N-O AA, H0 - A HTEP.
C              DTCIU - TEHOCT MCA;
C              DIMCIU - MHMAHA TEHOCT MCA,
C                       KOTOP "BCTBT" BET;
C              MSW50 (RMSW50) - MACCBA OCAH BEHT:
C              *************
C
C
C       OPMAT MSWV_EHT  DM00B9:
C       -------------------------------
C
C      COBO                   HAEHE
C
C      1       KD - KO COCTOH: =0 - AKPT, =1 - OTKPT;
C      2       HX - A OT TN, BOMOHOE BPEM EPEKEH;
C
C ( B [*] HOMEPA MSW_VEHT  / "MCIU50" )
C
C  [1] 3       TS - BPEM CTAPTA MCA( "E" KOMMTA );
C  [2] 4       TK - BPEM HA MCA( "E" KOMMTA );
C  [3] 5       CX - KO PAPEEH/APETA "C":
C                   =0 - C APEEHO OABAT HA BEHT,
C                   =1 - C PAPEEHO OABAT HA BEHT;
C [4] 6        TX - BPEM, C KOTOPOO ECTBET KO "CX";
C
C
C [5] 7        MCIU - KO MCA --->
C                     MCIU   = 00  --> "C" HET B [TN, TN+H0];
C                                       HXCIU = 0.0;
C                     MCIU   = 01  --> B [TN, TN+H0] -> EPEH POHT
C                                   MCA "C", HXCIU = HTEPBA OT
C                                      TN O EPEHEO POHTA "C";
C                     MCIU   = 10 -->  B [TN, TN+H0] -> AH POHT
C                                   MCA "C", HXCIU = HTEPBA
C                                      OT TN O AHEO POHTA MCA;
C                     MCIU   = 11 -->  B [TN, TN+H0] "C" BKEH,
C                                      COCTOHE HE MEH, HXCIU=0.0;
C
C
C [6] 8        HXCIU - A OT TN, O OEPEHOO POHTA "C";
C (---)
C     9              - A KD COCTOH
C    10              - PEEPB
C********************************************************************
C
C   OPOPAMM:   HET;
C   ------------
C   PMEAHE:   1.  H0  OEH T MEHE DTCIU;
C   ----------
C
CZZZ-------------------------------------------------------------------
       DIMENSION MSW50(*), RMSW50(*)
       INTEGER CX
C
       TX = RMSW50(4)
       CX = MSW50(3)
C
C-->  "ECTECTBEHH" CTAPT.., ECT  OH B [TN, TN+H0 ] ?
       TN1 = TN+H0
       DUN = UOPN - UYPN
       DUN1 = UOPN1 - UYPN1
C-->  TS - OEPEHO HE "XOET" ??
       IF ( DUN.LT.0.0 .AND. DUN1.GE.0.0 .AND. UOPN.GT.UOPN1 )  GO TO 1
       IF ( DUN.GT.0.0 .AND. DUN1.LE.0.0 .AND. UOPN.GT.UOPN1 )  GO TO 1
C-->  OEPEHOO CTAPTA HEO, PEOOAEM TS  TK OPEEEHHM
C  PAOP CX, TX APAMETPOB
       GO TO 2
1      CONTINUE
C-->  "E" CTAPT HOBOO M.
       HXCIUE = -( DUN / ( DUN1 - DUN ) ) * H0
       TSE = TN + HXCIUE
       TKE = TSE + DTCIU
C-->  KCPEM TO..
       RMSW50(1) = TSE
       RMSW50(2) = TKE
2      CONTINUE
C-->  OCEH BAHH M. "C" -->
       TSE = RMSW50(1)
       TKE = RMSW50(2)
C-->  TS    TK -- M. PABEH C ETOM CX,TX
C-->  CX=0 -> APET, CX=1 - PAPEEHE HA "C", TX - KOA
C
       IF ( CX .EQ. 1 ) GO TO 3
C-->  ECTBET APET...
C-->  MEHM, EC HAO  BPEMEHA CTAPTA  HA...
C-->  EO.  M. HET..
       TS = -DTCIU
       TK = - DTCIU
       IF ( TX .LT. TSE ) GO TO 100
C-->  PE. C ECT...
       TS = TSE
       TK = TKE
       IF ( TKE .LT. TX ) GO TO 100
C-->  BMO C  OPBAETC O CPEHE MCA
C     TSE <= TX <= TKE
       TS = TSE
       TK = TX
       GO TO 100
C----------------------------------------------------------------------
3      CONTINUE
C-->  C  PAPE...
C  PE  C ECT
       TS = TSE
       TK = TKE
       IF ( TX .LE. TSE ) GO TO 100
C-->  PE. C HET
       TS = -DTCIU
       TK = -DTCIU
       IF ( TKE .LE. TX ) GO TO 100
C-->  BMO PAPE "O CPEHE"
       TS = TX
       TK = TKE
C**********************************************************************
C**********************************************************************
100    CONTINUE
C-->  TS   TK  C ETOM  KODA CX   TX BPEMEH
C-->  KAPTA C--->
       M1 = 0
       M2 = 0
C      MCIU -->  M1.M2
       IF ( TS .LE. TN   .AND.  TN  .LT. TK )   M1 = 1
       IF ( TS .LE. TN1  .AND.  TN1 .LE. TK )   M2 = 1
C-->  EC M1=0  M2=0 -->  C HET.....
       IF ( M1 .EQ. 0  .AND.  M2 .EQ. 0 ) GO TO 200
C-->  M1  M2  =1 C  HE KOHAET!!
       IF ( M1 .EQ. 1  .AND.  M2 .EQ. 1 ) GO TO 201
C-->  O. M1 = 1 (A M2=0 )  ->  AH POHT..
       IF ( M1 .EQ. 1 ) GO TO 202
C--->  HE TAK,  M1=0, A M2 = 1       -->  EPEH POHT
C -->  T. C, KAKA OAC..
       DTXXX = TK - TS
C-->  MOET "C" OEH KOPOTK ?
       IF ( DTXXX .LE. DTMCIU ) GO TO 200
C-->  C BEHT OBCTBET..
       MCIU = 01
       HXCIU = TS - TN
       GO TO 300
C######################################################################
200    CONTINUE
C-->  M1=0, M2=0
       MCIU = 0
       HXCIU = 0
       GO TO 300
201    CONTINUE
C-->  M1, M2 = 1
       MCIU = 11
       HXCIU = 0.0
       GO TO 300
202    CONTINUE
C-->  M1 = 1, M2 = 0 -->  AOK..
       MCIU = 10
       HXCIU = TK - TN
C**********************************************************************
C**********************************************************************
300    CONTINUE
C-->  KCPEM
       RMSW50(6) = HXCIU
       MSW50(5) = MCIU
       RETURN
       END
