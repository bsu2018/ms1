       SUBROUTINE FM0016(BA0T, KNOTT, PAR0T, RMSW, LM )
CXXX----KOMEKC "MS1" --> BEPC 1.1  (OT  EKAP  1987 .)-----------
C   OPOPAMMA: FM0016(BA0T, KNOTT, PAR0T, RMSW, LM )
C   -------------
C   HAHAEHE:  HACTPOKA MAKPOMOEE POBX OECKX EMEHTOB:
C   ----------
C               +-----+--------------------------------------+
C               I     I                                      I
C               I T I    HAMEHOBAHE EMEHTA             I
C               I     I                                      I
C               +-----+--------------------------------------+
C               I 333 I POBO  RS-TPEP                 I
C               +-----+--------------------------------------+
C               I 334 I POBO   D-TPEP                 I
C               +-----+--------------------------------------+
C               I 335 I POBO   T-TPEP                 I
C               +-----+--------------------------------------+
C               I 360 I KOMAPATOP(1)                        I
C               +-----+--------------------------------------+
C               I 361 I KOMAPATOP(2)                        I
C               +-----+--------------------------------------+
C                PHAK TIP # 4 -> O. MAKPOMOE.
C                ( DM0020, LM0008 )
C                      OPMPET "EPEMEHH" ACT RMSW OCAH
C
C                      HA:   BCEX TOB :==>+1<VAR>
C----------------------------------------------------------------------
C              EMEHT OCBATC:
C
C          # T 33X  0    #1 #CM1  #2 #CM2 ;
C
C         E
C          #I,#CMI- HOMEP EMEHTA  HOMEP TOKA EMEHTA ,
C                     COEMOO B KAECTBE BXOHOO CHAA;
C         -------------------------------------------------------------
C
C          # T 360  0    #1 #CM1  #2 #CM2 ;
C
C         E
C          #I,#CMI- HOMEP EMEHTA  HOMEP TOKA EMEHTA ,
C                     COEMOO B KAECTBE BXOHOO CHAA;
C         -------------------------------------------------------------
C
C          # T 361  0    1  2  3  4 ;
C
C         E
C            I     - HOMEPA OB, HAPEH ME KOTOPM
C                     COTC B KAECTBE BXOHX CHAOB;
C         -------------------------------------------------------------
C
C   METO:         PAMETKA OE RMSW O MOE
C   -----
C
C   APAMETP:     BA0T, KNOTT, PAR0T - "OTPEK" HOPMAOHHX
C  ----------      MACCOBOB BA0, KNOT, PAR0 ( CM. INPUT0  GETMSW );
C                  RMSW - "EPEMEHHA" ACT MSW ( "OTPEOK" MSWALL );
C                  LM - HA "EPEMEHHO" ACT RMSW P FGMSW = 0;
C                  LM - HA BCEO MSW OCAH      P FGMSW = 1;
C
C   OPOPAMM:  1.COMMON PROF1
C   ------------
C
C   PMEAHE:    1. KOHTPO B MHMAHOM O"EME;
C   -----------    2. BCE HE OPEEEME O RMSW AHTC;
C                  3. HE PBOTC OPMAT RMSW:
C
C
C              OPMAT RMSW T # 33X  360:
C              ----------------------------
C+-----------I--------------I------I-----------------------------------
C  # COBA   I    # COBA B I KTO  I
C OT HAAA  I    OTPEKE   IOPE.I
C BCEO MSW  I    RMSW B    I      I       OOHAEHE - HAEHE
C OCAH   I    FM0016    I      I
C------------I--------------I------I-----------------------------------
C     9      I     0        I      I HOMEP A ( BCEA 0 )
C----------------------------------------------------------------------
C    10      I     1        I  DM  I        PEEPB
C            I              I      I
C    11      I     2        I  DM  I        PEEPB
C            I              I      I
C    12      I     3        I  FM  I  #1 - HOMEP EMEHTA;
C    13      I     4        I  FM  I  #CM1 - HOMEP TOKA EMEHTA #1;
C    14      I     5        I  LM  I  ATOKM1 - AP B TOKN/N1 HAEH
C            I              I      I           TOKA HOMEP #CM1
C            I              I      I           EMEHTA #1;
C    15      I     6        I  FM  I  #2 -      -"-
C    16      I     7        I  FM  I  #CM2 -      -"-
C    17      I     8        I  LM  I  ATOKM2 -    -"-
C----------------------------------------------------------------------
C  OA HA MSW --> LM<BC> = 17
C
C  HA EPEMEH. ACT --> LM<RMSW> = 8
C----------------------------------------------------------------------
C
C
C              OPMAT RMSW T # 335:
C              ----------------------
C+-----------I--------------I------I-----------------------------------
C  # COBA   I    # COBA B I KTO  I
C OT HAAA  I    OTPEKE   IOPE.I
C BCEO MSW  I    RMSW B    I      I       OOHAEHE - HAEHE
C OCAH   I    FM0016    I      I
C------------I--------------I------I-----------------------------------
C     9      I     0        I      I HOMEP A ( BCEA 0 )
C----------------------------------------------------------------------
C    10      I     1        I  DM  I        PEEPB
C            I              I      I
C    11      I     2        I  DM  I        PEEPB
C            I              I      I
C    12      I     3        I  FM  I  #1 - HOMEP EMEHTA;
C    13      I     4        I  FM  I  #CM1 - HOMEP TOKA EMEHTA #1;
C    14      I     5        I  LM  I  ATOKM1 - AP B TOKN/N1 HAEH
C            I              I      I           TOKA HOMEP #CM1
C            I              I      I           EMEHTA #1;
C----------------------------------------------------------------------
C  OA HA MSW --> LM<BC> = 14
C
C  HA EPEMEH. ACT --> LM<RMSW> = 5
C----------------------------------------------------------------------
C
C
C                   OPMAT RMSW T # 361:
C                   ----------------------
C+-----------I--------------I------I-----------------------------------
C  # COBA   I    # COBA B I KTO  I
C OT HAAA  I    OTPEKE   IOPE.I
C BCEO MSW  I    RMSW B    I      I       OOHAEHE - HAEHE
C OCAH   I    FM0016    I      I
C------------I--------------I------I-----------------------------------
C     9      I     0        I      I HOMEP A ( BCEA 0 )
C----------------------------------------------------------------------
C    10      I     1        I  DM  I        PEEPB
C            I              I      I
C    11      I     2        I  DM  I        PEEPB
C            I              I      I
C    12      I     3        I  FM  I  1   - HOMEP A;
C    13      I     4        I  FM  I  2   - HOMEP A;
C    14      I     5        I  FM  I  3   - HOMEP A;
C    15      I     6        I  FM  I  4   - HOMEP A;
C----------------------------------------------------------------------
C  OA HA MSW --> LM<BC> = 15
C
C  HA EPEMEH. ACT --> LM<RMSW> = 6
CZZZ-------------------------------------------------------------------
       COMMON /PROF1/ MASPRT(200)
       DIMENSION BA0T(*), KNOTT(*), PAR0T(*), RMSW(*)
       EQUIVALENCE( NWTR, MASPRT(13) )
       EQUIVALENCE( NWTRE, MASPRT(14) )
       EQUIVALENCE( FGMSW, MASPRT(87) )
       EQUIVALENCE( H0   , MASPRT(30) )
       EQUIVALENCE ( RN  ,   N  )
       INTEGER  TIP, BA0T, FGMSW
       NEL = BA0T(1)
       TIP = BA0T(2)
       NTIP= TIP - 332
       GO TO ( 1 , 1 , 2  ), NTIP
       IF (  TIP .EQ. 360 ) GO TO 3
       IF (  TIP .EQ. 361 ) GO TO 4
C!!!-------------------------------------------------------------------
       WRITE(NWTRE, 501 ) NEL, TIP
501    FORMAT(/' *** O. CO B FM0016 --> HOMEP TA HE HA ***'/
     =  ' *** HOMEP EMEHTA ', I5, ' HOMEP TA ', I5, ' ***'/)
C!!!-------------------------------------------------------------------
       CALL SUBERR(TIP)
C######################################################################
1      CONTINUE
C----------------------------------------------------------------------
C --->           POBO RS-TPEP
C --->           POBO  D-TPEP
C----------------------------------------------------------------------
C-->  PHT  TO MOHO COPMPOBAT..
       LM = 8
       DO 10 I=1,LM
10     RMSW(I) = 0.0
C---> BBEEM HOMEPA BXOHX TOKOB.
       NEL1 = IFIX ( PAR0T(1) )
       NEL2 = IFIX ( PAR0T(3) )
       NSM1 = IFIX ( PAR0T(2) )
       NSM2 = IFIX ( PAR0T(4) )
C---> AOMHM HOMEPA BXOHX TOKOB.
       N = NEL1
       IF( N .GE. NEL ) GO TO 9999
       RMSW(3) = RN
       N = NEL2
       IF( N .GE. NEL ) GO TO 9999
       RMSW(6) = RN
       N = NSM1
       RMSW(4) = RN
       N = NSM2
       RMSW(7) = RN
       RETURN
C######################################################################
2      CONTINUE
C----------------------------------------------------------------------
C --->           POBO  T-TPEP
C----------------------------------------------------------------------
C-->  PHT  TO MOHO COPMPOBAT..
       LM = 5
       DO 20 I=1,LM
20     RMSW(I) = 0.0
C---> BBEEM HOMEPA BXOHX TOKOB.
       NEL1 = IFIX ( PAR0T(1) )
       NSM1 = IFIX ( PAR0T(2) )
C---> AOMHM HOMEPA BXOHX TOKOB.
       N = NEL1
       IF( N .GE. NEL ) GO TO 9999
       RMSW(3) = RN
       N = NSM1
       RMSW(4) = RN
       RETURN
C######################################################################
3      CONTINUE
C----------------------------------------------------------------------
C --->           KOMAPATOP(1)
C----------------------------------------------------------------------
C-->  PHT  TO MOHO COPMPOBAT..
       LM = 8
       DO 30 I=1,LM
30     RMSW(I) = 0.0
C---> BBEEM HOMEPA BXOHX TOKOB.
       NEL1 = IFIX ( PAR0T(1) )
       NEL2 = IFIX ( PAR0T(3) )
       NSM1 = IFIX ( PAR0T(2) )
       NSM2 = IFIX ( PAR0T(4) )
C---> AOMHM HOMEPA BXOHX TOKOB.
       N = NEL1
       RMSW(3) = RN
       N = NSM1
       RMSW(4) = RN
       N = NEL2
       RMSW(6) = RN
       N = NSM2
       RMSW(7) = RN
       RETURN
C######################################################################
4      CONTINUE
C----------------------------------------------------------------------
C --->           KOMAPATOP(2)
C----------------------------------------------------------------------
C-->  PHT  TO MOHO COPMPOBAT..
       LM = 6
       DO 40 I=1,LM
40     RMSW(I) = 0.0
C---> BBEEM HOMEPA BXOHX OB.
       NY1 = IFIX ( PAR0T(1) )
       NY2 = IFIX ( PAR0T(2) )
       NY3 = IFIX ( PAR0T(3) )
       NY4 = IFIX ( PAR0T(4) )
C---> AOMHM HOMEPA BXOHX OB.
       N = NY1
       RMSW(3) = RN
       N = NY2
       RMSW(4) = RN
       N = NY3
       RMSW(5) = RN
       N = NY4
       RMSW(6) = RN
       RETURN
C######################################################################
9999   CONTINUE
C!!!-------------------------------------------------------------------
       WRITE(NWTRE, 555 ) NEL, TIP,N
555    FORMAT(/' *** OKA B FM0016 -->HEPABHO AAH BXOHE AHH
     =E   ***'/' *** HA BXO EMEHTA ', I5, ' HOMEP TA ', I5,' ***',
     =         ' *** OAETC TOK EMEHTA, MEEO O OPKOB
     =HOMEP ( # ' ,I3,' )  *** ')
C!!!-------------------------------------------------------------------
       CALL SUBERR(TIP)
C----------------------------------------------------------------------
       RETURN
       END
