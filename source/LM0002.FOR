       SUBROUTINE LM0002( MSW, RMSW, ADR, MSWALL, RMSWAL, KOD )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C   OPOPAMMA: LM0002( MSW, RMSW, ADR, MSWALL, RMSWAL, KOD )
C   -------------
C   HAHAEHE:   OECKA HACTPOKA MSW MAKPOMOE TA # 50
C   ----------     *** BOTE HE 3-0 ( . MA. 3X3X0) ****
C
C                  EMEHT MOET T OECK CBAH C MAKPOMOEM:
C                       T # 40,  # 63 ( 3-X AHA ..C.),
C                           # 13 ( "MEPTE HAPEH" );
C
C ===                  TP EPBE HAEH  TOKN/TOKN1 - PHMATC
C                      A HAEH HAPEH PABEH;
C ===
C
C   METO:        OCK B MSW_ALL OCAH EMEHTA *. MA.*
C   -----         ( O. T COACHO BCTPOEHHO TA. "LTIP" )
C                 B CAE HAXOEH -> OOPMPOBAHE MSW_OCAH;
C                 B TOM CAE KOD = 0, HAE = 1;
C   APAAMETP:   MSW(RMSW) - "OTPEOK" MSW_MOE T # 50;
C   ----------    ADR - APEC B MSW_ALL MSW_OCAH TO MOE;
C                 MSWALL(RMSWAL) - BEC CCOK MSW COB;
C                 KOD - = 0 - COPMPOBA MSW,
C                       = 1 - O. OK;
C                      ( HA NWTR COOEHE BBOTC );
C   OPOPAMM: 1. PROF1, PROF2
C   ------------  2. SEQMS0
C
C   PMEAHE:  OPMAT MSW_OCAH ---->
C   ----------
C
C                      MAKPOMOE # TA 50:
C                BOTE HE-3_0 (  . MA. 3X3X0 )
C                ********************************************
C                POHAK TA #6, BEHTH PEOPA. ACTOT;
C
C              EMEHT OCBAETC:
C
C    3 T 50  KA KB KC KRA KRB KRC
C    T_BK  DTCIU #_TA_PETOPA_BOEH<EHEPATOP
C                                                PABEO
C                                                HAPEH
C
C            KXA  KXB  KXC;
C     E:
C
C              KA, KB, KC  -  TAEO 3-X AHOO HAPEH;
C              KRA, KRB, KRC -  POTOPHO OMOTK . MAH ->
C                              BXOHOE HAPEHE PEOPAOBATE
C                              ACTOT;
C              DTCIU - TEHOCT MCA "C" ->
C                      MC EHEPPTC COACHO CPABHEH
C                      HAP. OOPHOO -> BPAEMOO  MACCBA
C                      TOKN/TOKN1 EMEHTA #_._PE._BO.
C                      ( TP EPBE COBA )  HAPEH TAH
C                      PEOPAOBATE, T.E. HA AX KA, KB, KC;
C                      ( CM. DM0015 )
C                      KXA, KXB, KXC -  "OOPHO" CCTEM
C                                      HAPEH AA: "A", "B", "C";
C
C              #_.BO. - MOE OPEEEH HAPEH PABEH:
C                         ( T #40, T # 63, T # 13 );
C                         ###############################
C
C === BBOHE HAEH: I1, I2, I3, I4, I5, I6, - TOK BHE. BBOOB,
C                        IV1, IV2, ..., IV18,    - TOK BEHTE,
C                        CIU1, CIU2, ..., CIU18 - "C" HA BEHTE;
C
C              OPMAT MSW # TA 50 [ BOTE, HE ]:
C              -------------------------------------------
C               "OCTOHHA" ACT
C               ******************
C
C  +-------+--------+--------+--------+------+------+--------+----+
C  I HOMEP I HOMEP  I HOMEP  I  P. I KO I KO. I AP.   I PE I
C  I EME I TA   I /    I TA   I ECT I BB. I HA.  I E I
C  I HTA   I MOE I PACETAI (PE.) I BO   I HA I "TOKN" I PB I
C  I       I        I DM.....I       .I OBI EH.I "TOKN1"I    I
C  +-------+--------+--------+--------+------+------+--------+----+
C  I  1    I   2    I   3    I    4   I   5  I  6   I   7    I 8  I
C  +-------+--------+--------+--------+------+------+--------+----+
C
C
C              EPEMEHHA ACT MSW:
C              *********************
C
C  COBO     COBO     OOHAEH  OECKOE HAEHE
C  OT        OT
C  HAAA    EPEMEH.
C  MSW       ACT
C
C  9,10,11    -        KA, KB, KC, - HOMEPA OB A "TAH"
C  12,13,14   -        KRA< KRB, KRC - HOMEPA OB BXOHOO
C                                      HAPEH HE-3_0
C-- -- - - - - --- - - - - - - - -
C   15         1       [F] NPB - HOMEP EMEHTA, OCTABEO
C                                HAPEHE PABEH;
C  16          2       [L] ANPB - APEC B MSW_ALL NPB EMEHTA;
C  17          3       [L] AUYP - APEC B TOKN/N1 NPB EMEHTA;
C  18          4       [F] TBKL - BPEM BK. HE;
C  19          5       [F] DTCIU - T. MCA "C"
C 20, 21     6, 7           PEEPB;
C  22         8             "HX"  KE K.. OB;
C 23<->25    9<->11  [F]     HOMEPA "OOPHX" OB;
C 26<->29    12<->15          PEEPB;
C
C 30<->39    16<->25      MSWV1  -  COBO PABEH 1-M BEHTEM
C 40<->49    26<->35      MSWV2  -  COBO PABEH 2-M BEHTEM
C .....................................................................
C 200<->209   186<->195   MSWV18 -  COBO PABEH 18-M BEHTEM
C**********************************************************************
C
C   LM OA = 209 COB, LM_OK. = 195
C
C       OPMAT MSWV_EHT  DM00B9:
C       -------------------------------
C
C      COBO                   HAEHE
C
C      1       KD - KO COCTOH: =0 - AKPT, =1 - OTKPT;
C      2       HX - A OT TN, BOMOHOE BPEM EPEKEH;
C
C ( B [*] HOMEPA MSW_VEHT  / "MCIU50" )
C
C  [1] 3       TS - BPEM CTAPTA MCA( "E" KOMMTA );
C  [2] 4       TK - BPEM HA MCA( "E" KOMMTA );
C  [3] 5       CX - KO PAPEEH/APETA "C":
C                   =0 - C APEEHO OABAT HA BEHT,
C                   =1 - C PAPEEHO OABAT HA BEHT;
C [4] 6        TX - BPEM, C KOTOPOO ECTBET KO "CX";
C
C
C [5] 7        MCIU - KO MCA --->
C                     MCIU   = 00  --> "C" HET B [TN, TN+H0];
C                                       HXCIU = 0.0;
C                     MCIU   = 01  --> B [TN, TN+H0] -> EPEH POHT
C                                   MCA "C", HXCIU = HTEPBA OT
C                                      TN O EPEHEO POHTA "C";
C                     MCIU   = 10 -->  B [TN, TN+H0] -> AH POHT
C                                   MCA "C", HXCIU = HTEPBA
C                                      OT TN O AHEO POHTA MCA;
C                     MCIU   = 11 -->  B [TN, TN+H0] "C" BKEH,
C                                      COCTOHE HE MEH, HXCIU=0.0;
C
C
C [6] 8        HXCIU - A OT TN, O OEPEHOO POHTA "C";
C (---)
C     9              - PEEPB
C    10              - PEEPB
C********************************************************************
C
C
C
CZZZ-------------------------------------------------------------------
       COMMON /PROF1/ MASPRT(200)
       COMMON /PROF2/ MACTAB(800)
       DIMENSION MSW(*), RMSW(*), MSWALL(*), RMSWAL(*)
       INTEGER TIP, ADR, PTIP, AMOT, APOT, ATOKM, TIPX
       DIMENSION LTAB(10)
       DATA LTAB/ 40, 63, 13, 7*0 /
       DATA K10 / 10 /
C----------------------------------------------------------------------
       KOD = 0
C-->  HOMEP -TA C U. P
       NELMOT = MSW(15)
C-->
       NEL = MSW(1)
       TIP = MSW(2)
C-->
C-->  CKAT B MSWALL EMEHT C #-TA = NELMOT:
       CALL SEQMS0(MSWALL, NELMOT, AMOT, IRC, KVIV, ATOKM )
C-->
       IF   ( IRC .EQ. 1 ) GO TO 1
C-->  EMEHTA HET...
       KOD = 1
       NWTR = MASPRT(13)
       WRITE(NWTR, 100) NEL, TIP, NELMOT
100    FORMAT(//' *** APOC HA O. CB EMEHTA # ', I5,
     =  ' ( T # ', I3, ' ) ***'/
     =  ' *** C HE CECTBM B E EMEHTOM # ', I5,' ***'/
     =  ' *** OPAOTKA E PEKPAAETC *** '//)
       RETURN
C----------------------------------------------------------------------
1      CONTINUE
C-->  MSW - HA, TO A T TAM BET ?
       TIPX = MSWALL(AMOT + 1 )
       DO 2 I = 1, K10
       IF ( TIPX .EQ. LTAB(I) ) GO TO 3
2      CONTINUE
C-->  CB C HE HAM TOM.....
       KOD = 1
       NWTR = MASPRT(13)
       WRITE(NWTR,101) NEL, TIP, NELMOT, TIPX
101    FORMAT(//' *** APOC HA O. CB EMEHTA # ', I5,
     = ' ( T # ', I3, ' ) ***'//
     = ' *** C EMEHTOM # ', I5, ' ( T # ', I3, ' ) - OOEH',
     = '  HE PEAOBAH ***'/
     = ' *** OPAOTKA E PEKPAAETC ***'//)
       RETURN
3      CONTINUE
C-->  AMOT - AP MSW EMEHTA, C KOTOPM B CB..
       MSW(16) = AMOT
C-->    ATOKM -->  APEC BB. HA. TOO EMEHTA
       MSW(17) = ATOKM
       KOD = 0
       RETURN
       END
