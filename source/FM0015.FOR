       SUBROUTINE FM0015( BA0T, KNOTT, PAR0T, RMSW, LM )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C   OPOPAMMA: FM0015( BA0T, KNOTT, PAR0T, RMSW, LM )
C   ------------
C   HAHAEHE:        HACTPOKA MAKPOMOE # TA 92:
C  ------------  BEHTH K ( BA BEHT 1- OT "K" K "M" );
C                ************************************************
C                POHAK TA #6
C
C                   +----I<I-----+   *EPB BEHT_KATOHA PA*
C                   I            I
C  *K_E*---------+            +------*M_E*
C                   I            I
C                   +----I>I-----+   *BTOPO BEHT_AHOHA PA*
C
C
C     HAPEHE OOPHOE  1-O BEHTE -->   V(O1)
C     HAPEHE OOPHOE  2-O BEHTE -->   V(O2)
C     HAPEHE PABEH  1-O BEHT --> V(1) - V(2)
C     HAPEHE PABEH  2-O BEHT --> V(2) - V(1)
C     ( T.E. TO TO  BEHT 1, HO C OPATHM HAKOM );
C
C
C       PEAETC "PAEHOE" PABEHE BEHTM:
C                    P OACAH OHOO -> APET OA HA HEO
C                                             MCOB "C" 
C                                             PAPEEHE OA "C"
C                                             HA PO;
C                    P OACAH OOX -> PAPEEHE "C" HA TOT,
C                                            KOTOPOO HAPEHE
C                                           PABEH OOTEHOE;
C
C
C              EMEHT OCBAETC:
C
C    # T 92  K  M    O1  O2   1  2  DTCIU  EYYV  EYYI;
C
C     E:     K, M  -   OKEH,
C
C              O1, O2  -   "OOPHOO" HAPEH-> V(01),V(O2)
C
C              1, 2  -   "PABEO" HA- ->[V(1)-V(2)]
C
C              DTCIU - TEHOCT MCA "C" -> [ B . PACAX ]
C                      MC EHEPPTC COACHO CPABHEH
C                      HAP. OOPHOO -> BPAEMOO  MACCBA
C                      VALLN/VALLN1   HAPEH "PABEO" ->
C                      BPAEMOO  VALLN/VALLN1;
C
C  EYYV - OPAHEHE "CBEPX" P. CHAA;
C  EYYI - OPAHEHE "CH"  P. CHAA;
C
C
C === BBOHE HAEH: I1         - TOK  BHE. BBOOB, OT "K" K "M";
C                        I2, I3     - TOK BEHTE,
C                        I3, I4     - "C" HA BEHTX;
C
C
C   METO:       PAMETKA OE, AAHE CX_BEHT = 0( APET    );
C   -----
C   APAMETP:    BA0T, KNOTT, PAR0T - "OTPEKA" MACCBOB CX. H.
C   ---------
C                RMSW - "EPEMEHA" ACT MSW_EMEHTA,
C                LM - EE HA B COBAX;
C   OPOPAMM:   HET
C   ------------
C   PMEAHE:  1. KOHTPO HE PEAOBAH;
C  -----------      !!!  KOHTPOPETC TOKO "OAAHE" HOMEPOB
C                        BCEX OB          B AAOH OT 0 O
C                        MAKCMAHO AAHHOO ( NMKNOT )
C                   !!!                H A  E  --->  STOP 20
C                                                      -------
C              OPMAT MSW # TA 92 [ BEHTH K ]:
C              -------------------------------------------
C               "OCTOHHA" ACT
C               ******************
C
C  +-------+--------+--------+--------+------+------+--------+----+
C  I HOMEP I HOMEP  I HOMEP  I  P. I KO I KO. I AP.   I PE I
C  I EME I TA   I /    I TA   I ECT I BB. I HA.  I E I
C  I HTA   I MOE I PACETAI (PE.) I BO   I HA I "TOKN" I PB I
C  I       I        I DM.....I       .I OBI EH.I "TOKN1"I    I
C  +-------+--------+--------+--------+------+------+--------+----+
C  I  1    I   2    I   3    I    4   I   5  I  6   I   7    I 8  I
C  +-------+--------+--------+--------+------+------+--------+----+
C
C
C              EPEMEHHA ACT MSW:
C              *********************
C
C  COBO     COBO     OOHAEH  OECKOE HAEHE
C  OT        OT
C  HAAA    EPEMEH.
C  MSW       ACT
C
C  9          -        HOMEP A : 1 - BEHT --I>I--, 2 - --I<I--
C  10         -        HOMEP A : 1 - BEHT --I<I--, 2 - --I>I--
C
C-- -- - - - - --- - - - - - - - -
C  11, 12     1, 2     [F] HOMEPA OB O1, O2;
C
C  13, 14     3, 4     [F] HOMEPA OB 1, 2;
C
C  15          5       [F] DTCIU - T. MCA "C"
C
C 16<->25     6<->15      MSWV1  -  COBO PABEH 1-M BEHTEM
C      $$                 ( B 25 - XPAHTC EYYV )
C 26<->35    16<->25      MSWV2  -  COBO PABEH 2-M BEHTEM
C      $$                 ( B 35 - XPAHTC EYYI )
C**********************************************************************
C
C   LM OA = 35  COB, LM_OK. =  25
C
C       OPMAT MSWV_EHT  DM00B9:
C       -------------------------------
C
C      COBO                   HAEHE
C
C      1       KD - KO COCTOH: =0 - AKPT, =1 - OTKPT;
C      2       HX - A OT TN, BOMOHOE BPEM EPEKEH;
C
C ( B [*] HOMEPA MSW_VEHT  / "MCIU50" )
C
C  [1] 3       TS - BPEM CTAPTA MCA( "E" KOMMTA );
C  [2] 4       TK - BPEM HA MCA( "E" KOMMTA );
C  [3] 5       CX - KO PAPEEH/APETA "C":
C                   =0 - C APEEHO OABAT HA BEHT,
C                   =1 - C PAPEEHO OABAT HA BEHT;
C [4] 6        TX - BPEM, C KOTOPOO ECTBET KO "CX";
C
C
C [5] 7        MCIU - KO MCA --->
C                     MCIU   = 00  --> "C" HET B [TN, TN+H0];
C                                       HXCIU = 0.0;
C                     MCIU   = 01  --> B [TN, TN+H0] -> EPEH POHT
C                                   MCA "C", HXCIU = HTEPBA OT
C                                      TN O EPEHEO POHTA "C";
C                     MCIU   = 10 -->  B [TN, TN+H0] -> AH POHT
C                                   MCA "C", HXCIU = HTEPBA
C                                      OT TN O AHEO POHTA MCA;
C                     MCIU   = 11 -->  B [TN, TN+H0] "C" BKEH,
C                                      COCTOHE HE MEH, HXCIU=0.0;
C
C
C [6] 8        HXCIU - A OT TN, O OEPEHOO POHTA "C";
C (---)
C     9              - A KD COCTOH;
C    10              -  1-O BEHT -> EYYV,  2-O --> EYYI;
C
C********************************************************************
C
CZZZ-------------------------------------------------------------------
       COMMON /PROF1/ MASPRT(200)
       DIMENSION BA0T(*), KNOTT(*), PAR0T(*), RMSW(*)
       EQUIVALENCE( NWTR, MASPRT(13) )
       EQUIVALENCE( NWTRE, MASPRT(14) )
       EQUIVALENCE( FGMSW, MASPRT(87) )
       EQUIVALENCE( NMKNOT, MASPRT(7) )
       EQUIVALENCE( RK,  K )
       EQUIVALENCE ( NPB, RNPB   )
       EQUIVALENCE ( ID1, D1        )
       INTEGER NPB, TIP, BA0T
       DATA ID1 / 1 /
       TIP = BA0T(2)
       NEL = BA0T(1)
       IF ( TIP .EQ. 92 ) GO TO 1
C!!!-------------------------------------------------------------------
       WRITE(NWTRE, 501 ) NEL, TIP
501    FORMAT(/' *** O. CO B FM0015 --> HOMEP TA HE HA ***'/
     =  ' *** HOMEP EMEHTA ', I5, ' HOMEP TA ', I5, ' ***'/)
C!!!-------------------------------------------------------------------
       CALL SUBERR(TIP)
C######################################################################
C-->
C  PAR0T -> O1,  O2,  1,  2, DTCIU  EYYV  EYYI;
C            1     2     3    4    5        6    7
C######################################################################
1      CONTINUE
C-->  PHT  TO MOHO COPMPOBAT..
       LM = 25
C      *********
       DO 2 I=1,LM
2      RMSW(I) = 0.0
C
       DTCIU = PAR0T(5) / 1.8E+4
       RMSW(5) = DTCIU
C
C-->  PACTABT B MSW_BEHTE CX=1 - PAPEEHE     !! OKPOBAHO !!
C
C      DO 3 NV = 1,2
C      ICX = (NV-1)*10 +  6 + 4
C      RMSW(ICX) = D1
C3      CONTINUE
C----------------------------------------------------------------------
C-->  "OOPHE"   "P" 
       DO 4 I = 1, 4
       K = IFIX( PAR0T(I) )
       IF ( K .LT. 0  .OR.  K  .GT. NMKNOT ) GO TO 5
       RMSW(I) = RK
4      CONTINUE
C
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
       RMSW(15) =  PAR0T(6)
       RMSW(25) =  PAR0T(7)
C@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
       RETURN
C-
5      CONTINUE
       WRITE(NWTR,  502 ) NEL, K
       WRITE(NWTRE, 502 ) NEL, K
502    FORMAT(/' *** B  # ', I6, '  ⨬ ',
     = '㧥 # ', I5, ' ***'/
     = ' ***   ४饭   [ FM0015 ] ***'//)
       call STOPP(28)
       END
