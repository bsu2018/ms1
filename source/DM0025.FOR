         SUBROUTINE DM0025 ( MSW, RMSW, YALL, JALL, LOGYTR,
     *                       TOKN, TOKN1, VALLN, VALLN1, KOD,
     *                       MSWALL, RMSWAL, ADRMSW )
CXXX----KOMEKC "MS1" --> BEPC 1.1  (OT   MA   1987 .)------------
C   OPOPAMMA:  DM0025 ( MSW, RMSW, YALL, JALL, LOGYTR
C  -------------             TOKN, TOKN1, VALLN, VALLN1, KOD,
C                            MSWALL, RMSWAL, ADRMSW )
C
C   HAHAEHE:    B ABCMOCT OT HAEH AA ZAPROS [MASPRT(28)]:
C   -----------    BOHET CEE HK:
C
C
C                  A) ZAPROS = 1
C                  -------------
C                    CPOC AA FQ - BEH P. APAM. OPEEEH;
C                  === H EO HE PACTBAEM ==
C
C                  B) ZAPROS = 2
C                     ----------
C                      == B CAE HEBOO HAEH AA FQ -->
C                  BCEHE
C
C
C              FQ - PACET P. HAPEH BOHEH -->
C                  MEXAHM TOO AA OBOET CHXPOHPOBAT
C                  BOHEH PAHX DM_MOHTOPOB C .TA # 4;
C
C                  C) ZAPROS = 3
C                     **********
C                     HE OEPBAETC ( PEEPB );
C
C                  D) ZAPROS = 4
C                     **********
C                     HE OEPBAETC;
C
C----------------------------------------------------------------------
C
C        OPAATBAET MAKPOMOE HEHEHX HAMECKX BEHEB:
C
C   +-----+-------------------------------+------------------------+
C   I     I                               I         EPEA-        I
C   I T I       HAMEHOBAHE BEHA      I         TOHA         I
C   I     I                               I         HK        I
C   +-----+-------------------------------+------------------------+
C   I     I                               I             I Y    *   I
C   I     I                               I             I     *    I
C   I     I        HEHEHOE BEHO       I             I*  *      I
C   I 320 I  (EPEATOHA HK EO    I      ------*+------->  I
C   I     I  AAHHO HAOPOM TOEK)       I         *   I       X  I
C   I     I                               I    *  *     I          I
C   I     I                               I             I          I
C   +-----+-------------------------------+------------------------+
C   I     I                               I            !Y          I
C   I     I                               I      !--<--*----!----- I
C   I     I                               I      !     !2  !      I
C   I     I                               I      !     !    !    X I
C   I 321 I       PEEHOE BEHO          I -----*-----I----*----- I
C   I     I                               I      !X1   !    !X2    I
C   I     I                               I      !     !    !      I
C   I     I                               I------!-----*-->-!      I
C   I     I                               I            !1         I
C   +-----+-----------------------------------+--------------------+
C   I     I                               I !X         *      *    I
C   I     I                               I !    *                 I
C   I     I                               I !*                  T  I
C   I     I                               I *--------------------- I
C   I 322 I  BEHO "CTOE AABAHE"  I !                     I
C   I     I                               I !              *      *I
C   I     I                               I !TAU     *             I
C   I     I                               I !<->!*              T  I
C   I     I                               I *---*----------------- I
C   +-----+-------------------------------+------------------------+
C   I     I                               I                        I
C   I 323 I       MHOTE              I  = K * X1 * X2 *...   I
C   I     I                               I                        I
C   +-----+-------------------------------+------------------------+
C   I     I                               I                        I
C   I 325 I    KOPEH KBAPATH          I  = SQRT(X)            I
C   I     I                               I                        I
C   +-----+-------------------------------+------------------------+
C                ******************************************************
C                PHAK TIP # 4 -> O. MAKPOMOE.
C
C----------------------------------------------------------------------
C              EMEHT OCBATC:
C
C       # T 320  0   #  #CM  P
C              MAS < NT  X1  Y1  X2  Y2 ... >
C
C      E
C          # ,#CM - HOMEP EMEHTA  HOMEP TOKA EMEHTA ,
C                     COEMOO B KAECTBE BXOHOO CHAA;
C          P      -   PHAK BA APOKCMA:
C                     P = 1 - KCOHO-HEHA ;
C                     P = 2 - KBAPATHA ;
C          NT     -   KOECTBO  TOEK EPEATOHO HK
C                     AAHHO TAHO;
C          X1 Y1  -   COOTBETCTBEHHO ACCA  OPHATA TOK
C           T..     EPEATOHO HK
C
C          ------------------------------------------------------------
C
C          # T 321  0   #  #CM  X1  X2  1  2
C
C         E:
C          # ,#CM - HOMEP EMEHTA  HOMEP TOKA EMEHTA ,
C                     COEMOO B KAECTBE BXOHOO CHAA;
C          X1,X2  -   ACC TOEK EPECEEH EPEATOHO HK
C                     C OC ACC.
C          1,2  -   OPHAT TOEK EPECEEH EPEATOHO HK
C                     C OC OPHAT.
C          ------------------------------------------------------------
C
C          # T 322  0   #  #CM  TAU  HA.C.
C
C         E:
C          # ,#CM - HOMEP EMEHTA  HOMEP TOKA EMEHTA ,
C                     COEMOO B KAECTBE BXOHOO CHAA;
C          TAU    -   OCTOHHA BPEMEH AEPK;
C          HA.C. - HAEHE BXOHOO CHAA P T=[0,TAU];
C          ------------------------------------------------------------
C
C          # T 323  0   K
C              MAS < NBXOD  #1 #CM1  #2 #CM2   ... >;
C
C         E
C          K        - KOEHT POOPOHAHOCT POBEEH
C                     BXOHX TOKOB;
C          NBXOD  -   KOECTBO TOKOB EMEHTOB CXEM , KOTOPE
C                     COTC B KAECTBE BXOHX CHAOB;
C          #I,#CMI- HOMEP EMEHTA  HOMEP TOKA EMEHTA ,
C                     COEMOO B KAECTBE BXOHOO CHAA;
C          ------------------------------------------------------------
C
C          # T 325  0   #  #CM  X1  X2  1  2
C
C         E:
C          # ,#CM - HOMEP EMEHTA  HOMEP TOKA EMEHTA ,
C                     COEMOO B KAECTBE BXOHOO CHAA;
C----------------------------------------------------------------------
C
C   METO:     OPEEEHE BXOHX CHAOB HEHX HAMECKX
C   -----      BEHEB B COOTBETCTB C X EPEATOHM HKM.
C
C   APAMETP:     MSW, RMSW - PABEE COBO COCTOH MAKPOMOE
C   ---------      ( "OTPEOK" MACCB MSWALL -> C.M. / GETMSW );
C                  YALL - MATPA P0BOMOCT AHAPEMO E;
C                  JALL - BEKTOP CTOHKOB TOKA AHAPEMO E;
C                  VALLN - BEKTOP OBX HAPEH AHAPEMO E:
C                          B T = TN;
C                  VALLN1- BEKTOP OBX HAPEH AHAPEMO E:
C                          B T = TN + H0;
C                  TOKN    TOKN1  -  HAEH "TOKOB" P T :=
C                                     TN    TN + H0;
C                                   PAMEPHOCT CM. MASPRT(46)=NNTOK;
C                  LOGYTR - BEKTOP PHAKOB K.. OB:
C                  COETC B MAKPOMOEX C PHAKOM TA = 5;
C                  PAMEPHOC MACCBOB P "ALL" OPEETC:
C                   MAX_DIMENSION ---> NDALL = MASPRT(23)
C                   TEKA_PAMEPHOCT ---> NSYS = MASPRT(26)
C                  KOD - APAMETP OPATHO CB C MOHTOPOM DM....
C                   ( =1 P OO OK. OPEHOCT );
C                 MSWALL( (RMSWAL ) - BEC CCOK MSW_ALL,
C                 ADRMSW - APEC TEK. COAB MSW ( RMSW );
C
C
C   OPOPAMM:  1. COMMON PROF1, PROF2, PROF3;
C   ------------      DEPOST;
C
C   PMEAHE:  1.CTPKTP MSW COBA MAKPOMOE AHHOO TA CM. HE
C   ----------   2. P ZAPROS ^=   1  2 - COOEHE  XO;
C
C
C          "OCTOHHA" ACT MSW TOB # 320,321,322,323,325:
C           --------------------------------------------------
C
C  +-------+--------+--------+--------+------+------+-------+---+
C  I HOMEP I HOMEP  I HOMEP  I PHAKI KO I KO. IAP.   IPE I
C  I EME I TA   I /    I TA   I ECT I BB. IHA.   IE I
C  I HTA   I MOE I PACETAI MOE I BO   I HA I"TOKN" IPB I
C  I       I        I DM.....I       .I OBI EH.I"TOKN1"I   I
C  +-------+--------+--------+--------+------+------+-------+---+
C  I  1    I   2    I   3    I    4   I   5  I  6   I  7    I 8 I
C  +-------+--------+--------+--------+------+------+-------+---+
C
C                OPMAT RMSW T # 320:
C                ----------------------
C+-----------I--------------I------I-----------------------------------
C  # COBA   I    # COBA B I KTO  I
C OT HAAA  I    OTPEKE   IOPE.I
C BCEO MSW  I    RMSW B    I      I       OOHAEHE - HAEHE
C OCAH   I    FM0021    I      I
C------------I--------------I------I-----------------------------------
C     9      I     0        I      I HOMEP A ( BCEA 0 )
C----------------------------------------------------------------------
C    10      I     1        I  DM  I  FQ - A HOBE HA. BCEH
C            I              I      I   (  CHXPO. MAKPO. P.TIP # 4 )
C    11      I     2        I  DM  I  NMIN - HOMEP AE MEHE
C            I              I      I         TOK  T=TN+
C    12      I     3        I  FM  I  #  - HOMEP EMEHTA;
C    13      I     4        I  FM  I  #CM  - HOMEP TOKA EMEHTA #1;
C    14      I     5        I  LM  I  ATOKM  - AP B TOKN/N1 HAEH
C            I              I      I           TOKA HOMEP #CM
C            I              I      I           EMEHTA #;
C    15      I     6        I  FM  I  P   - PHAK BA APOKCMA
C    16      I     7        I  FM  I  NT  - KOECTBO  TOEK
C            I              I      I        EPEATOHO HK
C    17      I     8        I  FM  I  X1  - ACCA 1- TOK
C            I              I      I        EPEATOHO HK
C   ....     I    .....     I      I  .....
C    16+NT   I     7+NT     I  FM  I  X(NT) - ACCA NT-O  TOK
C            I              I      I          EPEATOHO HK
C    16+NT+1 I     7+NT+1   I  FM  I  Y1    - OPHATA 1-O TOK
C            I              I      I          EPEATOHO HK
C    ......  I    ......    I      I .......
C    16+2NT  I     7+2NT    I  FM  I  Y(NT) - OPHATA NT-O TOK
C            I              I      I          EPEATOHO HK
C----------------------------------------------------------------------
C  OA HA MSW --> LM<BC> = 16 + 2 * NT
C
C  HA EPEMEH. ACT --> LM<RMSW> = 7 + 2 * NT
C----------------------------------------------------------------------
C
C                      OPMAT RMSW T # 321
C                 ------------------------------
C+-----------I--------------I------I-----------------------------------
C  # COBA   I    # COBA B I KTO  I
C OT HAAA  I    OTPEKE   IOPE.I
C BCEO MSW  I    RMSW B    I      I       OOHAEHE - HAEHE
C OCAH   I    FM0021    I      I
C------------I--------------I------I-----------------------------------
C     9      I     0        I      I HOMEP A ( BCEA 0 )
C----------------------------------------------------------------------
C    10      I     1        I  DM  I  FQ - A HOBE HA. BCEH
C            I              I      I   (  CHXPO. MAKPO. P.TIP # 4 )
C    11      I     2        I  DM  I         PEEPB
C    12      I     3        I  FM  I  #  - HOMEP EMEHTA;
C    13      I     4        I  FM  I  #CM  - HOMEP TOKA EMEHTA #1;
C    14      I     5        I  LM  I  ATOKM  - AP B TOKN/N1 HAEH
C            I              I      I           TOKA HOMEP #CM
C            I              I      I           EMEHTA #;
C    15      I     6        I  FM  I  X1  - (CM. PC.)
C    16      I     7        I  FM  I  X2  - (CM. PC.)
C    17      I     8        I  FM  I  Y1  - (CM. PC.)
C    18      I     9        I  FM  I  Y2  - (CM. PC.)
C    19      I     10       I  DM  I  PAR - APAMETP, OPEE
C            I              I      I        COCTOHE BX. CHAA
C            I              I      I        P T=TN.
C            I              I      I        PAR=0 - IBX=1
C            I              I      I        PAR=1 - IBX=2
C----------------------------------------------------------------------
C  OA HA MSW --> LM<BC> = 19
C
C  HA EPEMEH. ACT --> LM<RMSW> = 10
C----------------------------------------------------------------------
C
C
C                      OPMAT RMSW T # 322
C                 ------------------------------
C+-----------I--------------I------I-----------------------------------
C  # COBA   I    # COBA B I KTO  I
C OT HAAA  I    OTPEKE   IOPE.I
C BCEO MSW  I    RMSW B    I      I       OOHAEHE - HAEHE
C OCAH   I    FM0021    I      I
C------------I--------------I------I-----------------------------------
C     9      I     0        I      I HOMEP A ( BCEA 0 )
C----------------------------------------------------------------------
C    10      I     1        I  DM  I  FQ - A HOBE HA. BCEH
C            I              I      I   (  CHXPO. MAKPO. P.TIP # 4 )
C    11      I     2        I  DM  I         PEEPB
C    12      I     3        I  FM  I  #  - HOMEP EMEHTA;
C    13      I     4        I  FM  I  #CM  - HOMEP TOKA EMEHTA #1;
C    14      I     5        I  LM  I  ATOKM  - AP B TOKN/N1 HAEH
C            I              I      I           TOKA HOMEP #CM
C            I              I      I           EMEHTA #;
C    15      I     6        I  FM  I  TAU - OCTOHHA BPEMEH AEPK;
C    16      I     7        I  FM  I  HA.C.- HAAHE COB;
C    17      I     8        I  FM  I  NT  - KO-BO TOEK BXOHOO CH.
C    18      I     9        I  DM  I  IPAR- KAATE;
C    19      I     10       I  DM  I  T1  - BPEM;
C    20      I     11       I  DM  I  T2  - BPEM;
C   ....     I    .....     I .... I .............................
C   18+NT    I    9+NT      I  DM  I  TNT - BPEM;
C   18+NT+1  I    9+NT+1    I  DM  I  IBX1- BXOHO CHA P T=T1
C   18+NT+2  I    9+NT+2    I  DM  I  IBX2- BXOHO CHA P T=T2
C   ....     I    .....     I .... I .............................
C   18+2*NT  I    9+2*NT    I  DM  I  IBXNT-BXOHO CHA P T=TNT
C----------------------------------------------------------------------
C  OA HA MSW --> LM<BC> = 18 + 2*NT
C
C  HA EPEMEH. ACT --> LM<RMSW> = 9 + 2*NT
C----------------------------------------------------------------------
C
C
C              OPMAT RMSW T # 323:
C              ----------------------
C+-----------I--------------I------I-----------------------------------
C  # COBA   I    # COBA B I KTO  I
C OT HAAA  I    OTPEKE   IOPE.I
C BCEO MSW  I    RMSW B    I      I       OOHAEHE - HAEHE
C OCAH   I    FM0021    I      I
C------------I--------------I------I-----------------------------------
C     9      I     0        I      I HOMEP A ( BCEA 0 )
C----------------------------------------------------------------------
C    10      I     1        I  DM  I  FQ - A HOBE HA. BCEH
C            I              I      I   (  CHXPO. MAKPO. P.TIP # 4 )
C    11      I     2        I  FM  I  NBXOD-KOECTBO TOKOB, CO-
C            I              I      I        EMX KAK BXOHE CHA;
C    12      I     3        I  FM  I  #1 - HOMEP EMEHTA;
C    13      I     4        I  FM  I  #CM1 - HOMEP TOKA EMEHTA #1;
C    14      I     5        I  LM  I  ATOKM1 - AP B TOKN/N1 HAEH
C            I              I      I           TOKA HOMEP #CM1
C            I              I      I           EMEHTA #1;
C .......    I   .......    I  ... I  ..........................
C  9+I*3     I     I*3      I  FM  I  #I -      -"-
C 10+I*3     I   1+I*3      I  FM  I  #CMI -      -"-
C 11+I*3     I   2+I*3      I  LM  I  ATOKMI -    -"-
C .......    I   .......    I  ... I  ..........................
C 12+3*NBXOD I  3+3*NBXOD   I  FM  I  K    - KOEHT POOPOHA-
C            I              I      I         HOCT;
C----------------------------------------------------------------------
C  OA HA MSW --> LM<BC> = 12 + 3*NBXOD
C
C  HA EPEMEH. ACT --> LM<RMSW> = 3 + 3*NBXOD
C----------------------------------------------------------------------
C
C
C
C                      OPMAT RMSW T # 325
C                 ------------------------------
C+-----------I--------------I------I-----------------------------------
C  # COBA   I    # COBA B I KTO  I
C OT HAAA  I    OTPEKE   IOPE.I
C BCEO MSW  I    RMSW B    I      I       OOHAEHE - HAEHE
C OCAH   I    FM0021    I      I
C------------I--------------I------I-----------------------------------
C     9      I     0        I      I HOMEP A ( BCEA 0 )
C----------------------------------------------------------------------
C    10      I     1        I  DM  I  FQ - A HOBE HA. BCEH
C            I              I      I   (  CHXPO. MAKPO. P.TIP # 4 )
C    11      I     2        I  DM  I         PEEPB
C    12      I     3        I  FM  I  #  - HOMEP EMEHTA;
C    13      I     4        I  FM  I  #CM  - HOMEP TOKA EMEHTA #1;
C    14      I     5        I  LM  I  ATOKM  - AP B TOKN/N1 HAEH
C            I              I      I           TOKA HOMEP #CM
C            I              I      I           EMEHTA #;
C    15      I     6        I      I         PEEPB
C----------------------------------------------------------------------
C  OA HA MSW --> LM<BC> = 15
C
C  HA EPEMEH. ACT --> LM<RMSW> = 6
C----------------------------------------------------------------------
C
C     B MACCBE TOKN  TOKN1 COEPTC:
C     **********************************
C     TOKN/N1(1) - HAEHE BXOHOO CHAA;
C
CZZZ-------------------------------------------------------------------
         COMMON /PROF1/ MASPRT(100)
         COMMON /PROF2/ MACTAB(800)
         COMMON /PROF3/ FUNTAB(50)
         DIMENSION MSW(*), RMSW(*), YALL(*), JALL(*), LOGYTR(*)
         DIMENSION VALLN(*), RMASPT(1), VALLN1(*), TOKN(*), TOKN1(*)
         DIMENSION MSWALL(*), RMSWAL(*)
         EQUIVALENCE ( MASPRT(1), RMASPT(1) )
         INTEGER ADRMSW
         REAL JALL, JNEL, MAXITR
         EQUIVALENCE ( ZAPROS, MASPRT(28) )
         EQUIVALENCE ( NNTOK,  MASPRT(46) )
         EQUIVALENCE ( NSYS,   MASPRT(26) )
         EQUIVALENCE ( NWTRE,  MASPRT(14) )
         EQUIVALENCE ( TN,     MASPRT(29) )
         EQUIVALENCE ( H0,     MASPRT(30) )
         EQUIVALENCE ( H1,     MASPRT(32) )
         EQUIVALENCE ( H2,     MASPRT(33) )
         EQUIVALENCE ( FITER,  MASPRT(65) )
         EQUIVALENCE ( EITER,  MASPRT(67) )
         EQUIVALENCE ( NLITER, MASPRT(79) )
         EQUIVALENCE ( MAXITR, MASPRT(80) )
         EQUIVALENCE ( NSITER, MASPRT(88) )
         EQUIVALENCE ( ZEROCP, MASPRT(50) )
         INTEGER FITER, TIP, ZAPROS, P
       KOD = 0
C**********************************************************************
       TIP = MSW(2)
       NTIP = TIP - 319
       IF ( NTIP .GE. 1 .AND. NTIP .LE. 4 ) GO TO 9991
       IF ( NTIP .EQ. 6                   ) GO TO 9991
C######################################################################
9999     CONTINUE
         NWTRE = MASPRT(14)
         WRITE(NWTRE,9998) MSW(1), MSW(2)
9998     FORMAT( ' *** O. CO B DM0025 - APOC HA OCBAHE O
     =O TA ***'/
     =    ' *** EMEHT # ', I10, ' T MOE # ', I10, ' ***'//)
         CALL SUBERR(0)
C######################################################################
9991   CONTINUE
C--->  BOP PEMA APOCA..
6666   GO TO( 100, 200), ZAPROS
C----------------------------------------------------------------------
C===> HAE OKA
         NWTRE = MASPRT(14)
         WRITE(NWTRE,9997) MSW(3), ZAPROS
9997     FORMAT( ' *** DM MOHTOP #', I4, ' APOC OCBAH OOEH
     = ***'/ ' *** ZAPROS = ', I5, ' - HOPPETC ***')
         RETURN
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C---- ZAPROS = 1 ------------------------------------------------------
100    CONTINUE
C==> CPOC AA       OCHOBHO PACET BOHEH;
       MSW(10) = 0
       RETURN
C$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
C-----ZAPROS = 2 ------------------------------------------------------
200    CONTINUE
C-->  HHO  PAOTAT ?
       IF ( MSW(10) .EQ. 1 ) RETURN
C----------------------------------------------------------------------
C-->  PETC .............................
C-->  ZAPROS = 2 --> PACTAT HAEH....
C######################################################################
       ITOK = MSW(7)
       GO TO (1000,2000,3000,4000,6000,6000),NTIP
1000   CONTINUE
C----------------------------------------------------------------------
C-->   HEHEHOE BEHO ( T 320 )
C----------------------------------------------------------------------
       NMIN = MSW(11)
       P    = MSW(15)
       NT   = MSW(16)
       NTM1 = NT - 1
       SIGNAL = 0.
C----------------------------------------------------------------------
C--> HEEM BXOHO CHA
       SIGBX = TOKN1( MSW(14) )
       IF( SIGBX .LT. RMSW(17) ) GO TO 1800
       IF( SIGBX .GT. RMSW(16+NT) ) GO TO 1700
C--> CPABHM C PEM.
       IF( SIGBX .LE. RMSW(16+NMIN) ) GO TO 1200
C--> CHA BEC.
1100   CONTINUE
       IF( SIGBX .LE. RMSW(17+NMIN) ) GO TO 1500
       NMIN = NMIN + 1
       GO TO 1100
1200   CONTINUE
C--> CHA MEHC
       NMIN = NMIN - 1
       IF( SIGBX .GE. RMSW(16+NMIN) ) GO TO 1500
       GO TO 1200
C--> OA B CEPEH TA. HTEPOPEM...
1500   CONTINUE
       X1 = RMSW(16+NMIN)
       X2 = RMSW(17+NMIN)
       Y1 = RMSW(16+NT+NMIN)
       Y2 = RMSW(17+NT+NMIN)
       IF( P .EQ. 2 ) GO TO 1600
1550   CONTINUE
C--> HEHA HTEPO.
       SIGNAL = ( (Y1-Y2)*SIGBX + Y2*X1 - Y1*X2 ) / ( X1 - X2 )
       MSW(11) = NMIN
       GO TO 9900
1600   CONTINUE
C--> KBAPATHA HTEPO.
       N3 = NMIN - 1
       IF ( N3 .EQ. 0 ) N3 = NMIN + 2
       X3 = RMSW(16+N3)
       Y3 = RMSW(16+NT+N3)
       A = ( (Y3-Y1)/(X3-X1) - (Y2-Y1)/(X2-X1) ) / (X3-X2)
       B = (Y2-Y1)/(X2-X1) - A * (X2+X1)
       C = Y1 - A * X1**2 - B * X1
       SIGNAL = A * SIGBX**2 + B * SIGBX + C
       MSW(11) = NMIN
       GO TO 9900
1700   CONTINUE
C--> B A BEPXH PAH...
       X1 = RMSW(15+NT)
       X2 = RMSW(16+NT)
       Y1 = RMSW(15+2*NT)
       Y2 = RMSW(16+2*NT)
       NMIN = NT
       GO TO 1550
1800   CONTINUE
C--> B A HH PAH...
       X1 = RMSW(17)
       X2 = RMSW(18)
       Y1 = RMSW(17+NT)
       Y2 = RMSW(18+NT)
       NMIN = 1
       GO TO 1550
C######################################################################
2000   CONTINUE
C----------------------------------------------------------------------
C-->   PEEHOE BEHO ( T 321 )
C----------------------------------------------------------------------
       NPAR = MSW(19)
       X1  = RMSW(15)
       X2  = RMSW(16)
       Y1  = RMSW(17)
       Y2  = RMSW(18)
C----------------------------------------------------------------------
C--> HEEM BXOHO CHA
       SIGBX = TOKN1( MSW(14) )
       IF( SIGBX .LT. X1 ) GO TO 2500
       IF( SIGBX .GT. X2 ) GO TO 2600
C--> TO O HA PEEM AE?
       IF( NPAR .EQ. 1 )   GO TO 2600
C--> CHA PABEH  Y1 .
2500   CONTINUE
       SIGNAL = Y1
       MSW(19) = 0
       GO TO 9900
C--> CHA PABEH  Y2
2600   CONTINUE
       SIGNAL = Y2
       MSW(19) = 1
C======================================================================
9900   CONTINUE
C----------------------------------------------------------------------
C--> AEM B TOKN1
       TOKN1(ITOK) = SIGNAL
C----------------------------------------------------------------------
C-->  AKCP. KOHE BCEH       ( FQ A )
       MSW(10) = 1
       RETURN
C######################################################################
3000   CONTINUE
C----------------------------------------------------------------------
C-->  BEHO TA "CTOE AABAHE"
C----------------------------------------------------------------------
       TN1 = TN + H0
       TAU = RMSW(15)
       HU  = RMSW(16)
       NT  =  MSW(17)
       IPAR=  MSW(18)
C----------------------------------------------------------------------
C--> HAEM BXOHO CHA.
       SIGBX = TOKN (MSW(14))
       SIGBX1= TOKN1(MSW(14))
       IF( FITER .EQ. 1 ) GO TO 3010
C----------------------------------------------------------------------
C--> AOMHM PE BXOHO TOK
       RMSW(IPAR) = TN
       RMSW(IPAR+NT) = SIGBX
3010   CONTINUE
C----------------------------------------------------------------------
C--> TO CO BPEMEHEM?
       IF( TN1 .GE. TAU ) GO TO 3020
C--> TEKEE BPEM MEHE BPEMEH AEPK.
       TOKN1(ITOK) = HU
C----------------------------------------------------------------------
C-->  AKCP. KOHE BCEH       ( FQ A )
       MSW(10) = 1
       IF( FITER .EQ. 1 ) RETURN
       IF( (IPAR-18) .EQ. NT ) IPAR = 18
       MSW(18) = IPAR + 1
       RETURN
C======================================================================
3020   CONTINUE
C----------------------------------------------------------------------
C--> TEKEE BPEM OE BPEMEH AEPK.
       IF( TAU .GT. H0 ) GO TO 3030
C--> AEPKA MEHE AA.
       X1 = TN
       X2 = TN1
       Y1 = SIGBX
       Y2 = SIGBX1
       XN = TN1 - TAU
       GO TO 3100
3030   CONTINUE
C----------------------------------------------------------------------
C--> AEPKA OE AA.
C--> EM BXOHO CHA.
       XN = TN1 - TAU
       ISIG = IPAR
       NT1 = 0
3040   CONTINUE
       NT1 = NT1 + 1
       IF( NT1 .GT. NT ) GO TO 3200
       ISIG = ISIG - 1
       IF( ISIG .EQ. 18 ) ISIG = 18 + NT
       ISIG1= ISIG - 1
       IF( ISIG1.EQ. 18 ) ISIG1= 18 + NT
       IF( XN .GT. RMSW(ISIG) .OR. XN .LT. RMSW(ISIG1) ) GO TO 3040
       X1 = RMSW(ISIG1)
       X2 = RMSW(ISIG)
       Y1 = RMSW(ISIG1+NT)
       Y2 = RMSW(ISIG+NT)
C----------------------------------------------------------------------
C--> HEHA HTEPO BXOHOO CHAA.
3100   CONTINUE
       TOKN1(ITOK) = ( (Y1-Y2)*XN + Y2*X1 - Y1*X2 ) / (X1 - X2)
C----------------------------------------------------------------------
C-->  AKCP. KOHE BCEH       ( FQ A )
       MSW(10) = 1
       IF( FITER .EQ. 1 ) RETURN
       IF( (IPAR-18) .EQ. NT ) IPAR = 18
       MSW(18) = IPAR + 1
       RETURN
C======================================================================
3200   CONTINUE
         NWTRE = MASPRT(14)
         WRITE(NWTRE,501) MSW(1), MSW(2)
501     FORMAT(' *** KOECTBO AOMHAEMX TOEK HE OCTATOHO ***'/
     =         ' ***  OEH AAHHO AEPK O BPEMEH  ***'/
     =         ' *** EMEHT # ',I5,' T MOE # ',I5, ' ***'//)
         CALL SUBERR(0)
        RETURN
C######################################################################
4000    CONTINUE
C----------------------------------------------------------------------
C-->  MHOTE
C----------------------------------------------------------------------
        NBXOD = MSW(11)
        AK = RMSW(12+3*NBXOD)
C-->  HAXOM BXOHO CHA, EPEMHOB BXOHE.
        SIGNAL = AK
           DO 4100 I=1,NBXOD
           SIGNAL = SIGNAL * TOKN1(MSW(11+3*I))
4100       CONTINUE
C----------------------------------------------------------------------
C--> AEM B TOKN1
       TOKN1(ITOK) = SIGNAL
C----------------------------------------------------------------------
C-->  AKCP. KOHE BCEH       ( FQ A )
       MSW(10) = 1
       RETURN
C######################################################################
6000   CONTINUE
C----------------------------------------------------------------------
C-->   KOPEH KBAPATH (T 325 )
C----------------------------------------------------------------------
C--> HEEM BXOHO CHA
       SIGBX = TOKN1( MSW(14) )
       SIGNAL = 0.0
       IF( SIGBX .GT. 0.0 ) SIGNAL = SQRT(SIGBX)
C----------------------------------------------------------------------
C--> AEM B TOKN1
       TOKN1(ITOK) = SIGNAL
C----------------------------------------------------------------------
C-->  AKCP. KOHE BCEH       ( FQ A )
       MSW(10) = 1
       RETURN
       END
