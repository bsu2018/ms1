       SUBROUTINE ADEC01( KD, REG, FLAG, ADPRTO,ADPRTI, ADPROG, IPORT,
     *                    IPORT1,T,IER )
CXXX----KOMEKC "MS1" --> BEPC 1.1  (OT    MA    1988 .)-----------
C   OPOPAMMA: ADEC01( KD, REG, FLAG, ADPRTO,ADPRTI, ADPROG, IPORT,
C   -------------         IPORT1,T,IER )
C
C   HAHAEHE:  OPAOTK BXAPECHX KOMAH
C   ----------   MKPOPOECCOPA  K1801BM1(2,3)
C              *------------------------------------------------------*
C              * KOMAHA  "MOV"( 01SSDD Q ):                          *
C              * OEPAH CTOHK   <SS> EPECAETC O APEC       *
C              * OEPAHA PEMHKA <DD> .                            *
C              *------------------------------------------------------*
C              * KOMAHA  "CMP"( 02SSDD Q ):                          *
C              * CPABHBAETC OEPAH CTOHKA <SS>  OEPAH  P-  *
C              * EMHKA <DD>  MEHTC PHAK. OA OEPAHA HE   *
C              * MEHTC.                                          *
C              *------------------------------------------------------*
C              * KOMAHA  "BIT"( 03SSDD Q ):                          *
C              * BOHET OECK HK  "" HA OEPAHOM      *
C              * CTOHKA <SS>  OEPAHOM  PEMHKA <DD>, MEH  *
C              * COOTBETCTBM OPAOM PHAK. OA OEPAHA HE    *
C              * MEHTC.                                          *
C              *------------------------------------------------------*
C              * KOMAHA  "BIC"( 04SSDD Q ):                          *
C              * OAET KA PAP OEPAHA PEMHKA  <DD>,      *
C              * COOTBETCTB CTAHOBEHHOM PAP OEPAHA      *
C              * CTOHKA <SS>. COEPMOE  <SS>  HE MEHETC.     *
C              *------------------------------------------------------*
C              * KOMAHA  "BIS"( 05SSDD Q ):                          *
C              * BOHET OECK OEPA "" HA COEPMM   *
C              * OEPAHA CTOHKA <SS>  OEPAHA PEMHKA <DD>   *
C              * ACBAET PETAT O APECC  <DD>.               *
C              * COEPMOE  <SS>  HE MEHETC.                     *
C              *------------------------------------------------------*
C              * KOMAHA  "ADD"( 06SSDD Q ):                          *
C              * OEPAH CTOHKA  <SS>  CKABAETC C OEPAHOM    *
C              * PEMHKA <DD>  PETAT ACBAETC O APEC    *
C              * OEPAHA PEMHKA <DD> . COEHE BOHETC B     *
C              * BOHOM OOHTEHOM KOE.                        *
C              *------------------------------------------------------*
C              * KOMAHA  "SUB"( 16SSDD Q ):                          *
C              *  OEPAHA PEMHKA  <DD> BTAETC OEPAH       *
C              * CTOHKA <SS>  PETAT ACBAETC O APEC    *
C              * OEPAHA PEMHKA <DD> . BTAHE BOHETC B    *
C              * BOHOM OOHTEHOM KOE.                        *
C              *------------------------------------------------------*
C
C   METO:      OECKOE MOEPOBAHE.
C   -----
C
C   APAMETP:  BXOHE :
C  ----------      KD     - KO KOMAH  ;
C                  REG(8) - MACCB PECTPOB MKPOPOECCOPA ;
C                           REG(1) --> R0
C                           REG(2) --> R1
C                           REG(3) --> R2
C                           REG(4) --> R3
C                           REG(5) --> R4
C                           REG(6) --> R5
C                           REG(7) --> R6 ( KAATE CTEKA )
C                           REG(8) --> R7 ( CETK KOMAH  )
C                  FLAG(6)- MACCB AOB CC MKPOPOECCOPA ;
C                           FLAG(1) --> A  C (EPEHOC)
C                           FLAG(2) --> A  V (APM. EPEOHEHE)
C                           FLAG(3) --> A  Z (HEBO PETAT)
C                           FLAG(4) --> A  N (OTPAT.PETAT)
C                           FLAG(5) --> A  T
C                           FLAG(6) --> A I/O(POPTET)
C                  ADPRTO - APEC OPTA BBOA ;
C                  ADPRTI - APEC OPTA BBOA ;
C                  ADPROG - MAKCMAH APEC O ,B PEEAX KOTOPOO
C                           PAOTAET PABA POPAMMA ;
C                  IPORT  - COEPMOE OPTA BBOA ;
C                  IPORT1 - COEPMOE OPTA BBOA ;
C
C
C               BXOHE :
C                  T      - BPEM BOHEH KOMAH ;
C                  IER    - KAATE OK:
C                           IER=0  -  OOK HE OHAPEHO ;
C                           IER=1  -  OOHA AC KOMAH O
C                                     BXO A PEE O ;
C                           IER=2  -  POOO OPAEHE K EKE
C                                     AMT, MEE HEETH APEC.
C                           IER=3  -  HE HAA KOMAHA ;
C                           IER=4  -  OPAEHE K OPT B/B
C                                     HE O TOM APEC ;
C                           IER=5  -  KOMAHA OKA HE PEAOBAHA ;
C
C
C   OPOPAMM:  1. ADECIS, ADECDB, ADECBD ;
C   ------------
C
C   PMEAHE:    1. HET.
C   -----------
C
CZZZ-------------------------------------------------------------------
       COMMON /MEMER/ MEM(2048), MEM1(2048)
       INTEGER  REG(8), FLAG(6),  ADPROG, KB(16), KB1(16)
       INTEGER  ADPRTO, ADPRTI
       IER = 0
       KOM = KD / 4096
C----------------------------------------------------------------------
C--> EM OEPAH CTOHK ( APEC--> IADRS,  CO--> IDATA )
       KD1 = ( KD - KOM*4096 ) / 64
       CALL ADECIS( KD1, ADPROG, REG, IADRS, IDATA, TI, IER )
       IF( IER   .NE. 0 ) RETURN
       IF( IADRS .GE.-8 ) GO TO 10
C--> APOC HA BBO AHHX  OPTA BBOA
CCCC   WRITE (6,*) ADPRTI,ADPRTO
       IF( (-IADRS) .NE. ADPRTI ) GO TO 9904
       IDATA = IPORT1
10     CONTINUE
C----------------------------------------------------------------------
C--> EM OEPAH PEMHK ( APEC--> IADRS1,  CO--> IOLD  )
       KD1 = KD - KOM*4096 - KD1*64
       CALL ADECIS( KD1, ADPROG, REG, IADRS1, IOLD, TO, IER )
       IF( IER   .NE. 0 ) RETURN
       IF( IADRS1.GE.-8 ) GO TO 20
C--> APOC HA BBO AHHX B OPT  BBOA
       IF( (-IADRS1) .NE. ADPRTO ) GO TO 9904
       IOLD = IPORT
20     CONTINUE
C----------------------------------------------------------------------
C--> PAOEMC O KOMAHAM :
       GO TO ( 100,  200,  300,  400,  500,  600, 9903, 9903, 9903,
     *        9903, 9903, 9903, 9903, 700, 9903 ), KOM
       GO TO 9903
C----------------------------------------------------------------------
C              KOMAHA  "MOV"
C----------------------------------------------------------------------
100    CONTINUE
       IF( IADRS1 .LT. 0 ) GO TO 110
       MEM(IADRS1+1) = IDATA
       MEM(IADRS1+2) = IDATA/256
       GO TO 120
110    CONTINUE
       IF( IADRS1 .LT.-8 ) GO TO 115
       REG(-IADRS1) = IDATA
       GO TO 120
115    CONTINUE
       IPORT = IDATA
120    CONTINUE
C--> OCTAEM BPEM
       TB = 2.8E-6
       IF( TI .EQ. 0 .AND. TO .EQ. 0 ) TB = 4.0E-6
       T = TB + TI + TO
C--> AMEMC PHAKAM.
       FLAG(2) = 0
       FLAG(3) = 0
       IF( IDATA .EQ. 0 ) FLAG(3) = 1
       FLAG(4) = 0
       IF( IDATA .GE. 32768 ) FLAG(4) = 1
       RETURN
C######################################################################
C----------------------------------------------------------------------
C              KOMAHA  "CMP"
C----------------------------------------------------------------------
200    CONTINUE
         INEW = IDATA  - IOLD
C--> OCTAEM BPEM
       TB = 3.6E-6
       IF( TI .EQ. 0 .AND. TO .EQ. 0 ) TB = 4.0E-6
       T = TB + TI + TO
C--> AMEMC PHAKAM.
       FLAG(1) = 0
       IF( INEW .GE. 0 ) GO TO 205
       FLAG(1) = 1
       INEW = 65536 + INEW
 205   CONTINUE
       FLAG(2) = 0
       IF( IDATA.GE.32768.AND.IOLD.LT.
     *32768.AND.INEW.LT.32768)    FLAG(2)=1
       IF( IDATA.LT.32768.AND.IOLD.GE.
     *32768.AND.INEW.GE.32768)    FLAG(2)=1
       FLAG(3) = 0
       IF(INEW.EQ.0)  FLAG(3) = 1
       FLAG(4) = 0
       IF(INEW.GE.32768)      FLAG(4)=1
       RETURN
C######################################################################
C----------------------------------------------------------------------
C              KOMAHA  "BIT"
C----------------------------------------------------------------------
300    CONTINUE
C--> PAOEM OEPAH CTOHK O CTEEHM BOK
       CALL ADECDB( IDATA, KB, IER )
       IF( IER .NE. 0 ) RETURN
C--> PAOEM OEPAH PEMHK O CTEEHM BOK
       CALL ADECDB( IOLD, KB1, IER )
       IF( IER .NE. 0 ) RETURN
C----------------------------------------------------------------------
       ISUM = 0
       DO 310 I=1,16
       KB(I) = KB(I) * KB1(I)
       ISUM  = KB(I) + ISUM
310    CONTINUE
C--> OCTAEM BPEM
       TB = 3.6E-6
       IF( TI .EQ. 0 .AND. TO .EQ. 0 ) TB = 4.0E-6
       T = TB + TI + TO
C--> AMEMC PHAKAM.
       FLAG(2) = 0
       FLAG(3) = 0
       IF( ISUM .EQ. 0 ) FLAG(3) = 1
       FLAG(4) = KB(16)
       RETURN
C######################################################################
C______________________________________________________________________
C                    KOMAHA "BIC"
C______________________________________________________________________
400    CONTINUE
C-->  PAOEM OEPAH CTOHK O CTEEHM BOK
       CALL  ADECDB(IDATA,KB,IER)
       IF(IER.NE.0)  RETURN
C-->  PAOEM OEPAH PEMHK O CTEEHM BOK
       CALL ADECDB(IOLD,KB1,IER)
       IF( IER. NE. 0 )  RETURN
C----------------------------------------------------------------------
       ISUM = 0
       DO 410  I=1,16
       IF( KB(I) .EQ. 1 ) KB1(I) = 0
       ISUM = ISUM + KB1(I)
410    CONTINUE
C-->   PEOPAEM PETAT B ECTHOM BE
       CALL ADECBD(IDATA,KB1,IER)
C-->  ACBAEM PETAT
       IF(IADRS1 .LT. 0 ) GO TO 420
       MEM(IADRS1 + 1) = IDATA
       MEM( IADRS1 + 2) = IDATA/256
       GO TO 440
420    CONTINUE
       IF(IADRS1. LT. -8 ) GO TO 430
       REG(-IADRS1) = IDATA
       GO TO 440
430    CONTINUE
       IPORT = IDATA
440    CONTINUE
C-->    OCTAEM  BPEM
       TB = 4.8E-6
       IF(TI .EQ . 0. AND. TO. EQ. 0 )  TB = 4.0E-6
       T = TB + TI + TO
C-->   AMEMC PHAKAM
       FLAG(2) = 0
       FLAG(3) = 0
       IF(ISUM. EQ. 0)  FLAG(3) = 1
       FLAG(4) = KB1(16)
       RETURN
C######################################################################
C______________________________________________________________________
C                    KOMAHA "BIS"
C______________________________________________________________________
500    CONTINUE
C-->  PAOEM OEPAH CTOHK O CTEEHM BOK
       CALL  ADECDB(IDATA,KB,IER)
       IF(IER.NE.0)  RETURN
C-->  PAOEM OEPAH PEMHK O CTEEHM BOK
       CALL ADECDB(IOLD,KB1,IER)
       IF( IER. NE. 0 )  RETURN
C----------------------------------------------------------------------
       ISUM = 0
       DO 510  I=1,16
       IF( KB(I). EQ. 1 ) KB1(I) = 1
       ISUM = ISUM + KB1(I)
510    CONTINUE
C-->   PEOPAEM PETAT B ECTHOM BE
       CALL ADECBD(IDATA,KB1,IER)
C-->  ACBAEM PETAT
       IF(IADRS1 .LT. 0 ) GO TO 520
       MEM(IADRS1 + 1) = IDATA
       MEM( IADRS1 + 2) = IDATA/256
       GO TO 540
520    CONTINUE
       IF(IADRS1. LT. -8 ) GO TO 530
       REG(-IADRS1) = IDATA
       GO TO 540
530    CONTINUE
       IPORT = IDATA
540    CONTINUE
C-->    OCTAEM  BPEM
       TB = 4.8E-6
       IF(TI .EQ . 0. AND. TO. EQ. 0 )  TB = 4.0E-6
       T = TB + TI + TO
C-->   AMEMC PHAKAM
       FLAG(2) = 0
       FLAG(3) = 0
       IF(ISUM. EQ. 0)  FLAG(3) = 1
       FLAG(4) = KB1(16)
       RETURN
C######################################################################
C______________________________________________________________________
C                    KOMAHA "ADD"
C______________________________________________________________________
600    CONTINUE
       INEW = IDATA + IOLD
       INEW1 = INEW
       IF( INEW1 .GT. 65535 ) INEW1 = INEW1 - 65536
C--->  AKOHAC OEPA  COEHE
C-->    ACBAEM PETAT...
       IF(IADRS1. LT. 0)  GO TO 610
       MEM(IADRS1 + 1) = INEW1
       MEM(IADRS1 + 2) = INEW1/ 256
       GO TO 620
610    CONTINUE
       IF(IADRS1. LT. -8)  GOTO 615
       REG(-IADRS1) = INEW1
       GO TO 620
615    CONTINUE
       IPORT = INEW1
620    CONTINUE
C --> OCTAEM BPEM
       TB = 4.8E-6
       IF(TI. EQ. 0.AND.TO. EQ. 0) TB = 4.0E-6
       T = TB + TO + TI
C -->   AMEMC PHAKAM
       FLAG(1) = 0
       IF(INEW. GT. 65535)   FLAG(1) = 1
       FLAG(2) = 0
       IF(IDATA.GE.32768.AND.IOLD.GE.32768.AND.
     *INEW1. LT. 32768 ) FLAG(2) = 1
       IF(IDATA. LT. 32768. AND. IOLD. LT.32768. AND.
     *INEW1. GE. 32768 )   FLAG(2) = 1
       FLAG(3) = 0
       IF(INEW1. EQ. 0)    FLAG(3) = 1
       FLAG(4) = 0
       IF(INEW1. GE. 32768 )   FLAG(4) = 1
       RETURN
C######################################################################
C______________________________________________________________________
C                    KOMAHA "SUB"
C______________________________________________________________________
700    CONTINUE
       INEW =  IOLD - IDATA
       INEW1 = INEW
       IF(INEW. LT. 0)   INEW1 = INEW +65536
C--->  AKOHAC OEPA  BTAHE.
C-->    ACBAEM PETAT...
       IF(IADRS1. LT. 0)  GO TO 710
       MEM(IADRS1 + 1) = INEW1
       MEM(IADRS1 + 2) = INEW1/ 256
       GO TO 720
710    CONTINUE
       IF(IADRS1. LT. -8)  GOTO 715
       REG(-IADRS1) = INEW1
       GO TO 720
715    CONTINUE
       IPORT = INEW1
720    CONTINUE
C --> OCTAEM BPEM
       TB = 4.8E-6
       IF(TI. EQ. 0.AND.TO. EQ. 0) TB = 4.0E-6
       T = TB + TO + TI
C -->   AMEMC PHAKAM
       FLAG(1) = 0
       IF(INEW. LT. 0)   FLAG(1) = 1
       FLAG(2) = 0
       IF(IDATA.GE.32768.AND.IOLD.LT.32768.AND.
     *INEW1. GE. 32768 ) FLAG(2) = 1
       IF(IDATA. LT. 32768. AND. IOLD. GE.32768. AND.
     *INEW1. LT. 32768 )   FLAG(2) = 1
       FLAG(3) = 0
       IF(INEW1. EQ. 0)    FLAG(3) = 1
       FLAG(4) = 0
       IF(INEW1. GE. 32768 )   FLAG(4) = 1
       RETURN
C----------------------------------------------------------------------
9903   CONTINUE
       IER = 3
       RETURN
C----------------------------------------------------------------------
9904   CONTINUE
       IER = 4
       RETURN
C----------------------------------------------------------------------
       END
