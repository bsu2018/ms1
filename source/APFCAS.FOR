         SUBROUTINE APFCAS ( FUN, KCAR, LCAR, BCAR )
CXXX ---KOMEKC "MS1" --> BEPC 1.5  (OT     1989 .)-------------
C      OPOPAMMA APFCAS ( FUN, KCAR, LCAR, BCAR )
C      ------------
C      HAHAEHE: EPEKOPOBKA "BHEHEO" A-PECTABEH
C      ----------  CMBOHO CTPOK BBEEHHO B CPE OPTPAH-A
C                  OPMATOM A1, BO "BHEHEE" A-PECTABEHE
C                   OPATHO;
C                  EPEKOPOBK AKAETC B AMEHE CMBOOB
C                  CTPOK: <POCHE KB> <==> <cpoe y>
C      METO:  OCK COOTBETCTB B TAE CMBOOB;
C      -----
C      APAMETP: FUN - =1  LCAR  B  BCAR,
C      ---------        =2  BCAR  B  LCAR;
C                 KCAR - KOECTBO CMBOOB B MACCBAX,
C                          PAMEPHOCT ACAR  FCAR;
C                 LCAR - MACCB "BHEHEO" PECTABEH,
C                        COEPA "MAEHKE" KB
C
C                 BCAR - MACCB "BHEHEO" PECTABEH,
C                        COEPA "OE" KB
C
C                 BCE APAMETP INTEGER*4;
C
C      OPOPAMM: HET   ( SUBERR ), COMMON: PRINTP
C      ------------
C      PMEAHE: 1. TAA CMBOOB OPOEHA !!!;
C      ----------- 2. P KOPEKTPOBKE --->  CM. APFTRT
CZZZ--------------------------------------------------------------------
C!!!-------------------------------------------------------------------
        COMMON/PRINTN/ NW6
C!!!------------------------------------------------------------------
        DIMENSION LCAR(1),BCAR(1),LTAB(98),BTAB(98)
        INTEGER BCAR, LCAR, LTAB, FUN, XXX, BTAB
        DATA NTAB/98/, XXX/'?'/
        DATA BTAB /
     *  '0',  '1',  '2',  '3',  '4',  '5',  '6',  '7',  '8',  '9',
     1  ' ',  '+',  '-',  '*',  '/',  '(',  ')',  '=',  ';',  '[',
     2  ']',  '>',  '<',  '^',  ':',  ',',  '.',  '''', '"',  '%',
     3  '&',  '!',  '?',  '_',  '#',  '@',  '$',  'A',  'B',  'C',
     4  'D',  'E',  'F',  'G',  'H',  'I',  'J',  'K',  'L',  'M',
     5  'N',  'O',  'P',  'Q',  'R',  'S',  'T',  'U',  'V',  'W',
     6  'X',  'Y',  'Z',  '',  '',  '',  '',  '',  '',  '',
     7  '',  '',  '',  '',  '',  '',  '',  '',  '',  '',
     8  '',  '',  '',  'T',  'M',  'B',  'A',  'H',  'E',  'K',
     9  'X',  'B',  'A',  'P',  'O',  'C',  'M',  'T'               /
C!!!!!!!!!!!!!  RUS CBM B TEXT CPABT  HA !!!!!!!!!!!!!!!!!!
        DATA LTAB /
     *  '0',  '1',  '2',  '3',  '4',  '5',  '6',  '7',  '8',  '9',
     1  ' ',  '+',  '-',  '*',  '/',  '(',  ')',  '=',  ';',  '[',
     2  ']',  '>',  '<',  '^',  ':',  ',',  '.',  '''', '"',  '%',
     3  '&',  '!',  '?',  '_',  '#',  '@',  '$',  'a',  'b',  'c',
     4  'd',  'e',  'f',  'g',  'h',  'i',  'j',  'k',  'l',  'm',
     5  'n',  'o',  'p',  'q',  'r',  's',  't',  'u',  'v',  'w',
     6  'x',  'y',  'z',  '',  '',  '',  '',  '',  '',  '',
     7  '',  '',  '',  '',  '',  '',  '',  '',  '',  '',
     8  '',  '',  '',  '',  '',  '',  '',  '',  '',  '',
     9  '',  '',  '',  '',  '',  '',  '',  ''               /
C----------------------------------------------------------------------
         GO TO (1,2), FUN
C!!!-------------------------------------------------------------------
           WRITE(NW6,10) FUN
10         FORMAT(' ***** CO P OPAEH K APFCAS, FUN=',I10)
           CALL SUBERR(1)
C!!!-------------------------------------------------------------------
C         LCAR    B   BCAR
1         CONTINUE
          DO 50  I=1,KCAR
          DO 51 J=1, NTAB
          JF=J
          IF ( LCAR(I) .EQ. LTAB(J) )  GO TO 53
51        CONTINUE
          BCAR(I)=LCAR(I)
          GO TO 50
53        BCAR(I)=BTAB(JF)
50        CONTINUE
          RETURN
C       BCAR  B  LCAR
2         CONTINUE
          DO 250  I=1,KCAR
          DO 251 J=1, NTAB
          JF=J
          IF ( BCAR(I) .EQ. BTAB(J) )  GO TO 253
251        CONTINUE
          LCAR(I)=BCAR(I)
          GO TO 250
253        LCAR(I)=LTAB(JF)
250        CONTINUE
          RETURN
          END
