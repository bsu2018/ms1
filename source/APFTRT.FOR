         SUBROUTINE APFTRT ( FUN, KCAR, ACAR, FCAR )
CXXX ---KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)-------------
C      OPOPAMMA APFTRT ( FUN, KCAR, ACAR, FCAR )
C      ------------
C      HAHAEHE: EPEKOPOBKA  "BHEHEO" A-PECTABEH
C      ----------  CMBOHO CTPOK BBEEHHO B CPE OPTPAH-A
C                  OPMATOM A1, BO "BHTPEHHEE" F-PECTABEHE
C                  ( INTEGER*4 )  OPATHO;
C                  EPEKOPOBK  A-KOD B F-KOD  OPATHO.
C
C      METO:  OCK COOTBETCTB B TAE CMBOOB;
C      -----
C      APAMETP: FUN - =1  ACAR  B  FCAR,
C      ---------        =2  FCAR  B  ACAR;
C                 KCAR - KOECTBO CMBOOB B MACCBAX,
C                          PAMEPHOCT ACAR  FCAR;
C                 ACAR - MACCB "BHEHEO" PECTABEH: A-KOD;
C
C                 FCAR - MACCB "BHTPEHHEO" PECTABEH: F-KOD;
C
C                 BCE APAMETP INTEGER*4;
C
C      OPOPAMM: HET   ( SUBERR ), COMMON: PRINTP
C      ------------
C      PMEAHE: 1. TAA CMBOOB OPOEHA !!!;
C      ----------  2. P HEBOMOHOCT PEOPAOBAH:
C                     B ACAR <- CMBO ?,
C                     B FCAR <- CO 0;
C
CZZZ--------------------------------------------------------------------
C!!!-------------------------------------------------------------------
        COMMON/PRINTN/ NW6
C!!!-------------------------------------------------------------------
        DIMENSION ACAR(1),FCAR(1),TAB(83)
        INTEGER ACAR, FCAR, TAB, FUN, XXX
        DATA NTAB/83/, XXX/'?'/
        DATA TAB /
     *  '0',  '1',  '2',  '3',  '4',  '5',  '6',  '7',  '8',  '9',
     1  ' ',  '+',  '-',  '*',  '/',  '(',  ')',  '=',  ';',  '[',
     2  ']',  '>',  '<',  '^',  ':',  ',',  '.',  '''', '"',  '%',
     3  '&',  '!',  '?',  '_',  '#',  '@',  '$',  'A',  'B',  'C',
     4  'D',  'E',  'F',  'G',  'H',  'I',  'J',  'K',  'L',  'M',
     5  'N',  'O',  'P',  'Q',  'R',  'S',  'T',  'U',  'V',  'W',
     6  'X',  'Y',  'Z',  '',  '',  '',  '',  '',  '',  '',
     7  '',  '',  '',  '',  '',  '',  '',  '',  '',  '',
     8  '',  '',  ''
     9                                                              /
C----------------------------------------------------------------------
         GO TO (1,2), FUN
C!!!-------------------------------------------------------------------
           WRITE(NW6,10) FUN
10         FORMAT(' ***** CO P OPAEH K APFTRT, FUN=',I10)
           CALL SUBERR(1)
C!!!-------------------------------------------------------------------
C         ACAR    B   FCAR
1         CONTINUE
          DO 50  I=1,KCAR
          DO 51 J=1, NTAB
          JF=J
          IF ( ACAR(I) .EQ. TAB(J) )  GO TO 53
51        CONTINUE
          FCAR(I)=0
          GO TO 50
53        FCAR(I)=JF
50        CONTINUE
          RETURN
C       FCAR  B  ACAR
2         DO 60 I=1,KCAR
          JF=FCAR(I)
          IF ( JF .LE. 0  .OR.  JF .GT. NTAB ) GO TO 61
          ACAR(I)=TAB(JF)
          GO TO 60
61        ACAR(I)=XXX
60        CONTINUE
          RETURN
          END
