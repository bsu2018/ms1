       REAL FUNCTION KMAS02( T, TMAS )
CXXX----KOMEKC "MS1" --> BEPC 1.0  (OT EKAP 1986 .)------------
C   OPOPAMMA-HK  KMAS02( T, TMAS )
C   --------------------
C   HAHAEHE:        BCEHE HAEH F(T), AAHHO TAHO
C   ----------         O OOPHM TOKAM (T1,Y1), ...., (T_N,Y_N)
C                      POBO KCOHO-HEH HTEPO;
C                      P T <= T1, BCEA F(T) = Y1;
C                      P T >= T_N, BCEA F(T) = Y_N;
C                      OCKAETC AAHE OO KOECTBA TOEK.
C                      P N=0  N=1 - BCEA F(T)=0.0
C
C                      *** KOPOBKA B OCAH APAMETPOB ***
C
C                      MAS < T1 Y1 ..... T_N Y_N >
C
C                      P MAS < 0 >  MAS < T_OE >
C                      PHMAETC F(T) = 0.0
C
C   METO:     KCOHO-HEHA HTEPO;
C   -----      BOH OCK HTEPBAA;
C   APAMETP:  KMAS02 - HAEHE F(T) P
C   ---------   T      - BPEM OPEEEH F(T);
C               TMAS - MACCB AHHX ( PAMEPHOCT  N COB ):
C   MACCB  --> N   T1 Y1   T2 Y2   T3 Y3   T4 Y4   T5 Y5   T..
C   COBO # --> 1    2  3   4   5    6  7    8  9   10  11  T..
C
C    B MACCBE OCBAETC [N/2] - TOEK (T_K, Y_K), OPEEX
C                                   HK F(T);
C
C   OPOPAMM:      HET
C   ------------
C   PMEAHE:     1.  P K - HE ETHOE, TBAETC TOKO
C   ----------          ETHOE HAEHE K;
C                   2. HTEPBA BPATC BCEA O PH:
C                        T#K#    <   T   <=    T#K+1#
C
CZZZ-------------------------------------------------------------------
       DIMENSION TMAS(*)
CVVVVV REAL KMAS02
       N2 = IFIX( TMAS(1) )
C---> CKOKO TOEK..
       N = N2/2
       IF ( N .NE. 0 ) GO TO 1
C-->  BPAEHE..
       KMAS02 = 0.0
       RETURN
1      CONTINUE
C--> HE HA PAHAX  M....
       T1 = TMAS(2)
       TN = TMAS( 2*N )
       IF ( T .LE. T1 ) GO TO 2
       IF ( T .GE. TN ) GO TO 3
C--->  OCK HTEPBAA...
C-->   T(K) -> TMAS(2*K);   Y(K) -> TMAS( 2*K+1 )
       I = 1
       J = N + 1
20     K = (I+J)/2
       TK = TMAS(2*K)
       IF ( T .LT. TK ) J = K
       IF ( T .GE. TK ) I = K
       IF ( J .GT. (I+1) ) GO TO 20
C--> HTEPBA HA -->  ME I    (I+1) TOKO;
       I2 =  2*I
       TI =  TMAS(I2)
       YI =  TMAS(I2+1)
       TI1 = TMAS(I2+2)
       YI1 = TMAS(I2+3)
       DTI = TI1 - TI
       DT  = T - TI
       D   = DT/DTI
       KMAS02 = YI + (YI1-YI) * D
       RETURN
C######################################################################
2      CONTINUE
       KMAS02 = TMAS(3)
       RETURN
3      CONTINUE
       KMAS02 = TMAS(2*N+1)
       RETURN
       END
